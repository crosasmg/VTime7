'---------------------------------------------------------------------------------------------------
' <generated>
'     This code was generated by Form Designer Oracle v7.1.2 at 2019/04/12 model release 7
'     
'     Changes to this file may cause incorrect behavior and will be lost if the code is regenerated.
' </generated>
'---------------------------------------------------------------------------------------------------
      
#Region "using"
    
Imports Artem.Google.UI
Imports DashboardBusiness.Helpers
Imports DevExpress.Web
Imports DevExpress.Web.ASPxClasses
Imports DevExpress.Web.ASPxEditors
Imports DevExpress.Web.ASPxGridView
Imports GIT.Core
Imports InMotionGIT.FrontOffice.Support.Enumerations
Imports InMotionGIT.FrontOffice.Support.Helpers.ControlHandler
Imports InMotionGIT.BarCode
Imports InMotionGIT.BarCode.Enumerations
Imports InMotionGIT.Common.Helpers
Imports InMotionGIT.Common.Proxy
Imports InMotionGIT.DatosNoEstruct.ContratoDeDatos.DTOs
Imports InMotionGIT.DatosNoEstruct.ContratoDeDatos.Modelo
Imports System.IO
Imports InMotionGIT.FrontOffice.Support
Imports System.Collections.Generic
Imports System.Collections.ObjectModel
Imports System.Data
Imports System.Data.Common
Imports System.Globalization
Imports System.Linq
Imports System.Threading.Thread
Imports System.Xml.Linq
Imports System.Net


#End Region

Partial Public Class FinancialQuestionnaireUWUserControl
    Inherits GIT.Core.UserControlBase
    Implements Dropthings.Widget.Framework.IWidget

#Region "IWidget Members"
    
    
    

    Public Sub Closed() Implements Dropthings.Widget.Framework.IWidget.Closed
    End Sub

    Public Sub HideSettings() Implements Dropthings.Widget.Framework.IWidget.HideSettings

    End Sub

    Public Sub Init1(host As Dropthings.Widget.Framework.IWidgetHost) Implements Dropthings.Widget.Framework.IWidget.Init

    End Sub

    Public Sub Maximized() Implements Dropthings.Widget.Framework.IWidget.Maximized

    End Sub

    Public Sub Minimized() Implements Dropthings.Widget.Framework.IWidget.Minimized

    End Sub

    Public Sub ShowSettings() Implements Dropthings.Widget.Framework.IWidget.ShowSettings

    End Sub

#End Region

#Region "Private fields"

    Private _formData As FinancialQuestionnaireUWParameter = Nothing
    Private _CurrentParameterInstance As Boolean = False
    Private _loading As Boolean = False
    Private _loadcompleted As Boolean = False
    Private _webTransfer as String  
    Private _foundData As Boolean = False
        
#End Region

#Region "Public properties"

    Public Property FormData() As FinancialQuestionnaireUWParameter
        Get
            Dim formDefinition As String = String.Empty               
             
            If IsNothing(_formData) Then
                If Not IsPostBack Then
                    If Not String.IsNullOrEmpty(Request.QueryString("id")) Then
                        Dim _id As Guid
                        
                        If Guid.TryParse(Request.QueryString("id"), _id) Then
		                        _FormID.Text = Request.QueryString("id")  
                            
                            _foundData = RetrieveFormInformation()
                        End If
                    End If

                    If IsNothing(_formData) Then
                        _formData = New FinancialQuestionnaireUWParameter
                       
                        If String.IsNullOrEmpty(_FormID.Text) Then
                        	_FormID.Text = System.Guid.NewGuid().ToString                       
                        End If
											
                        _formData.InternalId = _FormID.Text
                        
                        If Not String.IsNullOrEmpty(Request.QueryString("fromid")) OrElse
                           Not String.IsNullOrEmpty(Session("fromid")) Then
                           
                            GetTransferParameters()
                        End If
                        
                        
                        
                        SetDefaultValuesFromQueryString()
                        ValidateParametersInstance(_formData)
                        
                        popupNotifyMessage.ShowOnPageLoad = false                        
                        
                        ControlsInitialization()
                        ExecuteActionsInitializationForm()
                         
                        If Not String.IsNullOrEmpty(Request.QueryString("readonly")) Then
                            SetReadOnlyControls()
                        End If
                        
                        If Not String.IsNullOrEmpty(Request.QueryString("save")) Then
                            save_Click(nothing, nothing)
                        End If
                        If Not String.IsNullOrEmpty(Request.QueryString("submit")) Then
                            submit_Click(nothing, nothing)
                        End If

                    Else
                    		SetDefaultValuesFromQueryString()
                        ExecuteActionsLoadForm()
                    End If

                Else
                     _foundData = RetrieveFormInformation()                    

                    If IsNothing(_formData) Then
                        _formData = New FinancialQuestionnaireUWParameter
                    End If
                End If
            End If

            Return _formData
        End Get

        Set(value As FinancialQuestionnaireUWParameter)
            _formData = value
        End Set
    End Property
    
#End Region

#Region "Form Events"

    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        ErrorsGridView.Visible = False
        
        
        
        Dim formData As FinancialQuestionnaireUWParameter = Me.FormData        
           
        If Not IsPostBack  AndAlso Not GridViewPostBack() Then                     
            
            
            _loadcompleted = True
            
            
            If IsPostBack And Not _CurrentParameterInstance Then
                MapPageToClass(formData)
                _CurrentParameterInstance = True
            End If

            MapClassToPage(formData)
            VerifySecurityLevel()
            
            
        Else
            
            
            
        End If        
        
        
        
        
    End Sub    

    Protected Sub Page_Unload(sender As Object, e As EventArgs) Handles Me.Unload        
StoreFormInformation() 
        
        If Not IsNothing(_formData) Then
             If Not IsNothing(Session("Form.Track")) AndAlso Session("Form.Track").ToString.ToLower = "true" Then
                 Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}", IO.Path.GetFileNameWithoutExtension(Page.AppRelativeVirtualPath))) = _formData
             End If   
       
             If Not IsNothing(Session("Form.Track.Parameters")) AndAlso Session("Form.Track.Parameters").ToString.ToLower = "true" Then
                  InMotionGIT.Common.Helpers.Serialize.SerializeToFile(Of FinancialQuestionnaireUWParameter) _
                  (formData, String.Format(CultureInfo.InvariantCulture, "{0}\{1}.FinancialQuestionnaireUW.xml",  ConfigurationManager.AppSettings("Path.Logs"), formData.InternalId), True)
             End If        
        End If  
   End Sub

#End Region

#Region "Controls Events"


    Private Function GridViewPostBack() As Boolean
        For index As Integer = 0 To Request.Params.Count - 1
            If Request.Params(index).EndsWith("$")  Then
                Return True
            End If
        Next
        
        Return False
    End Function    
        
    
    
#End Region


#Region "PopupMenu Events"

    
    
#End Region

#Region "Mapping methods"

    Public Sub ValidateParametersInstance(ByRef FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter)
        If IsNothing(FinancialQuestionnaireUWParameterInstance.Financial) Then
            FinancialQuestionnaireUWParameterInstance.Financial = New InMotionGIT.Questionnaires.Financial
        End If
   
    End Sub
    
    ''' <summary>
    ''' This method moves the data from the class to the page
    ''' </summary>
    ''' <param name="FinancialQuestionnaireUWParameterInstance"></param>
    ''' <remarks></remarks>
    Public Sub MapClassToPage(ByRef FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter, Optional calledBy As String = "")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
        ValidateParametersInstance(FinancialQuestionnaireUWParameterInstance)

        
       
        With FinancialQuestionnaireUWParameterInstance
          
                      ClientName.Text = .ClientName
            uwcaseid.Text = .uwcaseid
            Year1.Text = .Financial.Year1
            Year2.Text = .Financial.Year2
            Year3.Text = .Financial.Year3
            SalaryYear1.Text = .Financial.SalaryYear1
            SalaryYear2.Text = .Financial.SalaryYear2
            SalaryYear3.Text = .Financial.SalaryYear3
            BusinesReported1.Text = .Financial.BusinesReported1
            BusinesReported2.Text = .Financial.BusinesReported2
            BusinesReported3.Text = .Financial.BusinesReported3
            BonusYear1.Text = .Financial.BonusYear1
            BonusYear2.Text = .Financial.BonusYear2
            BonusYear3.Text = .Financial.BonusYear3
            CommissionYear1.Text = .Financial.CommissionYear1
            CommissionYear2.Text = .Financial.CommissionYear2
            CommissionYear3.Text = .Financial.CommissionYear3
            PensionProfitSharingYear1.Text = .Financial.PensionProfitSharingYear1
            PensionProfitSharingYear2.Text = .Financial.PensionProfitSharingYear2
            PensionProfitSharingYear3.Text = .Financial.PensionProfitSharingYear3
            OtherIncomeYear1.Text = .Financial.OtherIncomeYear1
            OtherIncomeYear2.Text = .Financial.OtherIncomeYear2
            OtherIncomeYear3.Text = .Financial.OtherIncomeYear3
            DescriptionOtherIncome.Text = .Financial.DescriptionOtherIncome
            TotalEarnedIncomeYear1.Text = .Financial.TotalEarnedIncomeYear1
            TotalEarnedIncomeYear2.Text = .Financial.TotalEarnedIncomeYear2
            TotalEarnedIncomeYear3.Text = .Financial.TotalEarnedIncomeYear3
            iaYear1.Text = .Year1
            iaYear2.Text = .Year2
            iaYear3.Text = .Financial.Year3
            DividendsYear1.Text = .Financial.DividendsYear1
            DividendsYear2.Text = .Financial.DividendsYear2
            DividendsYear3.Text = .Financial.DividendsYear3
            InterestYear1.Text = .Financial.InterestYear1
            InterestYear2.Text = .Financial.InterestYear2
            InterestYear3.Text = .Financial.InterestYear3
            NetRentalsYear1.Text = .Financial.NetRentalsYear1
            NetRentalsYear2.Text = .Financial.NetRentalsYear2
            NetRentalsYear3.Text = .Financial.NetRentalsYear3
            CapitalGainsYear1.Text = .Financial.CapitalGainsYear1
            CapitalGainsYear2.Text = .Financial.CapitalGainsYear2
            CapitalGainsYear3.Text = .Financial.CapitalGainsYear3
            OtherEarnedIncomeYear1.Text = .Financial.OtherEarnedIncomeYear1
            OtherEarnedIncomeYear2.Text = .Financial.OtherEarnedIncomeYear2
            OtherEarnedIncomeYear3.Text = .Financial.OtherEarnedIncomeYear3
            DescriptionOtherEarnedIncome.Text = .Financial.DescriptionOtherEarnedIncome
            TotalUnearnedIncomeYear1.Text = .Financial.TotalUnearnedIncomeYear1
            TotalUnearnedIncomeYear2.Text = .Financial.TotalUnearnedIncomeYear2
            TotalUnearnedIncomeYear3.Text = .Financial.TotalUnearnedIncomeYear3
            Cash.Text = .Financial.Cash
            RealEstate.Text = .Financial.RealEstate
            BusinessEquity.Text = .Financial.BusinessEquity
            Stocks.Text = .Financial.Stocks
            OtherAssets1.Text = .Financial.OtherAssets1
            DescribeOtherAssets1.Text = .Financial.DescribeOtherAssets1
            OtherAssets2.Text = .Financial.OtherAssets2
            DescribeOtherAssets2.Text = .Financial.DescribeOtherAssets2
            OtherAssets3.Text = .Financial.OtherAssets3
            DescribeOtherAssets3.Text = .Financial.DescribeOtherAssets3
            OtherAssets4.Text = .Financial.OtherAssets4
            DescribeOtherAssets4.Text = .Financial.DescribeOtherAssets4
            TotalAssets.Text = .Financial.TotalAssets
            Mortgages.Text = .Financial.Mortgages
            Loans.Text = .Financial.Loans
            Liens.Text = .Financial.Liens
            Bonds.Text = .Financial.Bonds
            OtherLiabilities1.Text = .Financial.OtherLiabilities1
            DescribeOtherLiabilities1.Text = .Financial.DescribeOtherLiabilities1
            OtherLiabilities2.Text = .Financial.OtherLiabilities2
            DescribeOtherLiabilities2.Text = .Financial.DescribeOtherLiabilities2
            OtherLiabilities3.Text = .Financial.OtherLiabilities3
            DescribeOtherLiabilities3.Text = .Financial.DescribeOtherLiabilities3
            OtherLiabilities4.Text = .Financial.OtherLiabilities4
            DescribeOtherLiabilities4.Text = .Financial.DescribeOtherLiabilities4
            TotalLiabilities.Text = .Financial.TotalLiabilities
            AdditionalInformation.Text = .Financial.AdditionalInformation
            If .Financial.DateReceived.IsNotEmpty Then
                DateReceived.Value = .Financial.DateReceived
            Else
                DateReceived.Value = Nothing
                
            End If

              
                  
          
          
               
            
            
       End With


if (Not ("".IndexOf(calledBy) > -1)) Or String.IsNullOrEmpty(calledBy) then        
            
         

        End If          
    End Sub

    ''' <summary>
    ''' This method moves the data from the page to the class
    ''' </summary>
    ''' <param name="FinancialQuestionnaireUWParameterInstance"></param>
    Public Sub MapPageToClass(ByRef FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter)
        _loading = True

        ValidateParametersInstance(FinancialQuestionnaireUWParameterInstance)

        With FinancialQuestionnaireUWParameterInstance
            .ClientName = ClientName.Text
            .uwcaseid = uwcaseid.Text
            .Financial.Year1 = Year1.Text
            .Financial.Year2 = Year2.Text
            .Financial.Year3 = Year3.Text
            .Financial.SalaryYear1 = SalaryYear1.Text
            .Financial.SalaryYear2 = SalaryYear2.Text
            .Financial.SalaryYear3 = SalaryYear3.Text
            .Financial.BusinesReported1 = BusinesReported1.Text
            .Financial.BusinesReported2 = BusinesReported2.Text
            .Financial.BusinesReported3 = BusinesReported3.Text
            .Financial.BonusYear1 = BonusYear1.Text
            .Financial.BonusYear2 = BonusYear2.Text
            .Financial.BonusYear3 = BonusYear3.Text
            .Financial.CommissionYear1 = CommissionYear1.Text
            .Financial.CommissionYear2 = CommissionYear2.Text
            .Financial.CommissionYear3 = CommissionYear3.Text
            .Financial.PensionProfitSharingYear1 = PensionProfitSharingYear1.Text
            .Financial.PensionProfitSharingYear2 = PensionProfitSharingYear2.Text
            .Financial.PensionProfitSharingYear3 = PensionProfitSharingYear3.Text
            .Financial.OtherIncomeYear1 = OtherIncomeYear1.Text
            .Financial.OtherIncomeYear2 = OtherIncomeYear2.Text
            .Financial.OtherIncomeYear3 = OtherIncomeYear3.Text
            .Financial.DescriptionOtherIncome = DescriptionOtherIncome.Text
            .Financial.TotalEarnedIncomeYear1 = TotalEarnedIncomeYear1.Text
            .Financial.TotalEarnedIncomeYear2 = TotalEarnedIncomeYear2.Text
            .Financial.TotalEarnedIncomeYear3 = TotalEarnedIncomeYear3.Text
            .Year1 = iaYear1.Text
            .Year2 = iaYear2.Text
            .Financial.Year3 = iaYear3.Text
            .Financial.DividendsYear1 = DividendsYear1.Text
            .Financial.DividendsYear2 = DividendsYear2.Text
            .Financial.DividendsYear3 = DividendsYear3.Text
            .Financial.InterestYear1 = InterestYear1.Text
            .Financial.InterestYear2 = InterestYear2.Text
            .Financial.InterestYear3 = InterestYear3.Text
            .Financial.NetRentalsYear1 = NetRentalsYear1.Text
            .Financial.NetRentalsYear2 = NetRentalsYear2.Text
            .Financial.NetRentalsYear3 = NetRentalsYear3.Text
            .Financial.CapitalGainsYear1 = CapitalGainsYear1.Text
            .Financial.CapitalGainsYear2 = CapitalGainsYear2.Text
            .Financial.CapitalGainsYear3 = CapitalGainsYear3.Text
            .Financial.OtherEarnedIncomeYear1 = OtherEarnedIncomeYear1.Text
            .Financial.OtherEarnedIncomeYear2 = OtherEarnedIncomeYear2.Text
            .Financial.OtherEarnedIncomeYear3 = OtherEarnedIncomeYear3.Text
            .Financial.DescriptionOtherEarnedIncome = DescriptionOtherEarnedIncome.Text
            .Financial.TotalUnearnedIncomeYear1 = TotalUnearnedIncomeYear1.Text
            .Financial.TotalUnearnedIncomeYear2 = TotalUnearnedIncomeYear2.Text
            .Financial.TotalUnearnedIncomeYear3 = TotalUnearnedIncomeYear3.Text
            .Financial.Cash = Cash.Text
            .Financial.RealEstate = RealEstate.Text
            .Financial.BusinessEquity = BusinessEquity.Text
            .Financial.Stocks = Stocks.Text
            .Financial.OtherAssets1 = OtherAssets1.Text
            .Financial.DescribeOtherAssets1 = DescribeOtherAssets1.Text
            .Financial.OtherAssets2 = OtherAssets2.Text
            .Financial.DescribeOtherAssets2 = DescribeOtherAssets2.Text
            .Financial.OtherAssets3 = OtherAssets3.Text
            .Financial.DescribeOtherAssets3 = DescribeOtherAssets3.Text
            .Financial.OtherAssets4 = OtherAssets4.Text
            .Financial.DescribeOtherAssets4 = DescribeOtherAssets4.Text
            .Financial.TotalAssets = TotalAssets.Text
            .Financial.Mortgages = Mortgages.Text
            .Financial.Loans = Loans.Text
            .Financial.Liens = Liens.Text
            .Financial.Bonds = Bonds.Text
            .Financial.OtherLiabilities1 = OtherLiabilities1.Text
            .Financial.DescribeOtherLiabilities1 = DescribeOtherLiabilities1.Text
            .Financial.OtherLiabilities2 = OtherLiabilities2.Text
            .Financial.DescribeOtherLiabilities2 = DescribeOtherLiabilities2.Text
            .Financial.OtherLiabilities3 = OtherLiabilities3.Text
            .Financial.DescribeOtherLiabilities3 = DescribeOtherLiabilities3.Text
            .Financial.OtherLiabilities4 = OtherLiabilities4.Text
            .Financial.DescribeOtherLiabilities4 = DescribeOtherLiabilities4.Text
            .Financial.TotalLiabilities = TotalLiabilities.Text
            .Financial.AdditionalInformation = AdditionalInformation.Text
            .Financial.DateReceived = DateReceived.Value





        End With




        _loading = False
    End Sub

#End Region








#Region "AutoPostBack Events Handles"

Protected Sub OtherIncomeYear1_TextChanged(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("OtherIncomeYear1_Text")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. If _formData.Financial.OtherIncomeYear1 = 0 AND _formData.Financial.OtherIncomeYear2 = 0 AND ... Then") 
If _formData.Financial.OtherIncomeYear1 = 0 AndAlso _formData.Financial.OtherIncomeYear2 = 0 AndAlso _formData.Financial.OtherIncomeYear3 = 0 Then

            currentAction = SessionTrace("2. Disable 'Descripción' control") 
        BehaviorShowControls("DescriptionOtherIncome,Disabled")
            currentAction = SessionTrace("3. _formData.Financial.DescriptionOtherIncome = ' '...") 
 
            currentAction = SessionTrace("3.1. _formData.Financial.DescriptionOtherIncome = ' '...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DescriptionOtherIncome = " " 

        Else 
            currentAction = SessionTrace("4. If _formData.Financial.OtherIncomeYear1 <> 0 Then") 
If _formData.Financial.OtherIncomeYear1 <> 0 Then

            currentAction = SessionTrace("5. Enable 'Descripción' control") 
        BehaviorShowControls("DescriptionOtherIncome,Enabled")
            End If
            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub OtherIncomeYear2_TextChanged(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("OtherIncomeYear2_Text")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. If _formData.Financial.OtherIncomeYear1 = 0 AND _formData.Financial.OtherIncomeYear2 = 0 AND ... Then") 
If _formData.Financial.OtherIncomeYear1 = 0 AndAlso _formData.Financial.OtherIncomeYear2 = 0 AndAlso _formData.Financial.OtherIncomeYear3 = 0 Then

            currentAction = SessionTrace("2. Disable 'Descripción' control") 
        BehaviorShowControls("DescriptionOtherIncome,Disabled")
            currentAction = SessionTrace("3. _formData.Financial.DescriptionOtherIncome = ' '...") 
 
            currentAction = SessionTrace("3.1. _formData.Financial.DescriptionOtherIncome = ' '...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DescriptionOtherIncome = " " 

        Else 
            currentAction = SessionTrace("4. If _formData.Financial.OtherIncomeYear2 <> 0 Then") 
If _formData.Financial.OtherIncomeYear2 <> 0 Then

            currentAction = SessionTrace("5. Enable 'Descripción' control") 
        BehaviorShowControls("DescriptionOtherIncome,Enabled")
            End If
            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub OtherIncomeYear3_TextChanged(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("OtherIncomeYear3_Text")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. If _formData.Financial.OtherIncomeYear1 = 0 AND _formData.Financial.OtherIncomeYear2 = 0 AND ... Then") 
If _formData.Financial.OtherIncomeYear1 = 0 AndAlso _formData.Financial.OtherIncomeYear2 = 0 AndAlso _formData.Financial.OtherIncomeYear3 = 0 Then

            currentAction = SessionTrace("2. Disable 'Descripción' control") 
        BehaviorShowControls("DescriptionOtherIncome,Disabled")
            currentAction = SessionTrace("3. _formData.Financial.DescriptionOtherIncome = ' '...") 
 
            currentAction = SessionTrace("3.1. _formData.Financial.DescriptionOtherIncome = ' '...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DescriptionOtherIncome = " " 

        Else 
            currentAction = SessionTrace("4. If _formData.Financial.OtherIncomeYear3 <> 0 Then") 
If _formData.Financial.OtherIncomeYear3 <> 0 Then

            currentAction = SessionTrace("5. Enable 'Descripción' control") 
        BehaviorShowControls("DescriptionOtherIncome,Enabled")
            End If
            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub OtherEarnedIncomeYear1_TextChanged(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("OtherEarnedIncomeYear1_Text")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. If _formData.Financial.OtherEarnedIncomeYear1 = 0 AND _formData.Financial.OtherEarnedIncomeYear2 = 0 AND ... Then") 
If _formData.Financial.OtherEarnedIncomeYear1 = 0 AndAlso _formData.Financial.OtherEarnedIncomeYear2 = 0 AndAlso _formData.Financial.OtherEarnedIncomeYear3 = 0 Then

            currentAction = SessionTrace("2. Disable 'Descripción' control") 
        BehaviorShowControls("DescriptionOtherEarnedIncome,Disabled")
            currentAction = SessionTrace("3. _formData.Financial.DescriptionOtherEarnedIncome = ' '...") 
 
            currentAction = SessionTrace("3.1. _formData.Financial.DescriptionOtherEarnedIncome = ' '...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DescriptionOtherEarnedIncome = " " 

        Else 
            currentAction = SessionTrace("4. If _formData.Financial.OtherEarnedIncomeYear1 <> 0 Then") 
If _formData.Financial.OtherEarnedIncomeYear1 <> 0 Then

            currentAction = SessionTrace("5. Enable 'Descripción' control") 
        BehaviorShowControls("DescriptionOtherEarnedIncome,Enabled")
            End If
            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub OtherEarnedIncomeYear2_TextChanged(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("OtherEarnedIncomeYear2_Text")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. If _formData.Financial.OtherEarnedIncomeYear1 = 0 AND _formData.Financial.OtherEarnedIncomeYear2 = 0 AND ... Then") 
If _formData.Financial.OtherEarnedIncomeYear1 = 0 AndAlso _formData.Financial.OtherEarnedIncomeYear2 = 0 AndAlso _formData.Financial.OtherEarnedIncomeYear3 = 0 Then

            currentAction = SessionTrace("2. Disable 'Descripción' control") 
        BehaviorShowControls("DescriptionOtherEarnedIncome,Disabled")
            currentAction = SessionTrace("3. _formData.Financial.DescriptionOtherEarnedIncome = ' '...") 
 
            currentAction = SessionTrace("3.1. _formData.Financial.DescriptionOtherEarnedIncome = ' '...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DescriptionOtherEarnedIncome = " " 

        Else 
            currentAction = SessionTrace("4. If _formData.Financial.OtherEarnedIncomeYear2 <> 0 Then") 
If _formData.Financial.OtherEarnedIncomeYear2 <> 0 Then

            currentAction = SessionTrace("5. Enable 'Descripción' control") 
        BehaviorShowControls("DescriptionOtherEarnedIncome,Enabled")
            End If
            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub OtherEarnedIncomeYear3_TextChanged(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("OtherEarnedIncomeYear3_Text")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. If _formData.Financial.OtherEarnedIncomeYear1 = 0 AND _formData.Financial.OtherEarnedIncomeYear2 = 0 AND ... Then") 
If _formData.Financial.OtherEarnedIncomeYear1 = 0 AndAlso _formData.Financial.OtherEarnedIncomeYear2 = 0 AndAlso _formData.Financial.OtherEarnedIncomeYear3 = 0 Then

            currentAction = SessionTrace("2. Disable 'Descripción' control") 
        BehaviorShowControls("DescriptionOtherEarnedIncome,Disabled")
            currentAction = SessionTrace("3. _formData.Financial.DescriptionOtherEarnedIncome = ' '...") 
 
            currentAction = SessionTrace("3.1. _formData.Financial.DescriptionOtherEarnedIncome = ' '...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DescriptionOtherEarnedIncome = " " 

        Else 
            currentAction = SessionTrace("4. If _formData.Financial.OtherEarnedIncomeYear3 <> 0 Then") 
If _formData.Financial.OtherEarnedIncomeYear3 <> 0 Then

            currentAction = SessionTrace("5. Enable 'Descripción' control") 
        BehaviorShowControls("DescriptionOtherEarnedIncome,Enabled")
            End If
            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub OtherAssets1_TextChanged(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("OtherAssets1_Text")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. If _formData.Financial.OtherAssets1 <> 0 Then") 
If _formData.Financial.OtherAssets1 <> 0 Then

            currentAction = SessionTrace("2. Enable 'Descriptions' control") 
        BehaviorShowControls("DescribeOtherAssets1,Enabled")
        Else 
            currentAction = SessionTrace("3. _formData.Financial.DescribeOtherAssets1 = ' '...") 
 
            currentAction = SessionTrace("3.1. _formData.Financial.DescribeOtherAssets1 = ' '...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DescribeOtherAssets1 = " " 

            currentAction = SessionTrace("4. Disable 'Descriptions' control") 
        BehaviorShowControls("DescribeOtherAssets1,Disabled")
            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub OtherAssets2_TextChanged(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("OtherAssets2_Text")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. If _formData.Financial.OtherAssets2 <> 0 Then") 
If _formData.Financial.OtherAssets2 <> 0 Then

            currentAction = SessionTrace("2. Enable 'Descriptions' control") 
        BehaviorShowControls("DescribeOtherAssets2,Enabled")
        Else 
            currentAction = SessionTrace("3. Disable 'Descriptions' control") 
        BehaviorShowControls("DescribeOtherAssets2,Disabled")
            currentAction = SessionTrace("4. _formData.Financial.DescribeOtherAssets2 = ' '...") 
 
            currentAction = SessionTrace("4.1. _formData.Financial.DescribeOtherAssets2 = ' '...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DescribeOtherAssets2 = " " 

            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub OtherAssets3_TextChanged(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("OtherAssets3_Text")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. If _formData.Financial.OtherAssets3 <> 0 Then") 
If _formData.Financial.OtherAssets3 <> 0 Then

            currentAction = SessionTrace("2. Enable 'Descriptions' control") 
        BehaviorShowControls("DescribeOtherAssets3,Enabled")
        Else 
            currentAction = SessionTrace("3. Disable 'Descriptions' control") 
        BehaviorShowControls("DescribeOtherAssets3,Disabled")
            currentAction = SessionTrace("4. _formData.Financial.DescribeOtherAssets3 = ' '...") 
 
            currentAction = SessionTrace("4.1. _formData.Financial.DescribeOtherAssets3 = ' '...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DescribeOtherAssets3 = " " 

            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub OtherAssets4_TextChanged(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("OtherAssets4_Text")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. If _formData.Financial.OtherAssets4 <> 0 Then") 
If _formData.Financial.OtherAssets4 <> 0 Then

            currentAction = SessionTrace("2. Enable 'Descriptions' control") 
        BehaviorShowControls("DescribeOtherAssets4,Enabled")
        Else 
            currentAction = SessionTrace("3. Disable 'Descriptions' control") 
        BehaviorShowControls("DescribeOtherAssets4,Disabled")
            currentAction = SessionTrace("4. _formData.Financial.DescribeOtherAssets4 = ' '...") 
 
            currentAction = SessionTrace("4.1. _formData.Financial.DescribeOtherAssets4 = ' '...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DescribeOtherAssets4 = " " 

            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub OtherLiabilities1_TextChanged(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("OtherLiabilities1_Text")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. If _formData.Financial.OtherLiabilities1 <> 0 Then") 
If _formData.Financial.OtherLiabilities1 <> 0 Then

            currentAction = SessionTrace("2. Enable 'Description' control") 
        BehaviorShowControls("DescribeOtherLiabilities1,Enabled")
        Else 
            currentAction = SessionTrace("3. Disable 'Description' control") 
        BehaviorShowControls("DescribeOtherLiabilities1,Disabled")
            currentAction = SessionTrace("4. _formData.Financial.DescribeOtherLiabilities1 = ' '...") 
 
            currentAction = SessionTrace("4.1. _formData.Financial.DescribeOtherLiabilities1 = ' '...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DescribeOtherLiabilities1 = " " 

            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub OtherLiabilities2_TextChanged(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("OtherLiabilities2_Text")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. If _formData.Financial.OtherLiabilities2 <> 0 Then") 
If _formData.Financial.OtherLiabilities2 <> 0 Then

            currentAction = SessionTrace("2. Enable 'Description' control") 
        BehaviorShowControls("DescribeOtherLiabilities2,Enabled")
        Else 
            currentAction = SessionTrace("3. Disable 'Description' control") 
        BehaviorShowControls("DescribeOtherLiabilities2,Disabled")
            currentAction = SessionTrace("4. _formData.Financial.DescribeOtherLiabilities2 = ' '...") 
 
            currentAction = SessionTrace("4.1. _formData.Financial.DescribeOtherLiabilities2 = ' '...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DescribeOtherLiabilities2 = " " 

            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub OtherLiabilities3_TextChanged(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("OtherLiabilities3_Text")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. If _formData.Financial.OtherLiabilities3 <> 0 Then") 
If _formData.Financial.OtherLiabilities3 <> 0 Then

            currentAction = SessionTrace("2. Enable 'Description' control") 
        BehaviorShowControls("DescribeOtherLiabilities3,Enabled")
        Else 
            currentAction = SessionTrace("3. Disable 'Description' control") 
        BehaviorShowControls("DescribeOtherLiabilities3,Disabled")
            currentAction = SessionTrace("4. _formData.Financial.DescribeOtherLiabilities3 = ' '...") 
 
            currentAction = SessionTrace("4.1. _formData.Financial.DescribeOtherLiabilities3 = ' '...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DescribeOtherLiabilities3 = " " 

            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub OtherLiabilities4_TextChanged(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("OtherLiabilities4_Text")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. If _formData.Financial.OtherLiabilities4 <> 0 Then") 
If _formData.Financial.OtherLiabilities4 <> 0 Then

            currentAction = SessionTrace("2. Enable 'Description' control") 
        BehaviorShowControls("DescribeOtherLiabilities4,Enabled")
        Else 
            currentAction = SessionTrace("3. Disable 'Description' control") 
        BehaviorShowControls("DescribeOtherLiabilities4,Disabled")
            currentAction = SessionTrace("4. _formData.Financial.DescribeOtherLiabilities4 = ' '...") 
 
            currentAction = SessionTrace("4.1. _formData.Financial.DescribeOtherLiabilities4 = ' '...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DescribeOtherLiabilities4 = " " 

            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub save_Click(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("save_Click")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            

        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. The message 'El cuestionario será...' will displayed as 'Splash'") 
            messageAction = "El cuestionario será almacenado temporalmente. Recuerde que debe ser llenado para que su solicitud sea procesada. Muchas gracias." 
            ParametersToDictionary(parametersDictionary)
            messageAction = InMotionGIT.FrontOffice.Proxy.Helpers.Email.Process(messageAction, parametersDictionary) 
            FinancialQuestionnaireUWTablePage.Visible = False 
            MessageTable.Visible = True 
            FormMessageLabel.Text = messageAction 



          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub
Protected Sub submit_Click(sender As Object, e As EventArgs)  
        Dim FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter = Nothing
        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
        Dim currentAction As String = SessionTrace("submit_Click")
        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing  
        
        popupNotifyMessage.ShowOnPageLoad = false
        
        Try 
            Dim messageAction As String = String.Empty             
            Dim lastURL As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean  = False             
            Dim WorkflowInArguments  As New Dictionary(Of String, Object)
Dim WorkflowOutArguments As IDictionary(Of String, Object)


        
           
        
           GetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance, True)
         
           ParametersToDictionary(parametersDictionary)  
        
                       currentAction = SessionTrace("1. Call 'Calculate Total Amounts In Financial Questionnaire' workflow in Synchronous mode with tracking") 
            WorkflowInArguments = New Dictionary(Of String, Object)
            With WorkflowInArguments
                .Add("Financial", _formData.Financial) 
                .Add("AllOK", _formData.AllOK) 
                .Add("context", _formContext) 
                .Add("uwreqid", _formData.uwreqid) 
                .Add("uwcaseid", _formData.uwcaseid) 
            End With
            WorkflowOutArguments = InMotionGIT.Workflow.Support.Runtime.DoWorkFromForm("CalculateFinancialTotalAmountsUW", "0E6B6AFA-2DC6-4797-BD8B-CCA5B2547D15", 4, WorkflowInArguments, True, True, Me.AppRelativeVirtualPath, _formData.InternalId)
             currentAction += " 'Mapping Outputs'" 
                _formData.Financial = WorkflowOutArguments("Financial")
                _formData.AllOK = WorkflowOutArguments("AllOK")

            currentAction = SessionTrace("2. If _formData.AllOK = False Then") 
If _formData.AllOK = False Then

            currentAction = SessionTrace("3. The message 'Indique los ingresos...' will displayed as 'Popup'") 
            messageAction = "Indique los ingresos y patrimonio neto" 
            ParametersToDictionary(parametersDictionary)
            messageAction = InMotionGIT.FrontOffice.Proxy.Helpers.Email.Process(messageAction, parametersDictionary) 
            ShowWindowPopupMessage(messageAction) 

            End If
            currentAction = SessionTrace("4. If _formData.AllOK = true Then") 
If _formData.AllOK = true Then

            currentAction = SessionTrace("5. _formData.uwCaseIdInt64 = convert.ToInt64(_formData.uwcaseid)...") 
 
            currentAction = SessionTrace("5.1. _formData.uwCaseIdInt64 = convert.ToInt64(_formData.uwcaseid)...")

 _formData.uwCaseIdInt64 = convert.ToInt64(_formData.uwcaseid) 

            currentAction = SessionTrace("6. Call 'Retrieve Case Information' workflow in Synchronous mode with tracking") 
            WorkflowInArguments = New Dictionary(Of String, Object)
            With WorkflowInArguments
                .Add("uwcaseid", _formData.uwCaseIdInt64) 
                .Add("uwreqid", _formData.uwreqid) 
                .Add("ClientName", _formData.ClientName) 
                .Add("StatusCase", _formData.StatusCase) 
                .Add("StatusRequirement", _formData.StatusRequirement) 
                .Add("RiskInformation", _formData.RiskInformation) 
                .Add("Identifier", "FinantialFinal") 
                .Add("context", _formContext) 
                .Add("caseLocked", _formData.caseLocked) 
            End With
            WorkflowOutArguments = InMotionGIT.Workflow.Support.Runtime.DoWorkFromForm("RetrieveCaseInformation", "1632D520-852F-46AD-8F03-D0A778676380", 10, WorkflowInArguments, True, True, Me.AppRelativeVirtualPath, _formData.InternalId)
             currentAction += " 'Mapping Outputs'" 
                _formData.uwCaseIdInt64 = WorkflowOutArguments("uwcaseid")
                _formData.uwreqid = WorkflowOutArguments("uwreqid")
                _formData.ClientName = WorkflowOutArguments("ClientName")
                _formData.StatusCase = WorkflowOutArguments("StatusCase")
                _formData.StatusRequirement = WorkflowOutArguments("StatusRequirement")
                _formData.RiskInformation = WorkflowOutArguments("RiskInformation")

            currentAction = SessionTrace("7. If _formData.StatusRequirement <> 1 Then") 
If _formData.StatusRequirement <> 1 Then

            currentAction = SessionTrace("8. The message 'El estado del cuesti...' will displayed as 'Splash'") 
            messageAction = "El estado del cuestionario no permite ser llenado. Verifique la información que ha recibido por parte de la empresa de seguros." 
            ParametersToDictionary(parametersDictionary)
            messageAction = InMotionGIT.FrontOffice.Proxy.Helpers.Email.Process(messageAction, parametersDictionary) 
            FinancialQuestionnaireUWTablePage.Visible = False 
            MessageTable.Visible = True 
            FormMessageLabel.Text = messageAction 

        Else 
            currentAction = SessionTrace("9. Call Shared Function 'User Profile' without parameters") 
            Dim _ClientUser_b1bfe0e9a96a4825812c9793e6cdbfd8 As InMotionGIT.Client.Entity.Contracts.Client 
            

      If Not IsNothing(UserInfo) AndAlso Not IsNothing(UserInfo.User) then
         _ClientUser_b1bfe0e9a96a4825812c9793e6cdbfd8 = New InMotionGIT.Client.Entity.Contracts.Client

         With _ClientUser_b1bfe0e9a96a4825812c9793e6cdbfd8
             .ClientID = UserInfo.User.ClientID
             .FirstName = UserInfo.User.FirstName
             .LastName = UserInfo.User.LastName
             .LastName2 = UserInfo.User.SecondLastName
             .BirthDate = UserInfo.User.DateOfBirth
             .LegalName = UserInfo.User.CompanyName
             .GenderEnum = IIf(UserInfo.User.Gender = "Male", InMotionGIT.Common.Contracts.Enumerations.EnumGender.Male, InMotionGIT.Common.Contracts.Enumerations.EnumGender.Female)
             .eMailAddressDefault = UserInfo.User.Email
             .CompleteClientName = .CompleteClientNameValid
         End With

	isNullResult = (IsNothing(_ClientUser_b1bfe0e9a96a4825812c9793e6cdbfd8))
	isFoundData  = Not isNullResult
      End If
     
            _formData.ClientUser = _ClientUser_b1bfe0e9a96a4825812c9793e6cdbfd8 

            currentAction = SessionTrace("10. _formData.UsercodeFASI = UserInfo.UserId...") 
 
            currentAction = SessionTrace("10.1. _formData.UsercodeFASI = UserInfo.UserId...")

 _formData.UsercodeFASI = UserInfo.UserId 
            currentAction = SessionTrace("10.2. _formData.IsAnonymous = UserInfo.IsAnonymous()...")

 _formData.IsAnonymous = UserInfo.IsAnonymous() 

            currentAction = SessionTrace("11. If _formData.IsAnonymous = true Then") 
If _formData.IsAnonymous = true Then

            currentAction = SessionTrace("12. _formData.UsercodeFASI = 9998...") 
 
            currentAction = SessionTrace("12.1. _formData.UsercodeFASI = 9998...")

 _formData.UsercodeFASI = 9998 

            End If
            currentAction = SessionTrace("13. If _formData.caseLocked = true Then") 
If _formData.caseLocked = true Then

            currentAction = SessionTrace("14. Call 'Main Process Questionnaire Financial' workflow in Synchronous mode with tracking") 
            WorkflowInArguments = New Dictionary(Of String, Object)
            With WorkflowInArguments
                .Add("uwcaseid", _formData.uwCaseIdInt64) 
                .Add("uwreqid", _formData.uwreqid) 
                .Add("FinancialQuestionnaire", _formData.Financial) 
                .Add("context", _formContext) 
                .Add("ConnectedUserCode", _formData.UsercodeFASI) 
                .Add("caseLocked", _formData.caseLocked) 
            End With
            WorkflowOutArguments = InMotionGIT.Workflow.Support.Runtime.DoWorkFromForm("QuestionnaireRulesFinancialUW", "4CEE3659-87F7-4DA4-9D2C-32AE21D658BA", 11, WorkflowInArguments, True, True, Me.AppRelativeVirtualPath, _formData.InternalId)
             currentAction += " 'Mapping Outputs'" 
                _formData.uwCaseIdInt64 = WorkflowOutArguments("uwcaseid")
                _formData.uwreqid = WorkflowOutArguments("uwreqid")
                _formData.Financial = WorkflowOutArguments("FinancialQuestionnaire")

            currentAction = SessionTrace("15. Url: '#setting.Url.WebApplication#/Underwriting/UnderwritingPanel.aspx'") 
    
_webtransfer = String.Format(CultureInfo.InvariantCulture, ConfigurationManager.AppSettings("Url.WebApplication") +"/Underwriting/UnderwritingPanel.aspx"+"?closeWindow={0}","1") 
        Else 
            currentAction = SessionTrace("16. The message 'El cuestionario será...' will displayed as 'Splash'") 
            messageAction = "El cuestionario será procesado. La empresa le notificará lo más pronto posible el resultado del mismo. Muchas gracias." 
            ParametersToDictionary(parametersDictionary)
            messageAction = InMotionGIT.FrontOffice.Proxy.Helpers.Email.Process(messageAction, parametersDictionary) 
            FinancialQuestionnaireUWTablePage.Visible = False 
            MessageTable.Visible = True 
            FormMessageLabel.Text = messageAction 

            currentAction = SessionTrace("17. Call 'Main Process Questionnaire Financial' workflow in Asynchronous mode with tracking") 
            WorkflowInArguments = New Dictionary(Of String, Object)
            With WorkflowInArguments
                .Add("uwcaseid", _formData.uwCaseIdInt64) 
                .Add("uwreqid", _formData.uwreqid) 
                .Add("FinancialQuestionnaire", _formData.Financial) 
                .Add("context", _formContext) 
                .Add("ConnectedUserCode", _formData.UsercodeFASI) 
                .Add("caseLocked", _formData.caseLocked) 
            End With
            WorkflowOutArguments = InMotionGIT.Workflow.Support.Runtime.DoWorkFromForm("QuestionnaireRulesFinancialUW", "4CEE3659-87F7-4DA4-9D2C-32AE21D658BA", 9, WorkflowInArguments, True, False, Me.AppRelativeVirtualPath, _formData.InternalId)
 
            End If
            End If
            End If


          
           currentAction = String.Empty
             
        
           
                         
          
          SetCurrentParameterInstance(FinancialQuestionnaireUWParameterInstance,"")
          
        
          If FinancialQuestionnaireUWParameterInstance.Behavior <> InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None Then
             If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.NotifyMessage) Then
                 ShowWindowPopupMessage(FinancialQuestionnaireUWParameterInstance.NotifyMessage)
             End If           
            
             FinancialQuestionnaireUWParameterInstance.Behavior = InMotionGIT.FrontOffice.Support.Enumerations.enumBehavior.None
          End If
        
          If Not String.IsNullOrEmpty(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls) Then
               BehaviorShowControls(FinancialQuestionnaireUWParameterInstance.BehaviorShowControls)
          End If        
                  
          If Not IsNothing(_formContext.Errors) AndAlso _formContext.Errors.Count > 0 Then
				_formData.Errors.AddErrorList(_formContext.Errors)
           End If         
          
      Catch ex As Exception
           InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
		   _formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

           
           If Request.QueryString("debug").IsNotEmpty Then
               FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
               FormMessageLabel.ForeColor = Drawing.Color.Black
               FormMessageLabel.Font.Bold = True
               MessageTable.Visible = True
           End If           
           
      Finally
            If _formData.Errors.Count > 0 Then
               SetErrors(_formData.Errors)
            End If
            
             ClosePopupWindow()      
                
           If  _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
               If Page.IsCallback Then
                  DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
               Else
                   Response.ClearHeaders()        
                   Response.ClearContent()        
                   Response.Redirect(_webTransfer)
               End If          
           End If
		   FinancialQuestionnaireUWUpdatePanel.Update
      End Try
      
    End Sub


#End Region

#Region "UserControls Events Handles"

    



#End Region

#Region "Form Manager"

    Private Sub VerifySecurityLevel()


























    End Sub

      

    Private Sub GetCurrentParameterInstance(ByRef FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter, force As Boolean)
        If _loadcompleted Or force Then
            If Not _CurrentParameterInstance Then

                FinancialQuestionnaireUWParameterInstance = FormData

                If Page.IsPostBack Then
                    MapPageToClass(FinancialQuestionnaireUWParameterInstance)
                End If

                _CurrentParameterInstance = True
            Else
                FinancialQuestionnaireUWParameterInstance = _formData
            End If
        Else
            FinancialQuestionnaireUWParameterInstance = Nothing
        End If
    End Sub

    Protected Sub SetCurrentParameterInstance(ByRef FinancialQuestionnaireUWParameterInstance As FinancialQuestionnaireUWParameter, calledBy As String)
        FormData = FinancialQuestionnaireUWParameterInstance
        MapClassToPage(FinancialQuestionnaireUWParameterInstance,calledBy)
    End Sub

    Protected Sub SetErrors(errors As InMotionGIT.Common.Contracts.Errors.ErrorCollection)
        Dim errorList As InMotionGIT.Common.Contracts.Errors.ErrorCollection = ViewState("Errors")

        If IsNothing(errorList) Then
            errorList = New InMotionGIT.Common.Contracts.Errors.ErrorCollection
        End If

        errorList = errors

        ViewState("Errors") = errorList
        ShowErrors()
    End Sub

    Public Sub ShowErrors()
        If Not IsNothing(ViewState("Errors")) Then
            Dim errorList As InMotionGIT.Common.Contracts.Errors.ErrorCollection = ViewState("Errors")

            Dim queryOut = From lst In errorList Select lst Order By lst.ErrorId

            ErrorsGridView.Visible = True
            ErrorsGridView.DataSource = queryOut.ToList
            ErrorsGridView.DataBind()
            UpdatePanelErrors.Update()
        End If
    End Sub
   
    Private Sub ShowWindowPopupMessage(message As String)
        NotifyMessageLabel.Text = message
        popupNotifyMessage.ShowOnPageLoad = True
    End Sub

    Private Sub ClosePopupWindow()
        popControl.Windows(0).ShowOnPageLoad = False
    End Sub

    Private Sub GetTransferParameters()
        Dim fromDocumentCache As Object = Nothing

        If Not String.IsNullOrEmpty(Request.QueryString("fromid")) Then
            fromDocumentCache = Session( Request.QueryString("fromid"))
            Session.Remove(Request.QueryString("fromid"))
            
        Else
            fromDocumentCache = Session(Session("fromid"))
            Session.Remove(Session("fromid"))
            Session.Remove("fromid")   
        End If
        
        If Not IsNothing(fromDocumentCache) Then
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("uwcaseid", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("uwreqid", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ClientName", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("StatusCase", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("StatusRequirement", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Financial", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Year1", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Year2", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Year3", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("AllOK", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("RiskInformation", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("fromPanel", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("caseLocked", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("IsAnonymous", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("uwCaseIdInt64", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("UsercodeFASI", fromDocumentCache, _formData)
            InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ClientUser", fromDocumentCache, _formData)
            
        End If
    End Sub
    
    

    Private Sub SetDefaultValuesFromQueryString()

        If Request.Form("uwcaseid").IsNotEmpty Then
                FormData.uwcaseid = Request.Form("uwcaseid") 

ElseIf Request.QueryString("uwcaseid").IsNotEmpty Then
                FormData.uwcaseid = Request.QueryString("uwcaseid") 
End If 

If Request.Form("uwreqid").IsNotEmpty Then
                FormData.uwreqid = Request.Form("uwreqid") 

ElseIf Request.QueryString("uwreqid").IsNotEmpty Then
                FormData.uwreqid = Request.QueryString("uwreqid") 
End If 

If Request.Form("ClientName").IsNotEmpty Then
                FormData.ClientName = Request.Form("ClientName") 

ElseIf Request.QueryString("ClientName").IsNotEmpty Then
                FormData.ClientName = Request.QueryString("ClientName") 
End If 

If Request.Form("StatusCase").IsNotEmpty Then
                FormData.StatusCase = Request.Form("StatusCase") 

ElseIf Request.QueryString("StatusCase").IsNotEmpty Then
                FormData.StatusCase = Request.QueryString("StatusCase") 
End If 

If Request.Form("StatusRequirement").IsNotEmpty Then
                FormData.StatusRequirement = Request.Form("StatusRequirement") 

ElseIf Request.QueryString("StatusRequirement").IsNotEmpty Then
                FormData.StatusRequirement = Request.QueryString("StatusRequirement") 
End If 

If Request.Form("Year1").IsNotEmpty Then
                FormData.Year1 = Request.Form("Year1") 

ElseIf Request.QueryString("Year1").IsNotEmpty Then
                FormData.Year1 = Request.QueryString("Year1") 
End If 

If Request.Form("Year2").IsNotEmpty Then
                FormData.Year2 = Request.Form("Year2") 

ElseIf Request.QueryString("Year2").IsNotEmpty Then
                FormData.Year2 = Request.QueryString("Year2") 
End If 

If Request.Form("Year3").IsNotEmpty Then
                FormData.Year3 = Request.Form("Year3") 

ElseIf Request.QueryString("Year3").IsNotEmpty Then
                FormData.Year3 = Request.QueryString("Year3") 
End If 

If Request.Form("AllOK").IsNotEmpty Then
                FormData.AllOK = Request.Form("AllOK") 

ElseIf Request.QueryString("AllOK").IsNotEmpty Then
                FormData.AllOK = Request.QueryString("AllOK") 
End If 

If Request.Form("fromPanel").IsNotEmpty Then
                FormData.fromPanel = Request.Form("fromPanel") 

ElseIf Request.QueryString("fromPanel").IsNotEmpty Then
                FormData.fromPanel = Request.QueryString("fromPanel") 
End If 

If Request.Form("caseLocked").IsNotEmpty Then
                FormData.caseLocked = Request.Form("caseLocked") 

ElseIf Request.QueryString("caseLocked").IsNotEmpty Then
                FormData.caseLocked = Request.QueryString("caseLocked") 
End If 

If Request.Form("IsAnonymous").IsNotEmpty Then
                FormData.IsAnonymous = Request.Form("IsAnonymous") 

ElseIf Request.QueryString("IsAnonymous").IsNotEmpty Then
                FormData.IsAnonymous = Request.QueryString("IsAnonymous") 
End If 

If Request.Form("uwCaseIdInt64").IsNotEmpty Then
                FormData.uwCaseIdInt64 = Request.Form("uwCaseIdInt64") 

ElseIf Request.QueryString("uwCaseIdInt64").IsNotEmpty Then
                FormData.uwCaseIdInt64 = Request.QueryString("uwCaseIdInt64") 
End If 

If Request.Form("UsercodeFASI").IsNotEmpty Then
                FormData.UsercodeFASI = Request.Form("UsercodeFASI") 

ElseIf Request.QueryString("UsercodeFASI").IsNotEmpty Then
                FormData.UsercodeFASI = Request.QueryString("UsercodeFASI") 
End If 


    End Sub
    
    Private Sub BehaviorControls(controlItem As Control, isEnable As Boolean)
        InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValueSimple("Enabled", controlItem, isEnable)           
    End Sub
    
    Private Sub SetReadOnlyControls()
    
        BehaviorControls(ClientName, False)
        BehaviorControls(uwcaseid, False)
        BehaviorControls(Year1, False)
        BehaviorControls(Year2, False)
        BehaviorControls(Year3, False)
        BehaviorControls(SalaryYear1, False)
        BehaviorControls(SalaryYear2, False)
        BehaviorControls(SalaryYear3, False)
        BehaviorControls(BusinesReported1, False)
        BehaviorControls(BusinesReported2, False)
        BehaviorControls(BusinesReported3, False)
        BehaviorControls(BonusYear1, False)
        BehaviorControls(BonusYear2, False)
        BehaviorControls(BonusYear3, False)
        BehaviorControls(CommissionYear1, False)
        BehaviorControls(CommissionYear2, False)
        BehaviorControls(CommissionYear3, False)
        BehaviorControls(PensionProfitSharingYear1, False)
        BehaviorControls(PensionProfitSharingYear2, False)
        BehaviorControls(PensionProfitSharingYear3, False)
        BehaviorControls(OtherIncomeYear1, False)
        BehaviorControls(OtherIncomeYear2, False)
        BehaviorControls(OtherIncomeYear3, False)
        BehaviorControls(DescriptionOtherIncome, False)
        BehaviorControls(TotalEarnedIncomeYear1, False)
        BehaviorControls(TotalEarnedIncomeYear2, False)
        BehaviorControls(TotalEarnedIncomeYear3, False)
        BehaviorControls(iaYear1, False)
        BehaviorControls(iaYear2, False)
        BehaviorControls(iaYear3, False)
        BehaviorControls(DividendsYear1, False)
        BehaviorControls(DividendsYear2, False)
        BehaviorControls(DividendsYear3, False)
        BehaviorControls(InterestYear1, False)
        BehaviorControls(InterestYear2, False)
        BehaviorControls(InterestYear3, False)
        BehaviorControls(NetRentalsYear1, False)
        BehaviorControls(NetRentalsYear2, False)
        BehaviorControls(NetRentalsYear3, False)
        BehaviorControls(CapitalGainsYear1, False)
        BehaviorControls(CapitalGainsYear2, False)
        BehaviorControls(CapitalGainsYear3, False)
        BehaviorControls(OtherEarnedIncomeYear1, False)
        BehaviorControls(OtherEarnedIncomeYear2, False)
        BehaviorControls(OtherEarnedIncomeYear3, False)
        BehaviorControls(DescriptionOtherEarnedIncome, False)
        BehaviorControls(TotalUnearnedIncomeYear1, False)
        BehaviorControls(TotalUnearnedIncomeYear2, False)
        BehaviorControls(TotalUnearnedIncomeYear3, False)
        BehaviorControls(Cash, False)
        BehaviorControls(RealEstate, False)
        BehaviorControls(BusinessEquity, False)
        BehaviorControls(Stocks, False)
        BehaviorControls(OtherAssets1, False)
        BehaviorControls(DescribeOtherAssets1, False)
        BehaviorControls(OtherAssets2, False)
        BehaviorControls(DescribeOtherAssets2, False)
        BehaviorControls(OtherAssets3, False)
        BehaviorControls(DescribeOtherAssets3, False)
        BehaviorControls(OtherAssets4, False)
        BehaviorControls(DescribeOtherAssets4, False)
        BehaviorControls(TotalAssets, False)
        BehaviorControls(Mortgages, False)
        BehaviorControls(Loans, False)
        BehaviorControls(Liens, False)
        BehaviorControls(Bonds, False)
        BehaviorControls(OtherLiabilities1, False)
        BehaviorControls(DescribeOtherLiabilities1, False)
        BehaviorControls(OtherLiabilities2, False)
        BehaviorControls(DescribeOtherLiabilities2, False)
        BehaviorControls(OtherLiabilities3, False)
        BehaviorControls(DescribeOtherLiabilities3, False)
        BehaviorControls(OtherLiabilities4, False)
        BehaviorControls(DescribeOtherLiabilities4, False)
        BehaviorControls(TotalLiabilities, False)
        BehaviorControls(AdditionalInformation, False)
        BehaviorControls(DateReceived, False)
        BehaviorControls(save, False)
        BehaviorControls(submit, False)
    
    End Sub
     
#End Region

#Region "Actions Data Methods"

    Private Function SessionTrace(message As String) As String

        If Not IsNothing(Session("Form.Track")) AndAlso Session("Form.Track").ToString.ToLower = "true" Then
            Dim tracelog As String = Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension(Page.AppRelativeVirtualPath)))

            tracelog += String.Format(CultureInfo.InvariantCulture, "{0} {1}<br>{2}", Now.ToString("hh:mm:ss.fff"), message, vbCrLf)
            Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension(Page.AppRelativeVirtualPath))) = tracelog
        End If

        Return message
    End Function
    
    Private Sub ControlsInitialization()

    End Sub     
  
    Private Sub ParametersToDictionary(ByRef target As Dictionary(Of String, Object))
        If IsNothing(target) Then
            target = New Dictionary(Of String, Object)

            target.Add("uwcaseid", _formData.uwcaseid) 
            target.Add("uwreqid", _formData.uwreqid) 
            target.Add("ClientName", _formData.ClientName) 
            target.Add("StatusCase", _formData.StatusCase) 
            target.Add("StatusRequirement", _formData.StatusRequirement) 
            target.Add("Financial", _formData.Financial) 
            target.Add("Year1", _formData.Year1) 
            target.Add("Year2", _formData.Year2) 
            target.Add("Year3", _formData.Year3) 
            target.Add("AllOK", _formData.AllOK) 
            target.Add("RiskInformation", _formData.RiskInformation) 
            target.Add("fromPanel", _formData.fromPanel) 
            target.Add("caseLocked", _formData.caseLocked) 
            target.Add("IsAnonymous", _formData.IsAnonymous) 
            target.Add("uwCaseIdInt64", _formData.uwCaseIdInt64) 
            target.Add("UsercodeFASI", _formData.UsercodeFASI) 
            target.Add("ClientUser", _formData.ClientUser) 

        Else
            target("uwcaseid") = _formData.uwcaseid 
            target("uwreqid") = _formData.uwreqid 
            target("ClientName") = _formData.ClientName 
            target("StatusCase") = _formData.StatusCase 
            target("StatusRequirement") = _formData.StatusRequirement 
            target("Financial") = _formData.Financial 
            target("Year1") = _formData.Year1 
            target("Year2") = _formData.Year2 
            target("Year3") = _formData.Year3 
            target("AllOK") = _formData.AllOK 
            target("RiskInformation") = _formData.RiskInformation 
            target("fromPanel") = _formData.fromPanel 
            target("caseLocked") = _formData.caseLocked 
            target("IsAnonymous") = _formData.IsAnonymous 
            target("uwCaseIdInt64") = _formData.uwCaseIdInt64 
            target("UsercodeFASI") = _formData.UsercodeFASI 
            target("ClientUser") = _formData.ClientUser 

        End If     
    End Sub
    
    Private Sub ExecuteActionsLoadForm()
                    Dim currentAction As String = SessionTrace("ActionsLoadForm")
                    
                    Try                          
                        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
                        Dim messageAction As String = String.Empty
                        Dim lastURL As String = String.Empty
                        Dim isNullResult As Boolean = True 
                        Dim isFoundData As Boolean  = False  
                        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
                        
                        ParametersToDictionary(parametersDictionary) 
                        
                        Dim WorkflowInArguments As New Dictionary(Of String, Object) 
 Dim WorkflowOutArguments As IDictionary(Of String, Object) 
   
                                                
                                    currentAction = SessionTrace("1. _formData.uwCaseIdInt64 = convert.ToInt64(_formData.uwcaseid)...") 
 
            currentAction = SessionTrace("1.1. _formData.uwCaseIdInt64 = convert.ToInt64(_formData.uwcaseid)...")

 _formData.uwCaseIdInt64 = convert.ToInt64(_formData.uwcaseid) 

            currentAction = SessionTrace("2. Call 'Retrieve Case Information' workflow in Synchronous mode with tracking") 
            WorkflowInArguments = New Dictionary(Of String, Object)
            With WorkflowInArguments
                .Add("uwcaseid", _formData.uwCaseIdInt64) 
                .Add("uwreqid", _formData.uwreqid) 
                .Add("ClientName", _formData.ClientName) 
                .Add("StatusCase", _formData.StatusCase) 
                .Add("StatusRequirement", _formData.StatusRequirement) 
                .Add("RiskInformation", _formData.RiskInformation) 
                .Add("Identifier", "FinancialActions") 
                .Add("context", _formContext) 
                .Add("caseLocked", _formData.caseLocked) 
            End With
            WorkflowOutArguments = InMotionGIT.Workflow.Support.Runtime.DoWorkFromForm("RetrieveCaseInformation", "1632D520-852F-46AD-8F03-D0A778676380", 10, WorkflowInArguments, True, True, Me.AppRelativeVirtualPath, _formData.InternalId)
             currentAction += " 'Mapping Outputs'" 
                _formData.uwCaseIdInt64 = WorkflowOutArguments("uwcaseid")
                _formData.uwreqid = WorkflowOutArguments("uwreqid")
                _formData.ClientName = WorkflowOutArguments("ClientName")
                _formData.StatusCase = WorkflowOutArguments("StatusCase")
                _formData.StatusRequirement = WorkflowOutArguments("StatusRequirement")
                _formData.RiskInformation = WorkflowOutArguments("RiskInformation")

            currentAction = SessionTrace("3. If _formData.fromPanel = true Then") 
If _formData.fromPanel = true Then

            currentAction = SessionTrace("4. part1.Enabled = false, zoned.Enabled = false, firma.Visible = false") 
            currentAction = SessionTrace("4.1. part1.Enabled = false...")
BehaviorShowControls("part1,Disabled")
            currentAction = SessionTrace("4.2. zoned.Enabled = false...")
BehaviorShowControls("zoned,Disabled")
            currentAction = SessionTrace("4.3. firma.Visible = false...")
BehaviorShowControls("firma,Hidden")

            End If

                        
                        currentAction = String.Empty
                         
                    Catch ex As Exception
                        InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
						_formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

                        If Request.QueryString("debug").IsNotEmpty Then
                            FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
                            FormMessageLabel.ForeColor = Drawing.Color.Black
                            FormMessageLabel.Font.Bold = True
                            MessageTable.Visible = True
                        End If
                        
                    Finally                     
                        If _formData.Errors.Count > 0 Then
                            SetErrors(_formData.Errors)
                        End If
                        
                        If _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
                            If Page.IsCallback Then
                                DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
                            Else
                                Response.ClearHeaders()
                                Response.ClearContent()
                                Response.Redirect(_webTransfer)
                            End If
                        End If
                   End Try
                   
               End Sub
    Private Sub ExecuteActionsInitializationForm()
                    Dim currentAction As String = SessionTrace("ActionsInitializationForm")
                    
                    Try                          
                        Dim _formContext As New InMotionGIT.Common.Contracts.Context(LanguageHelper.CurrentCultureToLanguage, formData.InternalId) With {.UserId = Session("UserId"), .UserCode = Session("nUsercode"), .SecuritySchemeCode = Session("sSche_code"), .AccessToken = Session("AccessToken")}
                        Dim messageAction As String = String.Empty
                        Dim lastURL As String = String.Empty
                        Dim isNullResult As Boolean = True 
                        Dim isFoundData As Boolean  = False 
                        Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
                        
                        ParametersToDictionary(parametersDictionary)
                        Dim WorkflowInArguments As New Dictionary(Of String, Object) 
 Dim WorkflowOutArguments As IDictionary(Of String, Object) 
  
                        
                                    currentAction = SessionTrace("1. _formData.uwCaseIdInt64 = convert.ToInt64(_formData.uwcaseid)...") 
 
            currentAction = SessionTrace("1.1. _formData.uwCaseIdInt64 = convert.ToInt64(_formData.uwcaseid)...")

 _formData.uwCaseIdInt64 = convert.ToInt64(_formData.uwcaseid) 

            currentAction = SessionTrace("2. Call 'Retrieve Case Information' workflow in Synchronous mode with tracking") 
            WorkflowInArguments = New Dictionary(Of String, Object)
            With WorkflowInArguments
                .Add("uwcaseid", _formData.uwCaseIdInt64) 
                .Add("uwreqid", _formData.uwreqid) 
                .Add("ClientName", _formData.ClientName) 
                .Add("StatusCase", _formData.StatusCase) 
                .Add("StatusRequirement", _formData.StatusRequirement) 
                .Add("RiskInformation", _formData.RiskInformation) 
                .Add("Identifier", "FinantialInitialization") 
                .Add("context", _formContext) 
                .Add("caseLocked", _formData.caseLocked) 
            End With
            WorkflowOutArguments = InMotionGIT.Workflow.Support.Runtime.DoWorkFromForm("RetrieveCaseInformation", "1632D520-852F-46AD-8F03-D0A778676380", 10, WorkflowInArguments, True, True, Me.AppRelativeVirtualPath, _formData.InternalId)
             currentAction += " 'Mapping Outputs'" 
                _formData.uwCaseIdInt64 = WorkflowOutArguments("uwcaseid")
                _formData.uwreqid = WorkflowOutArguments("uwreqid")
                _formData.ClientName = WorkflowOutArguments("ClientName")
                _formData.StatusCase = WorkflowOutArguments("StatusCase")
                _formData.StatusRequirement = WorkflowOutArguments("StatusRequirement")
                _formData.RiskInformation = WorkflowOutArguments("RiskInformation")

            currentAction = SessionTrace("3. _formData.Financial.Year3 = year(Date.Today)...") 
 
            currentAction = SessionTrace("3.1. _formData.Financial.Year3 = year(Date.Today)...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.Year3 = year(Date.Today) 
            currentAction = SessionTrace("3.2. _formData.Financial.Year2 = _formData.Financial.Year3 - 1...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.Year2 = _formData.Financial.Year3 - 1 
            currentAction = SessionTrace("3.3. _formData.Financial.Year1 = _formData.Financial.Year2 - 1...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.Year1 = _formData.Financial.Year2 - 1 
            currentAction = SessionTrace("3.4. _formData.Year1 = _formData.Financial.Year1...")

 _formData.Year1 = _formData.Financial.Year1 
            currentAction = SessionTrace("3.5. _formData.Year2 = _formData.Financial.Year2...")

 _formData.Year2 = _formData.Financial.Year2 
            currentAction = SessionTrace("3.6. _formData.Financial.Year3 = _formData.Financial.Year3...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.Year3 = _formData.Financial.Year3 

            currentAction = SessionTrace("4. _formData.Financial.DateReceived = Date.Today...") 
 
            currentAction = SessionTrace("4.1. _formData.Financial.DateReceived = Date.Today...")
          If IsNothing(_formData.Financial) Then
              _formData.Financial = New InMotionGIT.Questionnaires.Financial
          End If 

 _formData.Financial.DateReceived = Date.Today 

            currentAction = SessionTrace("7. _formData.AllOK = False...") 
 
            currentAction = SessionTrace("7.1. _formData.AllOK = False...")

 _formData.AllOK = False 


                        
                        currentAction = String.Empty
                         
                    Catch ex As Exception
                        InMotionGIT.Common.Helpers.LogHandler.ErrorLog(Page.AppRelativeVirtualPath, currentAction, ex)
						_formData.Errors.Add(New InMotionGIT.Common.Contracts.Errors.Error With {.Message = currentAction & " " & ex.Message, .Severity = InMotionGIT.Common.Contracts.Errors.Enumerations.EnumSeverity.Error})

                        If Request.QueryString("debug").IsNotEmpty Then
                            FormMessageLabel.Text = InMotionGIT.Common.Helpers.ExceptionHandlers.TraceInnerExceptionMessage(ex, True)
                            FormMessageLabel.ForeColor = Drawing.Color.Black
                            FormMessageLabel.Font.Bold = True
                            MessageTable.Visible = True
                        End If
                        
                    Finally                     
                        If _formData.Errors.Count > 0 Then
                            SetErrors(_formData.Errors)
                        End If
                        
                        If _formData.Errors.Count = 0 AndAlso Not String.IsNullOrEmpty(_webTransfer) Then
                            If Page.IsCallback Then
                                DevExpress.Web.ASPxClasses.ASPxWebControl.RedirectOnCallback(_webTransfer)
                            Else
                                Response.Redirect(_webTransfer)
                            End If
                        End If
                   End Try
                   
               End Sub
    
    
#End Region

#Region "Storage Data Methods"

    Private Sub StoreFormInformation()
      If Not IsNothing(_formData) Then

            If _foundData Then
                UpdateStorageData()
            Else
                InsertStorageData()
            End If
       End If
End Sub

    Private Function RetrieveFormInformation() As Boolean
        Dim result As Boolean = False
        Dim records As DataTable

        With New DataManagerFactory("SELECT Content FROM FrontOffice.DocumentCache WHERE FormId = @:FormId",
                                    "FrontOffice.DocumentCache", "FrontOfficeConnectionString")
                                    
            .AddParameter("FormId", DbType.AnsiStringFixedLength, 36, False, _FormID.Text)
            records = .QueryExecuteToTable(True)
        End With

        If records.Rows.Count > 0 Then
            result = True            
            _formData = Serialize.Deserialize(Of FinancialQuestionnaireUWParameter)(records.Rows(0).Item("Content"))
        End If
        
        Return result
    End Function

    Private Sub InsertStorageData()
        With New DataManagerFactory("INSERT INTO FrontOffice.DocumentCache (FormId, ModelId, UserId, Page, Content, CreationDate, UpdateDate) VALUES(@:FormId, @:ModelId, @:UserId, @:Page, @:Content, @:CreationDate, @:UpdateDate)",
                                    "FrontOffice.DocumentCache", "FrontOfficeConnectionString")
                                    
            .AddParameter("FormId", DbType.AnsiStringFixedLength, 36, False, _FormID.Text)
            .AddParameter("ModelId", DbType.AnsiStringFixedLength, 36, False, "0461B610-49D6-4563-BD9D-7899277AA730")
            .AddParameter("UserId", DbType.AnsiString, 256, False, UserInfo.UserName)
            .AddParameter("Page", DbType.AnsiString, 255, False, Me.AppRelativeVirtualPath)
            .AddParameter("Content", DbType.Xml, 1, False, Serialize.Serialize(Of FinancialQuestionnaireUWParameter)(_formData))
            .AddParameter("CreationDate", DbType.DateTime, 20, False, Now)
            .AddParameter("UpdateDate", DbType.DateTime, 20, False, Now)

            .CommandExecute()
        End With
    End Sub

    Private Sub UpdateStorageData()
        With New DataManagerFactory("UPDATE FrontOffice.DocumentCache SET ModelId = @:ModelId, UserId = @:UserId, Page = @:Page, Content = @:Content, UpdateDate = @:UpdateDate WHERE FormId = @:FormId",
                                    "FrontOffice.DocumentCache", "FrontOfficeConnectionString")
                                    
            .AddParameter("ModelId", DbType.AnsiStringFixedLength, 36, False, "0461B610-49D6-4563-BD9D-7899277AA730")
            .AddParameter("UserId", DbType.AnsiString, 256, False, UserInfo.UserName)
            .AddParameter("Page", DbType.AnsiString, 255, False, Me.AppRelativeVirtualPath)
            .AddParameter("Content", DbType.Xml, 1, False, Serialize.Serialize(Of FinancialQuestionnaireUWParameter)(_formData))
            .AddParameter("UpdateDate", DbType.DateTime, 20, False, Now)
            .AddParameter("FormId", DbType.AnsiStringFixedLength, 36, False, _FormID.Text)

            .CommandExecute()
        End With
    End Sub

#End Region




End Class

<Serializable()>
Public Class FinancialQuestionnaireUWParameter
    Inherits InMotionGIT.FrontOffice.Support.DataType.FormBase(Of  FinancialQuestionnaireUWParameter)

    ' Methods
    Public Sub New()
        MyBase.New()
    End Sub

    ' Properties
    Public Property uwcaseid As Int64
    Public Property uwreqid As Int64
    Public Property ClientName As String
    Public Property StatusCase As Int32
    Public Property StatusRequirement As Int32
    Public Property Financial As InMotionGIT.Questionnaires.Financial
    Public Property Year1 As Int32
    Public Property Year2 As Int32
    Public Property Year3 As Int32
    Public Property AllOK As Boolean
    Public Property RiskInformation As InMotionGIT.Policy.Entity.Contracts.RiskInformation
    Public Property fromPanel As Boolean
    Public Property caseLocked As Boolean
    Public Property IsAnonymous As Boolean
    Public Property uwCaseIdInt64 As Int64
    Public Property UsercodeFASI As Int32
    Public Property ClientUser As InMotionGIT.Client.Entity.Contracts.Client


End Class