'---------------------------------------------------------------------------------------------------
' <generated>
'     This code was generated by Form Designer v7.1.220.1 at 2019/02/25 12:30:47  model release 2, Form Generator v1.0.34.21
'     
'     Changes to this file may cause incorrect behavior and will be lost if the code is regenerated.
' </generated>
'---------------------------------------------------------------------------------------------------
      
#Region "using"

Imports System.Data
Imports System.Globalization
Imports System.Runtime.Serialization
Imports System.Web.Script.Services
Imports System.Web.Services
Imports InMotionGIT.Common.Helpers
Imports InMotionGIT.Common.Proxy
Imports InMotionGIT.FrontOffice.Support

#End Region

Namespace dli.forms

    Public Class H5CotizacionVidaResumenActions
        Inherits System.Web.UI.Page

#Region "Actions Methods"

       <WebMethod(EnableSession:=True)>
        Public Shared Function Initialization(id As String, urlid As String, fromid As String) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim instance As New EntryData With {.InstanceFormId = id}
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim currentAction As String = String.Empty
            Dim H5CotizacionVidaResumenParametersInstance As H5CotizacionVidaResumenParameters = Nothing

            Try
                If id.IsEmpty AndAlso urlid.IsEmpty Then
                    instance.InstanceFormId = System.Guid.NewGuid().ToString
                    
                    With instance

                    End With                
                    
                    H5CotizacionVidaResumenParametersInstance = EntryDataToClass(H5CotizacionVidaResumenParametersInstance, instance)
                    SetDefaultValuesFromQueryString(H5CotizacionVidaResumenParametersInstance)
                    
                    If fromid.IsNotEmpty Then
                        GetTransferParameters(H5CotizacionVidaResumenParametersInstance, fromid)
                        ValidateParametersInstance(H5CotizacionVidaResumenParametersInstance)
                    End If
                Else       
                    instance.InstanceFormId = id.IfEmpty(urlid)
                    H5CotizacionVidaResumenParametersInstance = RetrieveFormInformationFromSession(instance.InstanceFormId)
         
                    If IsNothing(H5CotizacionVidaResumenParametersInstance) then
                        H5CotizacionVidaResumenParametersInstance = EntryDataToClass(H5CotizacionVidaResumenParametersInstance, instance)
                        SetDefaultValuesFromQueryString(H5CotizacionVidaResumenParametersInstance)
                    End If
                End If

                HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath"))) = String.Empty

                If id.IsEmpty AndAlso urlid.IsEmpty Then
                    Form_Initialization(currentAction, H5CotizacionVidaResumenParametersInstance, resultData)
                End If


                instance = ClassToEntryData(instance, H5CotizacionVidaResumenParametersInstance) 
		        StoreFormInformationOnSession(H5CotizacionVidaResumenParametersInstance)
                
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                LogHandler.ErrorLog("H5CotizacionVidaResumen", "Initialization", ex)

                With resultData
                    .Success = False
                    .Reason = String.Format(CultureInfo.InvariantCulture, "{0} ({1})", ex.Message, currentAction)
                End With
            End Try

            Return resultData
        End Function
   

#End Region

#Region "Lookups Web Methods"


        <WebMethod()>
        Public Shared Function LookUpForGender(id As String) As InMotionGIT.FrontOffice.Support.DataType.ClientActionResult
            Dim result As New InMotionGIT.FrontOffice.Support.DataType.ClientActionResult With {.Success = True}
            Dim resultData As DataTable = Nothing
            Dim newLookupList As New List(Of InMotionGIT.Common.DataType.LookUpValue)
            
            
            Try
                
                With New DataManagerFactory(String.Format(CultureInfo.CurrentCulture,
                                                          "SELECT  TABLE18.SSEXCLIEN, TABLE18.SSTATREGT, TABLE18.SDESCRIPT FROM TABLE18 TABLE18  WHERE TABLE18.SSTATREGT = '{0}'  AND NOT SDESCRIPT IS NULL ORDER BY SDESCRIPT", "1"), 
                                            "TABLE18", "Linked.LatCombined")

                    
                    resultData = .QueryExecuteToTable(True)
                End With

                If Not IsNothing(resultData) Then
                    For Each item As DataRow In resultData.Rows
                        newLookupList.Add(New InMotionGIT.Common.DataType.LookUpValue With {.Code = item.StringValue("SSEXCLIEN"),
                                                                                            .Description = item.StringValue("SDESCRIPT")})
                    Next
                End If

                result.Data = newLookupList

            Catch ex As Exception
                LogHandler.ErrorLog("H5CotizacionVidaResumen", "LookUpForGender", ex)

                With result
                    .Success = False
                    .Reason = String.Format(CultureInfo.InvariantCulture, "{0} ({1})", ex.Message, "LookUpForGender")
                End With
            End Try
            Return result
        End Function

        <WebMethod()>
        Public Shared Function LookUpForCurrency(id As String) As InMotionGIT.FrontOffice.Support.DataType.ClientActionResult
            Dim result As New InMotionGIT.FrontOffice.Support.DataType.ClientActionResult With {.Success = True}
            Dim resultData As DataTable = Nothing
            Dim newLookupList As New List(Of InMotionGIT.Common.DataType.LookUpValue)
            
            
            Try
                
                With New DataManagerFactory(String.Format(CultureInfo.CurrentCulture,
                                                          "SELECT  TABLE11.NCODIGINT, TABLE11.SDESCRIPT, TABLE11.SSHORT_DES FROM TABLE11 TABLE11  WHERE TABLE11.SSTATREGT = '{0}'  ORDER BY TABLE11.SDESCRIPT ASC", "1"), 
                                            "TABLE11", "Linked.LatCombined")

                    
                    resultData = .QueryExecuteToTable(True)
                End With

                If Not IsNothing(resultData) Then
                    For Each item As DataRow In resultData.Rows
                        newLookupList.Add(New InMotionGIT.Common.DataType.LookUpValue With {.Code = item.NumericValue("NCODIGINT"),
                                                                                            .Description = item.StringValue("SSHORT_DES")})
                    Next
                End If

                result.Data = newLookupList

            Catch ex As Exception
                LogHandler.ErrorLog("H5CotizacionVidaResumen", "LookUpForCurrency", ex)

                With result
                    .Success = False
                    .Reason = String.Format(CultureInfo.InvariantCulture, "{0} ({1})", ex.Message, "LookUpForCurrency")
                End With
            End Try
            Return result
        End Function

        <WebMethod()>
        Public Shared Function LookUpForRelationship(id As String) As InMotionGIT.FrontOffice.Support.DataType.ClientActionResult
            Dim result As New InMotionGIT.FrontOffice.Support.DataType.ClientActionResult With {.Success = True}
            Dim resultData As DataTable = Nothing
            Dim newLookupList As New List(Of InMotionGIT.Common.DataType.LookUpValue)
            
            
            Try
                
                With New DataManagerFactory(String.Format(CultureInfo.CurrentCulture,
                                                          "SELECT  TABLE55.NRELATION, TABLE55.SSTATREGT, TABLE55.SDESCRIPT FROM TABLE55 TABLE55  WHERE TABLE55.SSTATREGT = '{0}'  AND NOT SDESCRIPT IS NULL ORDER BY SDESCRIPT", "1"), 
                                            "TABLE55", "Linked.LatCombined")

                    
                    resultData = .QueryExecuteToTable(True)
                End With

                If Not IsNothing(resultData) Then
                    For Each item As DataRow In resultData.Rows
                        newLookupList.Add(New InMotionGIT.Common.DataType.LookUpValue With {.Code = item.NumericValue("NRELATION"),
                                                                                            .Description = item.StringValue("SDESCRIPT")})
                    Next
                End If

                result.Data = newLookupList

            Catch ex As Exception
                LogHandler.ErrorLog("H5CotizacionVidaResumen", "LookUpForRelationship", ex)

                With result
                    .Success = False
                    .Reason = String.Format(CultureInfo.InvariantCulture, "{0} ({1})", ex.Message, "LookUpForRelationship")
                End With
            End Try
            Return result
        End Function

#End Region

#Region "Form Actions"

        Private Shared Sub Form_Initialization(ByRef currentAction As String, ByRef H5CotizacionVidaResumenParametersInstance As H5CotizacionVidaResumenParameters, ByRef resultData As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult)
            Dim UserInfo As New InMotionGIT.Membership.Providers.MemberContext
            Dim formContext As New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                        H5CotizacionVidaResumenParametersInstance.InternalId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                                     .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                                     .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                                     .AccessToken = HttpContext.Current.Session("AccessToken")}
            Dim selectDataTableItem As DataTable = Nothing
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim messageAction As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            Dim errors As InMotionGIT.Common.DataType.Notify
            currentAction = SessionTrace("Form_Initialization")

            currentAction = SessionTrace("9. Call 'Build Complete Address' workflow in Synchronous mode with tracking")
            WorkflowInArguments = New Dictionary(Of String, Object)

            With WorkflowInArguments
            .Add("context", formContext)
            .Add("Address", H5CotizacionVidaResumenParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress)
            End With

            WorkflowOutArguments = InMotionGIT.Workflow.Support.Runtime.DoWorkFromForm("BuildCompleteAddress", "6AA7B3BD-15F9-404F-B83A-CB003F75BB24", 4, WorkflowInArguments, True, True, HttpContext.Current.Request.UrlReferrer.AbsolutePath, H5CotizacionVidaResumenParametersInstance.InternalId)

            currentAction += "'Mapping Outputs'"
            H5CotizacionVidaResumenParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress = WorkflowOutArguments("Address")

            currentAction = SessionTrace("10. H5CotizacionVidaResumenParametersInstance.DireccionMostrar = H5CotizacionVidaResumenParametersInstance.RiskInformation.PrimaryIn...")
            currentAction = SessionTrace("10.1. H5CotizacionVidaResumenParametersInstance.DireccionMostrar = H5CotizacionVidaResumenParametersInstance.RiskInformation.PrimaryIn...")

            H5CotizacionVidaResumenParametersInstance.DireccionMostrar = H5CotizacionVidaResumenParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress.CompleteAddress


        End Sub

#End Region
#Region "Utilities"


        Private Shared Sub GetTransferParameters(parametersData As H5CotizacionVidaResumenParameters, fromid As String)
            Dim fromDocumentCache As Object = Nothing

            If Not String.IsNullOrEmpty(fromid) Then
                fromDocumentCache = HttpContext.Current.Session(fromid)
                HttpContext.Current.Session.Remove(fromid)

            Else
                fromDocumentCache = HttpContext.Current.Session(HttpContext.Current.Session("fromid"))
                HttpContext.Current.Session.Remove(HttpContext.Current.Session("fromid"))
                HttpContext.Current.Session.Remove("fromid")
            End If

            If Not IsNothing(fromDocumentCache) Then
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("RiskInformation", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("uwcaseid", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("uwreqid", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("InsuredAmount", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("InsuredAmountSelected", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PlanType", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ClientExistInDB", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("eMail", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Currency", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("QueryType", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("MasaCorporal", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Age", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("MessagePopUp", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("MessageIndicator", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("QuestionnairesAvailable", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ProducerClientID", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("BeneficiaryType", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("DefaultAddresses", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("LaboratoryRequired", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("LaboratorySelectedByUser", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PrimaryInsured", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("SendMailIndicator", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("MailToProducerIndicator", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("InRuleErros", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("AccumulatedAmount", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("CancelledPoliciesQuantity", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("OtherPoliciesSameRiskQuantity", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("InRuleMessage", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("OnLinePrintIndicator", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("OnLinePrintResult", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PolicyDocument", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ErrorsFound", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ReportURL", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("FormStatus", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("OnLinePrint", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("StatusRun", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("AddresseMailDLI", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ProductMasterDescription", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("DireccionMostrar", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ConsumerInformation", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ShowGeneral", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("StatusCase", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("RecoveryCaseIndicator", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("AnswerDiabetes", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("AnswerHeart", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("AnswerCancer", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PaymentMethod", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PreviousPayment", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ClienteIndicado", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("CompleteAddress", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("VerificarCuestionariosIndicador", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PlanillaModificacion", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PlanillaVisualizacion", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ProductDescription", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PrimaTotalAnual", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PrimaRecibo", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("MonedaRecibo", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("CurrentYear", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("MesTarjeta", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("AnoTarjeta", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ImagenMostrada", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ImagenIncluida", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("IsAnonymous", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("AgregarBeneficiario", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("TypeOfPersonBenef", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ValorAcumulado", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("BeneficiariosMail", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Codigo", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Descripcion", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("FondosMail", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("UsercodeBO", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("UsercodeFASI", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ClienteInformaExiste", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ClienteInformaEsUsuario", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("UsuarioClaveEntrada", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("UsuarioPassword", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("QRegistros", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("frompanel", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("GenderClient", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ShowAdditionalInformation", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ShowHealthInformation", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ShowBeneficiariesInformation", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ShowPaymentInformation", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ShowBasicInformation", fromDocumentCache, parametersData)
            End If
        End Sub

        Private Shared Function SessionTrace(message As String) As String

            If Not IsNothing(HttpContext.Current.Session("Form.Track")) AndAlso HttpContext.Current.Session("Form.Track").ToString.ToLower = "true" Then
                Dim tracelog As String = HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath")))

                tracelog += String.Format(CultureInfo.InvariantCulture, "{0} {1}<br>{2}", Now.ToString("hh:mm:ss.fff"), message, vbCrLf)
                HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath"))) = tracelog
            End If

            Return message
        End Function

#End Region
#Region "Storage Session Methods"

        Private Shared Function RetrieveFormInformationFromSession(id As String) As H5CotizacionVidaResumenParameters
            Dim source As String = HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.Storage.{0}", id))
            Dim instance As H5CotizacionVidaResumenParameters = Nothing

            If Not String.IsNullOrEmpty(source) Then
                instance = Serialize.Deserialize(Of H5CotizacionVidaResumenParameters)(source)
            End If

            Return instance
        End Function

        Private Shared Sub StoreFormInformationOnSession(instance As H5CotizacionVidaResumenParameters)
            If Not IsNothing(instance) Then
                HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.Storage.{0}", instance.InternalId)) = Serialize.Serialize(Of H5CotizacionVidaResumenParameters)(instance)
                HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.Title.{0}", instance.InternalId)) = "Mi Vida Vale - Resumen"
              
                If Not IsNothing(HttpContext.Current.Session("Form.Track")) AndAlso
                   HttpContext.Current.Session("Form.Track").ToString.ToLower = "true" Then

                    HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.H5CotizacionVidaResumen", instance.InternalId)) = instance
                End If

                If Not IsNothing(HttpContext.Current.Session("Form.Track.Parameters")) AndAlso
                   HttpContext.Current.Session("Form.Track.Parameters").ToString.ToLower = "true" Then

                    If Not IsNothing(HttpContext.Current.Session("Form.Track")) AndAlso HttpContext.Current.Session("Form.Track").ToString.ToLower = "true" Then
                        InMotionGIT.Common.Helpers.FileHandler.SaveContent(String.Format(CultureInfo.InvariantCulture, "{0}\{1}.H5CotizacionVidaResumen.txt",
                                                                                         ConfigurationManager.AppSettings("Path.Logs"), instance.InternalId),
                                                                                          HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture,
                                                                                                                     "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath"))))
                    End If

                    InMotionGIT.Common.Helpers.Serialize.SerializeToFile(Of H5CotizacionVidaResumenParameters)(instance,
                                                                                                String.Format(CultureInfo.InvariantCulture,
                                                                                                              "{0}\{1}.H5CotizacionVidaResumen.xml", ConfigurationManager.AppSettings("Path.Logs"), instance.InternalId), True)
                End If			
            End If
        End Sub

#End Region


#Region "Contracts Mappers"

        Private Shared Function EntryDataToClass(parametersData As H5CotizacionVidaResumenParameters, formData As EntryData) As H5CotizacionVidaResumenParameters
            If IsNothing(parametersData) Then
                parametersData = New H5CotizacionVidaResumenParameters
            End If

            If IsNothing(parametersData.RiskInformation) Then
                parametersData.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
            End If
            If IsNothing(parametersData.RiskInformation.PrimaryInsured) Then
                parametersData.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
            End If
            If IsNothing(parametersData.RiskInformation.PrimaryInsured.Client) Then
                parametersData.RiskInformation.PrimaryInsured.Client = New InMotionGIT.Client.Entity.Contracts.Client
            End If
            If IsNothing(parametersData.AddresseMailDLI) Then
                parametersData.AddresseMailDLI = New InMotionGIT.AddressManager.Contract.Models.AddresseMailDLI
            End If
            If IsNothing(parametersData.AddresseMailDLI.eMailAddress) Then
                parametersData.AddresseMailDLI.eMailAddress = New InMotionGIT.AddressManager.Contract.General.eMailAddress
            End If
            If IsNothing(parametersData.RiskInformation.CoveragesWithCalculatedPremium) Then
                parametersData.RiskInformation.CoveragesWithCalculatedPremium = New InMotionGIT.Policy.Entity.Contracts.CoverageWithCalculatedPremiumCollection
            End If
            If IsNothing(parametersData.RiskInformation.Beneficiaries) Then
                parametersData.RiskInformation.Beneficiaries = New InMotionGIT.Policy.Entity.Contracts.BeneficiaryCollection
            End If
            If IsNothing(parametersData.QuestionnairesAvailable) Then
                parametersData.QuestionnairesAvailable = New InMotionGIT.Questionnaires.QuestionnairesAvailable
            End If

            With parametersData
                .InternalId = formData.InstanceFormId
                .RiskInformation.EffectiveDate = formData.RiskInformationEffectiveDate
                .ProductMasterDescription = formData.ProductMasterDescription
                .RiskInformation.PrimaryInsured.Client.FirstName = formData.RiskInformationPrimaryInsuredClientFirstName
                .RiskInformation.PrimaryInsured.Client.LastName = formData.RiskInformationPrimaryInsuredClientLastName
                .RiskInformation.PrimaryInsured.Client.LastName2 = formData.RiskInformationPrimaryInsuredClientLastName2
                .RiskInformation.PrimaryInsured.Client.BirthDate = formData.RiskInformationPrimaryInsuredClientBirthDate
                .RiskInformation.PrimaryInsured.Client.SmokerIndicator = formData.RiskInformationPrimaryInsuredClientSmokerIndicator
                .RiskInformation.PrimaryInsured.Client.Gender = formData.RiskInformationPrimaryInsuredClientGender
                .RiskInformation.PrimaryInsured.Client.Height = formData.RiskInformationPrimaryInsuredClientHeight
                .RiskInformation.PrimaryInsured.Client.Weight = formData.RiskInformationPrimaryInsuredClientWeight
                .AddresseMailDLI.eMailAddress.eMail = formData.AddresseMailDLIeMailAddresseMail
                .DireccionMostrar = formData.DireccionMostrar
                .RiskInformation.InsuredAmount = formData.RiskInformationInsuredAmount
                .RiskInformation.Currency = formData.RiskInformationCurrency

                .BeneficiaryType = formData.BeneficiaryType

                .QuestionnairesAvailable.Diabetes = formData.QuestionnairesAvailableDiabetes
                .QuestionnairesAvailable.Heart = formData.QuestionnairesAvailableHeart
                .QuestionnairesAvailable.Cancer = formData.QuestionnairesAvailableCancer
            End With

            Return parametersData
        End Function

        Private Shared Function ClassToEntryData(formData As EntryData, parametersData As H5CotizacionVidaResumenParameters) As EntryData
            formData = New EntryData

            With formData
                .InstanceFormId = parametersData.InternalId
                If Not IsNothing(parametersData.RiskInformation) Then
                    .RiskInformationEffectiveDate = parametersData.RiskInformation.EffectiveDate
                End If
                .ProductMasterDescription = parametersData.ProductMasterDescription
                If Not IsNothing(parametersData.RiskInformation) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured.Client) Then
                    .RiskInformationPrimaryInsuredClientFirstName = parametersData.RiskInformation.PrimaryInsured.Client.FirstName
                End If
                If Not IsNothing(parametersData.RiskInformation) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured.Client) Then
                    .RiskInformationPrimaryInsuredClientLastName = parametersData.RiskInformation.PrimaryInsured.Client.LastName
                End If
                If Not IsNothing(parametersData.RiskInformation) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured.Client) Then
                    .RiskInformationPrimaryInsuredClientLastName2 = parametersData.RiskInformation.PrimaryInsured.Client.LastName2
                End If
                If Not IsNothing(parametersData.RiskInformation) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured.Client) Then
                    .RiskInformationPrimaryInsuredClientBirthDate = parametersData.RiskInformation.PrimaryInsured.Client.BirthDate
                End If
                If Not IsNothing(parametersData.RiskInformation) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured.Client) Then
                    .RiskInformationPrimaryInsuredClientSmokerIndicator = parametersData.RiskInformation.PrimaryInsured.Client.SmokerIndicator
                End If
                If Not IsNothing(parametersData.RiskInformation) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured.Client) Then
                    .RiskInformationPrimaryInsuredClientGender = parametersData.RiskInformation.PrimaryInsured.Client.Gender
                End If
                If Not IsNothing(parametersData.RiskInformation) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured.Client) Then
                    .RiskInformationPrimaryInsuredClientHeight = parametersData.RiskInformation.PrimaryInsured.Client.Height
                End If
                If Not IsNothing(parametersData.RiskInformation) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured.Client) Then
                    .RiskInformationPrimaryInsuredClientWeight = parametersData.RiskInformation.PrimaryInsured.Client.Weight
                End If
                If Not IsNothing(parametersData.AddresseMailDLI) AndAlso Not IsNothing(parametersData.AddresseMailDLI.eMailAddress) Then
                    .AddresseMailDLIeMailAddresseMail = parametersData.AddresseMailDLI.eMailAddress.eMail
                End If
                .DireccionMostrar = parametersData.DireccionMostrar
                If Not IsNothing(parametersData.RiskInformation) Then
                    .RiskInformationInsuredAmount = parametersData.RiskInformation.InsuredAmount
                End If
                If Not IsNothing(parametersData.RiskInformation) Then
                    .RiskInformationCurrency = parametersData.RiskInformation.Currency
                End If
                If Not IsNothing(parametersData.RiskInformation) Then
                    .RiskInformationTotalOriginalAnnualPremium = parametersData.RiskInformation.TotalOriginalAnnualPremium
                End If
                .CoverageWithCalculatedPremium_CoverageWithCalculatedPremium = New List(Of CoverageWithCalculatedPremium_CoverageWithCalculatedPremiumItem)

                If Not IsNothing(parametersData.RiskInformation) AndAlso Not IsNothing(parametersData.RiskInformation.CoveragesWithCalculatedPremium) Then
                    Dim newItem as CoverageWithCalculatedPremium_CoverageWithCalculatedPremiumItem
                    
                    For Each itemData As InMotionGIT.Policy.Entity.Contracts.CoverageWithCalculatedPremium In parametersData.RiskInformation.CoveragesWithCalculatedPremium
                        newItem = New CoverageWithCalculatedPremium_CoverageWithCalculatedPremiumItem
                        
                        With newItem
                            .CoverageCode = itemData.CoverageCode
                            .Description = itemData.Description
                            .InsuredAmount = itemData.InsuredAmount
                            .AnnualPremium = itemData.AnnualPremium
                            .SelectedByDefault = itemData.SelectedByDefault                        
                        End With
                        
                        .CoverageWithCalculatedPremium_CoverageWithCalculatedPremium.Add(newItem)
                    Next
                End If


                .BeneficiaryType = parametersData.BeneficiaryType
                .Beneficiary_Beneficiary = New List(Of Beneficiary_BeneficiaryItem)

                If Not IsNothing(parametersData.RiskInformation) AndAlso Not IsNothing(parametersData.RiskInformation.Beneficiaries) Then
                    Dim newItem as Beneficiary_BeneficiaryItem
                    
                    For Each itemData As InMotionGIT.Policy.Entity.Contracts.Beneficiary In parametersData.RiskInformation.Beneficiaries
                        newItem = New Beneficiary_BeneficiaryItem
                        
                        With newItem
                            If Not IsNothing(itemData.Client) Then
                                .ClientCompleteClientName = itemData.Client.CompleteClientName
                            End If
                            .PercentageShare = itemData.PercentageShare
                            .Relationship = itemData.Relationship
                            .ClientID = itemData.ClientID                        
                        End With
                        
                        .Beneficiary_Beneficiary.Add(newItem)
                    Next
                End If


                If Not IsNothing(parametersData.QuestionnairesAvailable) Then
                    .QuestionnairesAvailableDiabetes = parametersData.QuestionnairesAvailable.Diabetes
                End If
                If Not IsNothing(parametersData.QuestionnairesAvailable) Then
                    .QuestionnairesAvailableHeart = parametersData.QuestionnairesAvailable.Heart
                End If
                If Not IsNothing(parametersData.QuestionnairesAvailable) Then
                    .QuestionnairesAvailableCancer = parametersData.QuestionnairesAvailable.Cancer
                End If
            End With

            Return formData
        End Function

#End Region

#Region "Common Utilities"

        Private Shared Sub SetDefaultValuesFromQueryString(formData As H5CotizacionVidaResumenParameters)
            If HttpContext.Current.Request.QueryString("uwcaseid").IsNotEmpty Then
                formData.uwcaseid = HttpContext.Current.Request.QueryString("uwcaseid")
            End If
            If HttpContext.Current.Request.QueryString("uwreqid").IsNotEmpty Then
                formData.uwreqid = HttpContext.Current.Request.QueryString("uwreqid")
            End If
            If HttpContext.Current.Request.QueryString("InsuredAmount").IsNotEmpty Then
                formData.InsuredAmount = HttpContext.Current.Request.QueryString("InsuredAmount")
            End If
            If HttpContext.Current.Request.QueryString("InsuredAmountSelected").IsNotEmpty Then
                formData.InsuredAmountSelected = HttpContext.Current.Request.QueryString("InsuredAmountSelected")
            End If
            If HttpContext.Current.Request.QueryString("PlanType").IsNotEmpty Then
                formData.PlanType = HttpContext.Current.Request.QueryString("PlanType")
            End If
            If HttpContext.Current.Request.QueryString("ClientExistInDB").IsNotEmpty Then
                formData.ClientExistInDB = HttpContext.Current.Request.QueryString("ClientExistInDB")
            End If
            If HttpContext.Current.Request.QueryString("eMail").IsNotEmpty Then
                formData.eMail = HttpContext.Current.Request.QueryString("eMail")
            End If
            If HttpContext.Current.Request.QueryString("Currency").IsNotEmpty Then
                formData.Currency = HttpContext.Current.Request.QueryString("Currency")
            End If
            If HttpContext.Current.Request.QueryString("QueryType").IsNotEmpty Then
                formData.QueryType = HttpContext.Current.Request.QueryString("QueryType")
            End If
            If HttpContext.Current.Request.QueryString("MasaCorporal").IsNotEmpty Then
                formData.MasaCorporal = HttpContext.Current.Request.QueryString("MasaCorporal")
            End If
            If HttpContext.Current.Request.QueryString("Age").IsNotEmpty Then
                formData.Age = HttpContext.Current.Request.QueryString("Age")
            End If
            If HttpContext.Current.Request.QueryString("MessagePopUp").IsNotEmpty Then
                formData.MessagePopUp = HttpContext.Current.Request.QueryString("MessagePopUp")
            End If
            If HttpContext.Current.Request.QueryString("MessageIndicator").IsNotEmpty Then
                formData.MessageIndicator = HttpContext.Current.Request.QueryString("MessageIndicator")
            End If
            If HttpContext.Current.Request.QueryString("ProducerClientID").IsNotEmpty Then
                formData.ProducerClientID = HttpContext.Current.Request.QueryString("ProducerClientID")
            End If
            If HttpContext.Current.Request.QueryString("BeneficiaryType").IsNotEmpty Then
                formData.BeneficiaryType = HttpContext.Current.Request.QueryString("BeneficiaryType")
            End If
            If HttpContext.Current.Request.QueryString("DefaultAddresses").IsNotEmpty Then
                formData.DefaultAddresses = HttpContext.Current.Request.QueryString("DefaultAddresses")
            End If
            If HttpContext.Current.Request.QueryString("LaboratoryRequired").IsNotEmpty Then
                formData.LaboratoryRequired = HttpContext.Current.Request.QueryString("LaboratoryRequired")
            End If
            If HttpContext.Current.Request.QueryString("LaboratorySelectedByUser").IsNotEmpty Then
                formData.LaboratorySelectedByUser = HttpContext.Current.Request.QueryString("LaboratorySelectedByUser")
            End If
            If HttpContext.Current.Request.QueryString("PrimaryInsured").IsNotEmpty Then
                formData.PrimaryInsured = HttpContext.Current.Request.QueryString("PrimaryInsured")
            End If
            If HttpContext.Current.Request.QueryString("SendMailIndicator").IsNotEmpty Then
                formData.SendMailIndicator = HttpContext.Current.Request.QueryString("SendMailIndicator")
            End If
            If HttpContext.Current.Request.QueryString("MailToProducerIndicator").IsNotEmpty Then
                formData.MailToProducerIndicator = HttpContext.Current.Request.QueryString("MailToProducerIndicator")
            End If
            If HttpContext.Current.Request.QueryString("InRuleErros").IsNotEmpty Then
                formData.InRuleErros = HttpContext.Current.Request.QueryString("InRuleErros")
            End If
            If HttpContext.Current.Request.QueryString("AccumulatedAmount").IsNotEmpty Then
                formData.AccumulatedAmount = HttpContext.Current.Request.QueryString("AccumulatedAmount")
            End If
            If HttpContext.Current.Request.QueryString("CancelledPoliciesQuantity").IsNotEmpty Then
                formData.CancelledPoliciesQuantity = HttpContext.Current.Request.QueryString("CancelledPoliciesQuantity")
            End If
            If HttpContext.Current.Request.QueryString("OtherPoliciesSameRiskQuantity").IsNotEmpty Then
                formData.OtherPoliciesSameRiskQuantity = HttpContext.Current.Request.QueryString("OtherPoliciesSameRiskQuantity")
            End If
            If HttpContext.Current.Request.QueryString("InRuleMessage").IsNotEmpty Then
                formData.InRuleMessage = HttpContext.Current.Request.QueryString("InRuleMessage")
            End If
            If HttpContext.Current.Request.QueryString("OnLinePrintIndicator").IsNotEmpty Then
                formData.OnLinePrintIndicator = HttpContext.Current.Request.QueryString("OnLinePrintIndicator")
            End If
            If HttpContext.Current.Request.QueryString("OnLinePrintResult").IsNotEmpty Then
                formData.OnLinePrintResult = HttpContext.Current.Request.QueryString("OnLinePrintResult")
            End If
            If HttpContext.Current.Request.QueryString("PolicyDocument").IsNotEmpty Then
                formData.PolicyDocument = HttpContext.Current.Request.QueryString("PolicyDocument")
            End If
            If HttpContext.Current.Request.QueryString("ErrorsFound").IsNotEmpty Then
                formData.ErrorsFound = HttpContext.Current.Request.QueryString("ErrorsFound")
            End If
            If HttpContext.Current.Request.QueryString("ReportURL").IsNotEmpty Then
                formData.ReportURL = HttpContext.Current.Request.QueryString("ReportURL")
            End If
            If HttpContext.Current.Request.QueryString("FormStatus").IsNotEmpty Then
                formData.FormStatus = HttpContext.Current.Request.QueryString("FormStatus")
            End If
            If HttpContext.Current.Request.QueryString("OnLinePrint").IsNotEmpty Then
                formData.OnLinePrint = HttpContext.Current.Request.QueryString("OnLinePrint")
            End If
            If HttpContext.Current.Request.QueryString("StatusRun").IsNotEmpty Then
                formData.StatusRun = HttpContext.Current.Request.QueryString("StatusRun")
            End If
            If HttpContext.Current.Request.QueryString("ProductMasterDescription").IsNotEmpty Then
                formData.ProductMasterDescription = HttpContext.Current.Request.QueryString("ProductMasterDescription")
            End If
            If HttpContext.Current.Request.QueryString("DireccionMostrar").IsNotEmpty Then
                formData.DireccionMostrar = HttpContext.Current.Request.QueryString("DireccionMostrar")
            End If
            If HttpContext.Current.Request.QueryString("ShowGeneral").IsNotEmpty Then
                formData.ShowGeneral = HttpContext.Current.Request.QueryString("ShowGeneral")
            End If
            If HttpContext.Current.Request.QueryString("StatusCase").IsNotEmpty Then
                formData.StatusCase = HttpContext.Current.Request.QueryString("StatusCase")
            End If
            If HttpContext.Current.Request.QueryString("RecoveryCaseIndicator").IsNotEmpty Then
                formData.RecoveryCaseIndicator = HttpContext.Current.Request.QueryString("RecoveryCaseIndicator")
            End If
            If HttpContext.Current.Request.QueryString("AnswerDiabetes").IsNotEmpty Then
                formData.AnswerDiabetes = HttpContext.Current.Request.QueryString("AnswerDiabetes")
            End If
            If HttpContext.Current.Request.QueryString("AnswerHeart").IsNotEmpty Then
                formData.AnswerHeart = HttpContext.Current.Request.QueryString("AnswerHeart")
            End If
            If HttpContext.Current.Request.QueryString("AnswerCancer").IsNotEmpty Then
                formData.AnswerCancer = HttpContext.Current.Request.QueryString("AnswerCancer")
            End If
            If HttpContext.Current.Request.QueryString("PaymentMethod").IsNotEmpty Then
                formData.PaymentMethod = HttpContext.Current.Request.QueryString("PaymentMethod")
            End If
            If HttpContext.Current.Request.QueryString("PreviousPayment").IsNotEmpty Then
                formData.PreviousPayment = HttpContext.Current.Request.QueryString("PreviousPayment")
            End If
            If HttpContext.Current.Request.QueryString("ClienteIndicado").IsNotEmpty Then
                formData.ClienteIndicado = HttpContext.Current.Request.QueryString("ClienteIndicado")
            End If
            If HttpContext.Current.Request.QueryString("CompleteAddress").IsNotEmpty Then
                formData.CompleteAddress = HttpContext.Current.Request.QueryString("CompleteAddress")
            End If
            If HttpContext.Current.Request.QueryString("VerificarCuestionariosIndicador").IsNotEmpty Then
                formData.VerificarCuestionariosIndicador = HttpContext.Current.Request.QueryString("VerificarCuestionariosIndicador")
            End If
            If HttpContext.Current.Request.QueryString("PlanillaModificacion").IsNotEmpty Then
                formData.PlanillaModificacion = HttpContext.Current.Request.QueryString("PlanillaModificacion")
            End If
            If HttpContext.Current.Request.QueryString("PlanillaVisualizacion").IsNotEmpty Then
                formData.PlanillaVisualizacion = HttpContext.Current.Request.QueryString("PlanillaVisualizacion")
            End If
            If HttpContext.Current.Request.QueryString("ProductDescription").IsNotEmpty Then
                formData.ProductDescription = HttpContext.Current.Request.QueryString("ProductDescription")
            End If
            If HttpContext.Current.Request.QueryString("PrimaTotalAnual").IsNotEmpty Then
                formData.PrimaTotalAnual = HttpContext.Current.Request.QueryString("PrimaTotalAnual")
            End If
            If HttpContext.Current.Request.QueryString("PrimaRecibo").IsNotEmpty Then
                formData.PrimaRecibo = HttpContext.Current.Request.QueryString("PrimaRecibo")
            End If
            If HttpContext.Current.Request.QueryString("MonedaRecibo").IsNotEmpty Then
                formData.MonedaRecibo = HttpContext.Current.Request.QueryString("MonedaRecibo")
            End If
            If HttpContext.Current.Request.QueryString("CurrentYear").IsNotEmpty Then
                formData.CurrentYear = HttpContext.Current.Request.QueryString("CurrentYear")
            End If
            If HttpContext.Current.Request.QueryString("MesTarjeta").IsNotEmpty Then
                formData.MesTarjeta = HttpContext.Current.Request.QueryString("MesTarjeta")
            End If
            If HttpContext.Current.Request.QueryString("AnoTarjeta").IsNotEmpty Then
                formData.AnoTarjeta = HttpContext.Current.Request.QueryString("AnoTarjeta")
            End If
            If HttpContext.Current.Request.QueryString("ImagenMostrada").IsNotEmpty Then
                formData.ImagenMostrada = HttpContext.Current.Request.QueryString("ImagenMostrada")
            End If
            If HttpContext.Current.Request.QueryString("ImagenIncluida").IsNotEmpty Then
                formData.ImagenIncluida = HttpContext.Current.Request.QueryString("ImagenIncluida")
            End If
            If HttpContext.Current.Request.QueryString("IsAnonymous").IsNotEmpty Then
                formData.IsAnonymous = HttpContext.Current.Request.QueryString("IsAnonymous")
            End If
            If HttpContext.Current.Request.QueryString("AgregarBeneficiario").IsNotEmpty Then
                formData.AgregarBeneficiario = HttpContext.Current.Request.QueryString("AgregarBeneficiario")
            End If
            If HttpContext.Current.Request.QueryString("TypeOfPersonBenef").IsNotEmpty Then
                formData.TypeOfPersonBenef = HttpContext.Current.Request.QueryString("TypeOfPersonBenef")
            End If
            If HttpContext.Current.Request.QueryString("ValorAcumulado").IsNotEmpty Then
                formData.ValorAcumulado = HttpContext.Current.Request.QueryString("ValorAcumulado")
            End If
            If HttpContext.Current.Request.QueryString("BeneficiariosMail").IsNotEmpty Then
                formData.BeneficiariosMail = HttpContext.Current.Request.QueryString("BeneficiariosMail")
            End If
            If HttpContext.Current.Request.QueryString("Codigo").IsNotEmpty Then
                formData.Codigo = HttpContext.Current.Request.QueryString("Codigo")
            End If
            If HttpContext.Current.Request.QueryString("Descripcion").IsNotEmpty Then
                formData.Descripcion = HttpContext.Current.Request.QueryString("Descripcion")
            End If
            If HttpContext.Current.Request.QueryString("FondosMail").IsNotEmpty Then
                formData.FondosMail = HttpContext.Current.Request.QueryString("FondosMail")
            End If
            If HttpContext.Current.Request.QueryString("UsercodeBO").IsNotEmpty Then
                formData.UsercodeBO = HttpContext.Current.Request.QueryString("UsercodeBO")
            End If
            If HttpContext.Current.Request.QueryString("UsercodeFASI").IsNotEmpty Then
                formData.UsercodeFASI = HttpContext.Current.Request.QueryString("UsercodeFASI")
            End If
            If HttpContext.Current.Request.QueryString("ClienteInformaExiste").IsNotEmpty Then
                formData.ClienteInformaExiste = HttpContext.Current.Request.QueryString("ClienteInformaExiste")
            End If
            If HttpContext.Current.Request.QueryString("ClienteInformaEsUsuario").IsNotEmpty Then
                formData.ClienteInformaEsUsuario = HttpContext.Current.Request.QueryString("ClienteInformaEsUsuario")
            End If
            If HttpContext.Current.Request.QueryString("UsuarioClaveEntrada").IsNotEmpty Then
                formData.UsuarioClaveEntrada = HttpContext.Current.Request.QueryString("UsuarioClaveEntrada")
            End If
            If HttpContext.Current.Request.QueryString("UsuarioPassword").IsNotEmpty Then
                formData.UsuarioPassword = HttpContext.Current.Request.QueryString("UsuarioPassword")
            End If
            If HttpContext.Current.Request.QueryString("QRegistros").IsNotEmpty Then
                formData.QRegistros = HttpContext.Current.Request.QueryString("QRegistros")
            End If
            If HttpContext.Current.Request.QueryString("frompanel").IsNotEmpty Then
                formData.frompanel = HttpContext.Current.Request.QueryString("frompanel")
            End If
            If HttpContext.Current.Request.QueryString("GenderClient").IsNotEmpty Then
                formData.GenderClient = HttpContext.Current.Request.QueryString("GenderClient")
            End If
            If HttpContext.Current.Request.QueryString("ShowAdditionalInformation").IsNotEmpty Then
                formData.ShowAdditionalInformation = HttpContext.Current.Request.QueryString("ShowAdditionalInformation")
            End If
            If HttpContext.Current.Request.QueryString("ShowHealthInformation").IsNotEmpty Then
                formData.ShowHealthInformation = HttpContext.Current.Request.QueryString("ShowHealthInformation")
            End If
            If HttpContext.Current.Request.QueryString("ShowBeneficiariesInformation").IsNotEmpty Then
                formData.ShowBeneficiariesInformation = HttpContext.Current.Request.QueryString("ShowBeneficiariesInformation")
            End If
            If HttpContext.Current.Request.QueryString("ShowPaymentInformation").IsNotEmpty Then
                formData.ShowPaymentInformation = HttpContext.Current.Request.QueryString("ShowPaymentInformation")
            End If
            If HttpContext.Current.Request.QueryString("ShowBasicInformation").IsNotEmpty Then
                formData.ShowBasicInformation = HttpContext.Current.Request.QueryString("ShowBasicInformation")
            End If
        End Sub	

        Private Shared Sub ValidateParametersInstance(ByRef formData As H5CotizacionVidaResumenParameters)
            If IsNothing(formData.RiskInformation) Then
                formData.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
            End If
            If IsNothing(formData.RiskInformation.PrimaryInsured) Then
                formData.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
            End If
            If IsNothing(formData.RiskInformation.PrimaryInsured.Client) Then
                formData.RiskInformation.PrimaryInsured.Client = New InMotionGIT.Client.Entity.Contracts.Client
            End If
            If IsNothing(formData.AddresseMailDLI) Then
                formData.AddresseMailDLI = New InMotionGIT.AddressManager.Contract.Models.AddresseMailDLI
            End If
            If IsNothing(formData.AddresseMailDLI.eMailAddress) Then
                formData.AddresseMailDLI.eMailAddress = New InMotionGIT.AddressManager.Contract.General.eMailAddress
            End If
            If IsNothing(formData.RiskInformation.CoveragesWithCalculatedPremium) Then
                formData.RiskInformation.CoveragesWithCalculatedPremium = New InMotionGIT.Policy.Entity.Contracts.CoverageWithCalculatedPremiumCollection
            End If
            If IsNothing(formData.RiskInformation.Beneficiaries) Then
                formData.RiskInformation.Beneficiaries = New InMotionGIT.Policy.Entity.Contracts.BeneficiaryCollection
            End If
            If IsNothing(formData.QuestionnairesAvailable) Then
                formData.QuestionnairesAvailable = New InMotionGIT.Questionnaires.QuestionnairesAvailable
            End If

        End Sub

#End Region

#Region "Form Contracts"

        <Serializable()>
        <DataContract()>
        Public Class EntryData

            <DataMember()> Public Property InstanceFormId As String
            <DataMember()> Public Property RiskInformationEffectiveDate As System.DateTime
            <DataMember()> Public Property ProductMasterDescription As String
            <DataMember()> Public Property RiskInformationPrimaryInsuredClientFirstName As System.String
            <DataMember()> Public Property RiskInformationPrimaryInsuredClientLastName As System.String
            <DataMember()> Public Property RiskInformationPrimaryInsuredClientLastName2 As System.String
            <DataMember()> Public Property RiskInformationPrimaryInsuredClientBirthDate As System.DateTime
            <DataMember()> Public Property RiskInformationPrimaryInsuredClientSmokerIndicator As System.String
            <DataMember()> Public Property RiskInformationPrimaryInsuredClientGender As System.String
            <DataMember()> Public Property RiskInformationPrimaryInsuredClientHeight As System.Decimal
            <DataMember()> Public Property RiskInformationPrimaryInsuredClientWeight As System.Decimal
            <DataMember()> Public Property AddresseMailDLIeMailAddresseMail As System.String
            <DataMember()> Public Property DireccionMostrar As String
            <DataMember()> Public Property RiskInformationInsuredAmount As System.Decimal
            <DataMember()> Public Property RiskInformationCurrency As System.Int32
            <DataMember()> Public Property RiskInformationTotalOriginalAnnualPremium As System.Decimal
            <DataMember()> Public Property RiskInformationCoveragesWithCalculatedPremiumCoverageCode As System.Int32
            <DataMember()> Public Property RiskInformationCoveragesWithCalculatedPremiumDescription As System.String
            <DataMember()> Public Property RiskInformationCoveragesWithCalculatedPremiumInsuredAmount As System.Decimal
            <DataMember()> Public Property RiskInformationCoveragesWithCalculatedPremiumAnnualPremium As System.Decimal
            <DataMember()> Public Property CoverageWithCalculatedPremium_CoverageWithCalculatedPremium As List(Of CoverageWithCalculatedPremium_CoverageWithCalculatedPremiumItem)
            <DataMember()> Public Property BeneficiaryType As Int32
            <DataMember()> Public Property RiskInformationBeneficiariesClientCompleteClientName As System.String
            <DataMember()> Public Property RiskInformationBeneficiariesPercentageShare As System.Decimal
            <DataMember()> Public Property RiskInformationBeneficiariesRelationship As System.Int32
            <DataMember()> Public Property Beneficiary_Beneficiary As List(Of Beneficiary_BeneficiaryItem)
            <DataMember()> Public Property QuestionnairesAvailableDiabetes As System.Boolean
            <DataMember()> Public Property QuestionnairesAvailableHeart As System.Boolean
            <DataMember()> Public Property QuestionnairesAvailableCancer As System.Boolean

        End Class

        <Serializable()>
        <DataContract()>
        Public Class CoverageWithCalculatedPremium_CoverageWithCalculatedPremiumItem

            <DataMember()> Public Property CoverageCode As System.Int32
            <DataMember()> Public Property Description As System.String
            <DataMember()> Public Property InsuredAmount As System.Decimal
            <DataMember()> Public Property AnnualPremium As System.Decimal
            <DataMember()> Public Property SelectedByDefault As System.Boolean

        End Class

        <Serializable()>
        <DataContract()>
        Public Class Beneficiary_BeneficiaryItem

            <DataMember()> Public Property ClientCompleteClientName As System.String
            <DataMember()> Public Property PercentageShare As System.Decimal
            <DataMember()> Public Property Relationship As System.Int32
            <DataMember()> Public Property ClientID As System.String

        End Class

        <Serializable()>
        Public Class H5CotizacionVidaResumenParameters
            Inherits InMotionGIT.FrontOffice.Support.DataType.FormBase(Of H5CotizacionVidaResumenParameters)

            Public Property RiskInformation As InMotionGIT.Policy.Entity.Contracts.RiskInformation
            Public Property uwcaseid As Int64
            Public Property uwreqid As Int64
            Public Property InsuredAmount As Decimal
            Public Property InsuredAmountSelected As Decimal
            Public Property PlanType As Int32
            Public Property ClientExistInDB As Boolean
            Public Property eMail As String
            Public Property Currency As Int32
            Public Property QueryType As Int32
            Public Property MasaCorporal As Decimal
            Public Property Age As Int32
            Public Property MessagePopUp As String
            Public Property MessageIndicator As Boolean
            Public Property QuestionnairesAvailable As InMotionGIT.Questionnaires.QuestionnairesAvailable
            Public Property ProducerClientID As String
            Public Property BeneficiaryType As Int32
            Public Property DefaultAddresses As Boolean
            Public Property LaboratoryRequired As Boolean
            Public Property LaboratorySelectedByUser As Boolean
            Public Property PrimaryInsured As String
            Public Property SendMailIndicator As Boolean
            Public Property MailToProducerIndicator As Boolean
            Public Property InRuleErros As Boolean
            Public Property AccumulatedAmount As Decimal
            Public Property CancelledPoliciesQuantity As Int32
            Public Property OtherPoliciesSameRiskQuantity As Int32
            Public Property InRuleMessage As String
            Public Property OnLinePrintIndicator As Boolean
            Public Property OnLinePrintResult As Int32
            Public Property PolicyDocument As String
            Public Property ErrorsFound As Boolean
            Public Property ReportURL As String
            Public Property FormStatus As Int32
            Public Property OnLinePrint As Int32
            Public Property StatusRun As Boolean
            Public Property AddresseMailDLI As InMotionGIT.AddressManager.Contract.Models.AddresseMailDLI
            Public Property ProductMasterDescription As String
            Public Property DireccionMostrar As String
            Public Property ConsumerInformation As InMotionGIT.Common.Contracts.Process.ConsumerInformation
            Public Property ShowGeneral As Boolean
            Public Property StatusCase As Int32
            Public Property RecoveryCaseIndicator As Boolean
            Public Property AnswerDiabetes As String
            Public Property AnswerHeart As String
            Public Property AnswerCancer As String
            Public Property PaymentMethod As Int32
            Public Property PreviousPayment As Boolean
            Public Property ClienteIndicado As String
            Public Property CompleteAddress As String
            Public Property VerificarCuestionariosIndicador As Boolean
            Public Property PlanillaModificacion As String
            Public Property PlanillaVisualizacion As String
            Public Property ProductDescription As String
            Public Property PrimaTotalAnual As Decimal
            Public Property PrimaRecibo As Decimal
            Public Property MonedaRecibo As Int32
            Public Property CurrentYear As Int32
            Public Property MesTarjeta As Int32
            Public Property AnoTarjeta As Int32
            Public Property ImagenMostrada As String
            Public Property ImagenIncluida As String
            Public Property IsAnonymous As Boolean
            Public Property AgregarBeneficiario As Boolean
            Public Property TypeOfPersonBenef As Int32
            Public Property ValorAcumulado As Decimal
            Public Property BeneficiariosMail As String
            Public Property Codigo As Int32
            Public Property Descripcion As String
            Public Property FondosMail As String
            Public Property UsercodeBO As Int32
            Public Property UsercodeFASI As Int32
            Public Property ClienteInformaExiste As Boolean
            Public Property ClienteInformaEsUsuario As Boolean
            Public Property UsuarioClaveEntrada As String
            Public Property UsuarioPassword As String
            Public Property QRegistros As Int32
            Public Property frompanel As Boolean
            Public Property GenderClient As String
            Public Property ShowAdditionalInformation As Boolean
            Public Property ShowHealthInformation As Boolean
            Public Property ShowBeneficiariesInformation As Boolean
            Public Property ShowPaymentInformation As Boolean
            Public Property ShowBasicInformation As Boolean

        End Class
#End Region

    End Class

End Namespace