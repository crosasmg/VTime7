'---------------------------------------------------------------------------------------------------
' <generated>
'     This code was generated by Form Designer v7.1.218.1 at 2019-03-15 11:25:59 AM model release 4, Form Generator v1.0.34.25
'     
'     Changes to this file may cause incorrect behavior and will be lost if the code is regenerated.
' </generated>
'---------------------------------------------------------------------------------------------------
      
#Region "using"

Imports System.Data
Imports System.Globalization
Imports System.Runtime.Serialization
Imports System.Web.Script.Services
Imports System.Web.Services
Imports InMotionGIT.Common.Helpers
Imports InMotionGIT.Common.Proxy
Imports InMotionGIT.FrontOffice.Support

#End Region

Namespace dli.forms

    Public Class HT5EstadisticaPorProductoActions
        Inherits System.Web.UI.Page

#Region "Actions Methods"

       <WebMethod(EnableSession:=True)>
        Public Shared Function Initialization(id As String, urlid As String, fromid As String) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim instance As New EntryData With {.InstanceFormId = id}
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim currentAction As String = String.Empty
            
            Dim HT5EstadisticaPorProductoParametersInstance As HT5EstadisticaPorProductoParameters = Nothing

            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                
                If id.IsEmpty AndAlso urlid.IsEmpty Then
                    instance.InstanceFormId = System.Guid.NewGuid().ToString
                    
                    With instance

                    End With                
                    
                    HT5EstadisticaPorProductoParametersInstance = EntryDataToClass(HT5EstadisticaPorProductoParametersInstance, instance)
                    SetDefaultValuesFromQueryString(HT5EstadisticaPorProductoParametersInstance)
                    
                    If fromid.IsNotEmpty Then
                        GetTransferParameters(HT5EstadisticaPorProductoParametersInstance, fromid)
                        ValidateParametersInstance(HT5EstadisticaPorProductoParametersInstance)
                    End If
                Else       
                    instance.InstanceFormId = id.IfEmpty(urlid)
                    HT5EstadisticaPorProductoParametersInstance = RetrieveFormInformationFromSession(instance.InstanceFormId)
         
                    If IsNothing(HT5EstadisticaPorProductoParametersInstance) then
                        HT5EstadisticaPorProductoParametersInstance = EntryDataToClass(HT5EstadisticaPorProductoParametersInstance, instance)
                        SetDefaultValuesFromQueryString(HT5EstadisticaPorProductoParametersInstance)
                    End If
                End If

                HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath"))) = String.Empty

                If id.IsEmpty AndAlso urlid.IsEmpty Then
                    Form_Initialization(currentAction, HT5EstadisticaPorProductoParametersInstance, resultData)
                End If


                instance = ClassToEntryData(instance, HT5EstadisticaPorProductoParametersInstance) 
		        StoreFormInformationOnSession(HT5EstadisticaPorProductoParametersInstance)
                
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5EstadisticaPorProducto", "Initialization", currentAction)
            End Try
            
            Return resultData
        End Function
   
        <WebMethod(EnableSession:=True)>
        Public Shared Function button0Click(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5EstadisticaPorProductoParametersInstance As HT5EstadisticaPorProductoParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5EstadisticaPorProductoParametersInstance = RetrieveFormInformationFromSession(instance.InstanceFormId)
         
                    If IsNothing(HT5EstadisticaPorProductoParametersInstance) then
                        HT5EstadisticaPorProductoParametersInstance = EntryDataToClass(HT5EstadisticaPorProductoParametersInstance, instance)
                        SetDefaultValuesFromQueryString(HT5EstadisticaPorProductoParametersInstance)
                    End If
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("button0Click")
                HT5EstadisticaPorProductoParametersInstance = EntryDataToClass(HT5EstadisticaPorProductoParametersInstance, instance)
                currentAction = SessionTrace("2. HT5EstadisticaPorProductoParametersInstance.AnoAnterior = HT5EstadisticaPorProductoParametersInstance.AnoProceso - 1...")
                currentAction = SessionTrace("2.1. HT5EstadisticaPorProductoParametersInstance.AnoAnterior = HT5EstadisticaPorProductoParametersInstance.AnoProceso - 1...")

                HT5EstadisticaPorProductoParametersInstance.AnoAnterior = HT5EstadisticaPorProductoParametersInstance.AnoProceso - 1
                currentAction = SessionTrace("2.2. HT5EstadisticaPorProductoParametersInstance.AnoActual = HT5EstadisticaPorProductoParametersInstance.AnoProceso...")

                HT5EstadisticaPorProductoParametersInstance.AnoActual = HT5EstadisticaPorProductoParametersInstance.AnoProceso
                currentAction = SessionTrace("2.3. HT5EstadisticaPorProductoParametersInstance.AnoAnteriorDatos = HT5EstadisticaPorProductoParametersInstance.AnoAnterior...")

                HT5EstadisticaPorProductoParametersInstance.AnoAnteriorDatos = HT5EstadisticaPorProductoParametersInstance.AnoAnterior
                currentAction = SessionTrace("2.4. HT5EstadisticaPorProductoParametersInstance.AnoActualDatos = HT5EstadisticaPorProductoParametersInstance.AnoActual...")

                HT5EstadisticaPorProductoParametersInstance.AnoActualDatos = HT5EstadisticaPorProductoParametersInstance.AnoActual

                currentAction = SessionTrace("3. zone3.Visible = true")
                currentAction = SessionTrace("3.1. zone3.Visible = true...")
                resultData.AddControlBehavior("zone3", "show")

                currentAction = SessionTrace("4. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection = New InMotionGIT.Policy.Entity.Contracts.PROJECTVULCollection

                currentAction = SessionTrace("5. HT5EstadisticaPorProductoParametersInstance.WorkYear = HT5EstadisticaPorProductoParametersInstance.AnoProceso...")
                currentAction = SessionTrace("5.1. HT5EstadisticaPorProductoParametersInstance.WorkYear = HT5EstadisticaPorProductoParametersInstance.AnoProceso...")

                HT5EstadisticaPorProductoParametersInstance.WorkYear = HT5EstadisticaPorProductoParametersInstance.AnoProceso

                currentAction = SessionTrace("6. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 1 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("6.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 1 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 1 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("6.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 2 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 2 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("6.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("7. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL

                currentAction = SessionTrace("8. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("9. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 1...")
                currentAction = SessionTrace("9.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 1...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 1

                currentAction = SessionTrace("10. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmou...")
                currentAction = SessionTrace("10.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmou...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount
                currentAction = SessionTrace("10.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvail...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount

                currentAction = SessionTrace("11. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DDECLADAT >= @:CLAIMDDECLADAT3 AND CLAIM.DDECLADAT <= @:CLAIMDDECLADAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDDECLADAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDDECLADAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("12. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                currentAction = SessionTrace("12.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection

                currentAction = SessionTrace("13. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp)

                currentAction = SessionTrace("14. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 2 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("14.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 2 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 2 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("14.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 3 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 3 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("14.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("15. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL

                currentAction = SessionTrace("16. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("17. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 2...")
                currentAction = SessionTrace("17.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 2...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 2
                currentAction = SessionTrace("17.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmou...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount
                currentAction = SessionTrace("17.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvail...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount

                currentAction = SessionTrace("18. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("19. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                currentAction = SessionTrace("19.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection

                currentAction = SessionTrace("20. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp)

                currentAction = SessionTrace("21. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 3 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("21.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 3 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 3 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("21.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 4 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 4 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("21.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("22. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL

                currentAction = SessionTrace("23. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("24. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 3...")
                currentAction = SessionTrace("24.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 3...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 3
                currentAction = SessionTrace("24.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmou...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount
                currentAction = SessionTrace("24.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvail...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount

                currentAction = SessionTrace("25. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("26. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                currentAction = SessionTrace("26.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection

                currentAction = SessionTrace("27. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp)

                currentAction = SessionTrace("28. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 4 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("28.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 4 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 4 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("28.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 5 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 5 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("28.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("29. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL

                currentAction = SessionTrace("30. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("31. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 4...")
                currentAction = SessionTrace("31.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 4...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 4
                currentAction = SessionTrace("31.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmou...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount
                currentAction = SessionTrace("31.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvail...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount

                currentAction = SessionTrace("32. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("33. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                currentAction = SessionTrace("33.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection

                currentAction = SessionTrace("34. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp)

                currentAction = SessionTrace("35. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 5 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("35.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 5 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 5 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("35.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 6 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 6 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("35.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("36. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL

                currentAction = SessionTrace("37. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("38. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 5...")
                currentAction = SessionTrace("38.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 5...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 5
                currentAction = SessionTrace("38.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmou...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount
                currentAction = SessionTrace("38.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvail...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount

                currentAction = SessionTrace("39. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("40. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                currentAction = SessionTrace("40.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection

                currentAction = SessionTrace("41. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp)

                currentAction = SessionTrace("42. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 6 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("42.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 6 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 6 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("42.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 7 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 7 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("42.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("43. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL

                currentAction = SessionTrace("44. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("45. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 6...")
                currentAction = SessionTrace("45.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 6...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 6
                currentAction = SessionTrace("45.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmou...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount
                currentAction = SessionTrace("45.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvail...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount

                currentAction = SessionTrace("46. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("47. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                currentAction = SessionTrace("47.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection

                currentAction = SessionTrace("48. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp)

                currentAction = SessionTrace("49. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 7 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("49.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 7 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 7 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("49.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 8 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 8 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("49.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("50. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL

                currentAction = SessionTrace("51. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("52. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 7...")
                currentAction = SessionTrace("52.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 7...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 7
                currentAction = SessionTrace("52.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmou...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount
                currentAction = SessionTrace("52.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvail...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount

                currentAction = SessionTrace("53. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("54. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                currentAction = SessionTrace("54.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection

                currentAction = SessionTrace("55. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp)

                currentAction = SessionTrace("56. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 8 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("56.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 8 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 8 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("56.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 9 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 9 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("56.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("57. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL

                currentAction = SessionTrace("58. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("59. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 8...")
                currentAction = SessionTrace("59.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 8...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 8
                currentAction = SessionTrace("59.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmou...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount
                currentAction = SessionTrace("59.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvail...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount

                currentAction = SessionTrace("60. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("61. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                currentAction = SessionTrace("61.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection

                currentAction = SessionTrace("62. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp)

                currentAction = SessionTrace("63. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 9 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("63.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 9 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 9 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("63.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 10 & '/' & HT5EstadisticaPorProductoParametersInstance.Wor...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 10 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("63.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("64. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL

                currentAction = SessionTrace("65. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("66. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 9...")
                currentAction = SessionTrace("66.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 9...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 9
                currentAction = SessionTrace("66.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmou...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount
                currentAction = SessionTrace("66.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvail...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount

                currentAction = SessionTrace("67. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("68. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                currentAction = SessionTrace("68.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection

                currentAction = SessionTrace("69. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp)

                currentAction = SessionTrace("70. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 10 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")
                currentAction = SessionTrace("70.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 10 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 10 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("70.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 11 & '/' & HT5EstadisticaPorProductoParametersInstance.Wor...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 11 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("70.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("71. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL

                currentAction = SessionTrace("72. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("73. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 10...")
                currentAction = SessionTrace("73.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 10...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 10
                currentAction = SessionTrace("73.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmou...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount
                currentAction = SessionTrace("73.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvail...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount

                currentAction = SessionTrace("74. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("75. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                currentAction = SessionTrace("75.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection

                currentAction = SessionTrace("76. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp)

                currentAction = SessionTrace("77. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 11 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")
                currentAction = SessionTrace("77.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 11 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 11 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("77.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 12 & '/' & HT5EstadisticaPorProductoParametersInstance.Wor...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 12 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("77.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("78. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL

                currentAction = SessionTrace("79. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("80. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 11...")
                currentAction = SessionTrace("80.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 11...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 11
                currentAction = SessionTrace("80.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmou...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount
                currentAction = SessionTrace("80.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvail...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount

                currentAction = SessionTrace("81. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("82. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                currentAction = SessionTrace("82.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection

                currentAction = SessionTrace("83. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp)

                currentAction = SessionTrace("84. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 12 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")
                currentAction = SessionTrace("84.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 12 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 12 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("84.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 1 & '/' & (HT5EstadisticaPorProductoParametersInstance.Wor...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 1 & "/" & (HT5EstadisticaPorProductoParametersInstance.WorkYear+1)
                currentAction = SessionTrace("84.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("85. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL

                currentAction = SessionTrace("86. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("87. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 12...")
                currentAction = SessionTrace("87.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 12...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.YearOfThePolicy = 12
                currentAction = SessionTrace("87.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmou...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AccumulatdAmount
                currentAction = SessionTrace("87.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvail...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp.SurrenderAvailableAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.SurrenderAvailableAmount

                currentAction = SessionTrace("88. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("89. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                currentAction = SessionTrace("89.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+_...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.ExcessAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL.AmountChargesFirstProjection

                currentAction = SessionTrace("90. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVULtmp)

                currentAction = SessionTrace("91. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DETCollection

                currentAction = SessionTrace("92. HT5EstadisticaPorProductoParametersInstance.WorkYear = HT5EstadisticaPorProductoParametersInstance.AnoProceso - 1...")
                currentAction = SessionTrace("92.1. HT5EstadisticaPorProductoParametersInstance.WorkYear = HT5EstadisticaPorProductoParametersInstance.AnoProceso - 1...")

                HT5EstadisticaPorProductoParametersInstance.WorkYear = HT5EstadisticaPorProductoParametersInstance.AnoProceso - 1

                currentAction = SessionTrace("93. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 1 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("93.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 1 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 1 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("93.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 2 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 2 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("93.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("94. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET

                currentAction = SessionTrace("95. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("96. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 1...")
                currentAction = SessionTrace("96.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 1...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 1
                currentAction = SessionTrace("96.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmo...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount
                currentAction = SessionTrace("96.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium

                currentAction = SessionTrace("97. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("98. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                currentAction = SessionTrace("98.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount

                currentAction = SessionTrace("99. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp)

                currentAction = SessionTrace("100. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 2 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("100.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 2 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 2 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("100.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 3 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 3 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("100.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("101. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET

                currentAction = SessionTrace("102. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("103. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 2...")
                currentAction = SessionTrace("103.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 2...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 2
                currentAction = SessionTrace("103.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmo...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount
                currentAction = SessionTrace("103.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium

                currentAction = SessionTrace("104. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("105. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                currentAction = SessionTrace("105.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount

                currentAction = SessionTrace("106. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp)

                currentAction = SessionTrace("107. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 3 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("107.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 3 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 3 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("107.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 4 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 4 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("107.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("108. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET

                currentAction = SessionTrace("109. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("110. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 3...")
                currentAction = SessionTrace("110.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 3...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 3
                currentAction = SessionTrace("110.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmo...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount
                currentAction = SessionTrace("110.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium

                currentAction = SessionTrace("111. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("112. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                currentAction = SessionTrace("112.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount

                currentAction = SessionTrace("113. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp)

                currentAction = SessionTrace("114. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 4 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("114.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 4 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 4 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("114.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 5 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 5 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("114.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("115. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET

                currentAction = SessionTrace("116. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("117. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 4...")
                currentAction = SessionTrace("117.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 4...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 4
                currentAction = SessionTrace("117.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmo...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount
                currentAction = SessionTrace("117.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium

                currentAction = SessionTrace("118. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("119. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                currentAction = SessionTrace("119.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount

                currentAction = SessionTrace("120. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp)

                currentAction = SessionTrace("121. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 5 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("121.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 5 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 5 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("121.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 6 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 6 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("121.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("122. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET

                currentAction = SessionTrace("123. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("124. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 5...")
                currentAction = SessionTrace("124.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 5...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 5
                currentAction = SessionTrace("124.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmo...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount
                currentAction = SessionTrace("124.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium

                currentAction = SessionTrace("125. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("126. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                currentAction = SessionTrace("126.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount

                currentAction = SessionTrace("127. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp)

                currentAction = SessionTrace("128. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 6 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("128.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 6 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 6 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("128.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 7 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 7 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("128.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("129. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET

                currentAction = SessionTrace("130. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("131. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 6...")
                currentAction = SessionTrace("131.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 6...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 6
                currentAction = SessionTrace("131.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmo...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount
                currentAction = SessionTrace("131.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium

                currentAction = SessionTrace("132. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("133. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                currentAction = SessionTrace("133.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount

                currentAction = SessionTrace("134. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp)

                currentAction = SessionTrace("135. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 7 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("135.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 7 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 7 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("135.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 8 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 8 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("135.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("136. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET

                currentAction = SessionTrace("137. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("138. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 7...")
                currentAction = SessionTrace("138.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 7...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 7
                currentAction = SessionTrace("138.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmo...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount
                currentAction = SessionTrace("138.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium

                currentAction = SessionTrace("139. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("140. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                currentAction = SessionTrace("140.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount

                currentAction = SessionTrace("141. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp)

                currentAction = SessionTrace("142. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 8 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("142.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 8 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 8 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("142.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 9 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 9 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("142.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("143. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET

                currentAction = SessionTrace("144. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("145. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 8...")
                currentAction = SessionTrace("145.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 8...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 8
                currentAction = SessionTrace("145.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmo...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount
                currentAction = SessionTrace("145.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium

                currentAction = SessionTrace("146. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("147. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                currentAction = SessionTrace("147.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount

                currentAction = SessionTrace("148. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp)

                currentAction = SessionTrace("149. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 9 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")
                currentAction = SessionTrace("149.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 9 & '/' & HT5EstadisticaPorProductoParametersInstance.WorkY...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 9 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("149.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 10 & '/' & HT5EstadisticaPorProductoParametersInstance.Wor...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 10 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("149.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("150. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET

                currentAction = SessionTrace("151. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("152. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 9...")
                currentAction = SessionTrace("152.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 9...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 9
                currentAction = SessionTrace("152.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmo...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount
                currentAction = SessionTrace("152.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium

                currentAction = SessionTrace("153. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("154. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                currentAction = SessionTrace("154.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount

                currentAction = SessionTrace("155. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp)

                currentAction = SessionTrace("156. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 10 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")
                currentAction = SessionTrace("156.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 10 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 10 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("156.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 11 & '/' & HT5EstadisticaPorProductoParametersInstance.Wor...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 11 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("156.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("157. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET

                currentAction = SessionTrace("158. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("159. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 10...")
                currentAction = SessionTrace("159.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 10...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 10
                currentAction = SessionTrace("159.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmo...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount
                currentAction = SessionTrace("159.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium

                currentAction = SessionTrace("160. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("161. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                currentAction = SessionTrace("161.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount

                currentAction = SessionTrace("162. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp)

                currentAction = SessionTrace("163. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 11 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")
                currentAction = SessionTrace("163.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 11 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 11 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("163.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 12 & '/' & HT5EstadisticaPorProductoParametersInstance.Wor...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 12 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("163.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("164. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET

                currentAction = SessionTrace("165. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("166. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 11...")
                currentAction = SessionTrace("166.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 11...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 11
                currentAction = SessionTrace("166.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmo...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount
                currentAction = SessionTrace("166.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium

                currentAction = SessionTrace("167. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("168. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                currentAction = SessionTrace("168.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount

                currentAction = SessionTrace("169. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp)

                currentAction = SessionTrace("170. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 12 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")
                currentAction = SessionTrace("170.1. HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & '/' & 12 & '/' & HT5EstadisticaPorProductoParametersInstance.Work...")

                HT5EstadisticaPorProductoParametersInstance.FechaDesde = 1 & "/" & 12 & "/" & HT5EstadisticaPorProductoParametersInstance.WorkYear
                currentAction = SessionTrace("170.2. HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & '/' & 1 & '/' & (HT5EstadisticaPorProductoParametersInstance.Wor...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta =  1 & "/" & 1 & "/" & (HT5EstadisticaPorProductoParametersInstance.WorkYear+1)
                currentAction = SessionTrace("170.3. HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)...")

                HT5EstadisticaPorProductoParametersInstance.FechaHasta = HT5EstadisticaPorProductoParametersInstance.FechaHasta.AddDays(-1)

                currentAction = SessionTrace("171. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp' = New 'InMotionGIT.Policy.Entity'...'")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET

                currentAction = SessionTrace("172. SELECT CERTIFICAT.SCERTYPE, CERTIFICAT.NBRANCH, CERTIFICAT.NPRODUCT FROM CERTIFICAT... WHERE CERTIFICAT.SCERTYPE = 2 AND CERTIFICAT.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CERTIFICAT.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(COVER.NPREMIUM) NPREMIUM, SUM(COVER.NCAPITAL) NCAPITAL FROM CERTIFICAT CERTIFICAT  JOIN COVER COVER ON COVER.SCERTYPE = CERTIFICAT.SCERTYPE AND COVER.NBRANCH = CERTIFICAT.NBRANCH AND COVER.NPRODUCT = CERTIFICAT.NPRODUCT AND COVER.NPOLICY = CERTIFICAT.NPOLICY AND COVER.NCERTIF = CERTIFICAT.NCERTIF WHERE (CERTIFICAT.SCERTYPE = '2' AND CERTIFICAT.NBRANCH = @:CERTIFICATNBRANCH1 AND CERTIFICAT.NPRODUCT = @:CERTIFICATNPRODUCT2 AND CERTIFICAT.DSTARTDATE <= @:CERTIFICATDSTARTDATE3 AND CERTIFICAT.SSTATUSVA <> '3' AND COVER.DEFFECDATE <= @:COVERDEFFECDATE5 AND COVER.DNULLDATE IS NULL)", "CERTIFICAT", "Linked.LatCombined")
.AddParameter("CERTIFICATNBRANCH1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CERTIFICATNPRODUCT2", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CERTIFICATDSTARTDATE3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
.AddParameter("COVERDEFFECDATE5", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium = .Rows(0).NumericValue("NPREMIUM") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount = .Rows(0).NumericValue("NCAPITAL") 

                        End If
                End With

                currentAction = SessionTrace("173. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 12...")
                currentAction = SessionTrace("173.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 12...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.YearOfThePolicy = 12
                currentAction = SessionTrace("173.2. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmo...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.InsuredAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.InsuredAmount
                currentAction = SessionTrace("173.3. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.Premium = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Premium

                currentAction = SessionTrace("174. SELECT CLAIM.NCLAIM, CLAIM.SCERTYPE, CLAIM.NPRODUCT FROM CLAIM... WHERE CLAIM.NBRANCH = HT5EstadisticaPorProductoParametersInstance.Ramo AND CLAIM.NPRODUCT = HT5EstadisticaPorProductoParametersInstance.Producto AND CLAIM.SSTACLAIM <> 6 AND )")
                isFoundData = False
                       With New DataManagerFactory("SELECT SUM(CL_COVER.NLOC_RESERV) NLOC_RESERV, SUM(CL_COVER.NLOC_PAY_AM) NLOC_PAY_AM FROM CLAIM CLAIM  JOIN CL_COVER CL_COVER ON CL_COVER.NCLAIM = CLAIM.NCLAIM WHERE (CLAIM.NBRANCH = @:CLAIMNBRANCH0 AND CLAIM.NPRODUCT = @:CLAIMNPRODUCT1 AND CLAIM.SSTACLAIM <> '6' AND CLAIM.DOCCURDAT >= @:CLAIMDOCCURDAT3 AND CLAIM.DOCCURDAT <= @:CLAIMDOCCURDAT4)", "CLAIM", "Linked.LatCombined")
.AddParameter("CLAIMNBRANCH0", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Ramo)
.AddParameter("CLAIMNPRODUCT1", DbType.Int32, 5, False, HT5EstadisticaPorProductoParametersInstance.Producto)
.AddParameter("CLAIMDOCCURDAT3", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaDesde = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaDesde)
.AddParameter("CLAIMDOCCURDAT4", DbType.DateTime, 0, (HT5EstadisticaPorProductoParametersInstance.FechaHasta = Date.MinValue), HT5EstadisticaPorProductoParametersInstance.FechaHasta)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET) Then
              HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
          End If 
                                                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount = .Rows(0).NumericValue("NLOC_RESERV") 
                        HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount = .Rows(0).NumericValue("NLOC_PAY_AM") 

                        End If
                End With

                currentAction = SessionTrace("175. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                currentAction = SessionTrace("175.1. HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.Accumulatd...")
                                If IsNothing(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp) Then
                    HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
                End If

                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp.AccumulatdAmount = HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.AccumulatdAmount+HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DET.ChargeAmount

                currentAction = SessionTrace("176. 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection'.Add('HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp')")
                HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection.Add(HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETtmp)

                currentAction = SessionTrace("177. tabcontainer13.ActiveTab = tab14")
                currentAction = SessionTrace("177.1. tabcontainer13.ActiveTab = tab14...")
                resultData.AddControlBehavior("tab14", "active")

                currentAction = SessionTrace("178. HT5EstadisticaPorProductoParametersInstance.MontoSiniestros = 0...")
                currentAction = SessionTrace("178.1. HT5EstadisticaPorProductoParametersInstance.MontoSiniestros = 0...")

                HT5EstadisticaPorProductoParametersInstance.MontoSiniestros = 0
                currentAction = SessionTrace("178.2. HT5EstadisticaPorProductoParametersInstance.PrimaTotal = 0...")

                HT5EstadisticaPorProductoParametersInstance.PrimaTotal = 0

                currentAction = SessionTrace("179. For Each projectvul_detItem As 'InMotionGIT.Policy.Entity...' In 'HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETC...'")
                For Each projectvul_detItem As InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET In HT5EstadisticaPorProductoParametersInstance.PROJECTVUL_DETCollection

                    currentAction = SessionTrace("180. HT5EstadisticaPorProductoParametersInstance.MontoSiniestros = HT5EstadisticaPorProductoParametersInstance.MontoSiniestros +projectv...")
                    currentAction = SessionTrace("180.1. HT5EstadisticaPorProductoParametersInstance.MontoSiniestros = HT5EstadisticaPorProductoParametersInstance.MontoSiniestros +projectv...")

                    HT5EstadisticaPorProductoParametersInstance.MontoSiniestros = HT5EstadisticaPorProductoParametersInstance.MontoSiniestros +projectvul_detItem.AccumulatdAmount
                    currentAction = SessionTrace("180.2. HT5EstadisticaPorProductoParametersInstance.PrimaTotal = HT5EstadisticaPorProductoParametersInstance.PrimaTotal+projectvul_det...")

                    HT5EstadisticaPorProductoParametersInstance.PrimaTotal = HT5EstadisticaPorProductoParametersInstance.PrimaTotal+projectvul_detItem.Premium

                    Next
                currentAction = SessionTrace("181. HT5EstadisticaPorProductoParametersInstance.SiniestralidadAnterior = (HT5EstadisticaPorProductoParametersInstance.MontoSiniestros * 100 ) ...")
                currentAction = SessionTrace("181.1. HT5EstadisticaPorProductoParametersInstance.SiniestralidadAnterior = (HT5EstadisticaPorProductoParametersInstance.MontoSiniestros * 100 ) ...")

                HT5EstadisticaPorProductoParametersInstance.SiniestralidadAnterior = (HT5EstadisticaPorProductoParametersInstance.MontoSiniestros * 100 ) / HT5EstadisticaPorProductoParametersInstance.PrimaTotal

                currentAction = SessionTrace("182. HT5EstadisticaPorProductoParametersInstance.MontoSiniestros = 0...")
                currentAction = SessionTrace("182.1. HT5EstadisticaPorProductoParametersInstance.MontoSiniestros = 0...")

                HT5EstadisticaPorProductoParametersInstance.MontoSiniestros = 0
                currentAction = SessionTrace("182.2. HT5EstadisticaPorProductoParametersInstance.PrimaTotal = 0...")

                HT5EstadisticaPorProductoParametersInstance.PrimaTotal = 0

                currentAction = SessionTrace("183. For Each projectvulItem As 'InMotionGIT.Policy.Entity...' In 'HT5EstadisticaPorProductoParametersInstance.PROJECTVULColle...'")
                For Each projectvulItem As InMotionGIT.Policy.Entity.Contracts.PROJECTVUL In HT5EstadisticaPorProductoParametersInstance.PROJECTVULCollection

                    currentAction = SessionTrace("184. HT5EstadisticaPorProductoParametersInstance.MontoSiniestros = HT5EstadisticaPorProductoParametersInstance.MontoSiniestros +projectv...")
                    currentAction = SessionTrace("184.1. HT5EstadisticaPorProductoParametersInstance.MontoSiniestros = HT5EstadisticaPorProductoParametersInstance.MontoSiniestros +projectv...")

                    HT5EstadisticaPorProductoParametersInstance.MontoSiniestros = HT5EstadisticaPorProductoParametersInstance.MontoSiniestros +projectvulItem.ExcessAmount
                    currentAction = SessionTrace("184.2. HT5EstadisticaPorProductoParametersInstance.PrimaTotal = HT5EstadisticaPorProductoParametersInstance.PrimaTotal+projectvulItem...")

                    HT5EstadisticaPorProductoParametersInstance.PrimaTotal = HT5EstadisticaPorProductoParametersInstance.PrimaTotal+projectvulItem.SurrenderAvailableAmount

                        Next
                currentAction = SessionTrace("185. HT5EstadisticaPorProductoParametersInstance.SiniestralidadActual = (HT5EstadisticaPorProductoParametersInstance.MontoSiniestros * 100 ) ...")
                currentAction = SessionTrace("185.1. HT5EstadisticaPorProductoParametersInstance.SiniestralidadActual = (HT5EstadisticaPorProductoParametersInstance.MontoSiniestros * 100 ) ...")

                HT5EstadisticaPorProductoParametersInstance.SiniestralidadActual = (HT5EstadisticaPorProductoParametersInstance.MontoSiniestros * 100 ) / HT5EstadisticaPorProductoParametersInstance.PrimaTotal


                instance = ClassToEntryData(instance, HT5EstadisticaPorProductoParametersInstance)
                StoreFormInformationOnSession(HT5EstadisticaPorProductoParametersInstance)
                
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5EstadisticaPorProducto", "button0Click", currentAction)
            End Try
            
            Return resultData
        End Function

#End Region

#Region "Lookups Web Methods"


        <WebMethod(EnableSession:=True)>
        Public Shared Function LookUpForRamo(id As String) As InMotionGIT.FrontOffice.Support.DataType.ClientActionResult
            Dim result As New InMotionGIT.FrontOffice.Support.DataType.ClientActionResult With {.Success = True}
            Dim resultData As DataTable = Nothing
            Dim newLookupList As New List(Of InMotionGIT.Common.DataType.LookUpValue)
            
            
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                
                With New DataManagerFactory(String.Format(CultureInfo.CurrentCulture,
                                                          "SELECT  TABLE10.NBRANCH, TABLE10.SDESCRIPT FROM TABLE10 TABLE10  WHERE TABLE10.SSTATREGT = '{0}'  AND NOT SDESCRIPT IS NULL ORDER BY SDESCRIPT", "1"), 
                                            "TABLE10", "Linked.LatCombined")

                    .Cache = InMotionGIT.Common.Enumerations.EnumCache.CacheWithCommand
                    resultData = .QueryExecuteToTable(True)
                End With

                If Not IsNothing(resultData) Then
                    For Each item As DataRow In resultData.Rows
                        newLookupList.Add(New InMotionGIT.Common.DataType.LookUpValue With {.Code = item.NumericValue("NBRANCH"),
                                                                                            .Description = item.StringValue("SDESCRIPT")})
                    Next
                End If

                result.Data = newLookupList

            Catch ex As Exception
                result = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessClientAction(ex, "HT5EstadisticaPorProducto", "LookUpForRamo", String.Empty)
            End Try
                        
            Return result
        End Function

        <WebMethod(EnableSession:=True)>
        Public Shared Function LookUpForProducto(id As String, Ramo As Int32) As InMotionGIT.FrontOffice.Support.DataType.ClientActionResult
            Dim result As New InMotionGIT.FrontOffice.Support.DataType.ClientActionResult With {.Success = True}
            Dim resultData As DataTable = Nothing
            Dim newLookupList As New List(Of InMotionGIT.Common.DataType.LookUpValue)
            
            
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                
                With New DataManagerFactory(String.Format(CultureInfo.CurrentCulture,
                                                          "SELECT  PRODMASTER.NPRODUCT, PRODMASTER.NBRANCH, PRODMASTER.SDESCRIPT FROM PRODMASTER PRODMASTER  WHERE PRODMASTER.SSTATREGT = '{0}'  AND (PRODMASTER.NBRANCH = @:PRODMASTERNBRANCHDependen AND NOT SDESCRIPT IS NULL) ORDER BY SDESCRIPT ", "1"), 
                                            "PRODMASTER", "Linked.LatCombined")
                    .AddParameter("PRODMASTERNBRANCHDependen", DbType.Int32, 0, False, Ramo)

                    .Cache = InMotionGIT.Common.Enumerations.EnumCache.CacheWithCommand
                    resultData = .QueryExecuteToTable(True)
                End With

                If Not IsNothing(resultData) Then
                    For Each item As DataRow In resultData.Rows
                        newLookupList.Add(New InMotionGIT.Common.DataType.LookUpValue With {.Code = item.NumericValue("NPRODUCT"),
                                                                                            .Description = item.StringValue("SDESCRIPT")})
                    Next
                End If

                result.Data = newLookupList

            Catch ex As Exception
                result = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessClientAction(ex, "HT5EstadisticaPorProducto", "LookUpForProducto", String.Empty)
            End Try
                        
            Return result
        End Function

#End Region

#Region "Form Actions"

        Private Shared Sub Form_Initialization(ByRef currentAction As String, ByRef HT5EstadisticaPorProductoParametersInstance As HT5EstadisticaPorProductoParameters, ByRef resultData As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult)
            Dim UserInfo As New InMotionGIT.Membership.Providers.MemberContext
            Dim formContext As New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                        HT5EstadisticaPorProductoParametersInstance.InternalId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                                     .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                                     .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                                     .AccessToken = HttpContext.Current.Session("AccessToken")}
            Dim selectDataTableItem As DataTable = Nothing
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim messageAction As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False

            currentAction = SessionTrace("Form_Initialization")

            currentAction = SessionTrace("1. HT5EstadisticaPorProductoParametersInstance.AnoProceso = Date.Today.Year - 1...")
            currentAction = SessionTrace("1.1. HT5EstadisticaPorProductoParametersInstance.AnoProceso = Date.Today.Year - 1...")

            HT5EstadisticaPorProductoParametersInstance.AnoProceso = Date.Today.Year - 1


        End Sub

#End Region
#Region "Utilities"


        Private Shared Sub GetTransferParameters(parametersData As HT5EstadisticaPorProductoParameters, fromid As String)
            Dim fromDocumentCache As Object = Nothing

            If Not String.IsNullOrEmpty(fromid) Then
                fromDocumentCache = HttpContext.Current.Session(fromid)
                HttpContext.Current.Session.Remove(fromid)

            Else
                fromDocumentCache = HttpContext.Current.Session(HttpContext.Current.Session("fromid"))
                HttpContext.Current.Session.Remove(HttpContext.Current.Session("fromid"))
                HttpContext.Current.Session.Remove("fromid")
            End If

            If Not IsNothing(fromDocumentCache) Then
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PROJECTVULCollection", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Ramo", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Producto", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("AnoProceso", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PROJECTVUL", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("AnoAnterior", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("AnoActual", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PROJECTVUL_DETCollection", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PROJECTVUL_DET", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("FechaDesde", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("FechaHasta", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("WorkYear", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PROJECTVULtmp", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PROJECTVUL_DETtmp", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("AnoAnteriorDatos", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("AnoActualDatos", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("SiniestralidadAnterior", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("SiniestralidadActual", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("MontoSiniestros", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PrimaTotal", fromDocumentCache, parametersData)
            End If
        End Sub

        Private Shared Function SessionTrace(message As String) As String

            If Not IsNothing(HttpContext.Current.Session("Form.Track")) AndAlso HttpContext.Current.Session("Form.Track").ToString.ToLower = "true" Then
                Dim tracelog As String = HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath")))

                tracelog += String.Format(CultureInfo.InvariantCulture, "{0} {1}<br>{2}", Now.ToString("hh:mm:ss.fff"), message, vbCrLf)
                HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath"))) = tracelog
            End If

            Return message
        End Function

#End Region
#Region "Storage Session Methods"

        Private Shared Function RetrieveFormInformationFromSession(id As String) As HT5EstadisticaPorProductoParameters
            Dim source As String = HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.Storage.{0}", id))
            Dim instance As HT5EstadisticaPorProductoParameters = Nothing

            If Not String.IsNullOrEmpty(source) Then
                instance = Serialize.Deserialize(Of HT5EstadisticaPorProductoParameters)(source)
            End If

            Return instance
        End Function

        Private Shared Sub StoreFormInformationOnSession(instance As HT5EstadisticaPorProductoParameters)
            If Not IsNothing(instance) Then
                HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.Storage.{0}", instance.InternalId)) = Serialize.Serialize(Of HT5EstadisticaPorProductoParameters)(instance)
                HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.Title.{0}", instance.InternalId)) = "HT5 Estadística por producto"
              
                If Not IsNothing(HttpContext.Current.Session("Form.Track")) AndAlso
                   HttpContext.Current.Session("Form.Track").ToString.ToLower = "true" Then

                    HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.HT5EstadisticaPorProducto", instance.InternalId)) = instance
                End If

                If Not IsNothing(HttpContext.Current.Session("Form.Track.Parameters")) AndAlso
                   HttpContext.Current.Session("Form.Track.Parameters").ToString.ToLower = "true" Then

                    If Not IsNothing(HttpContext.Current.Session("Form.Track")) AndAlso HttpContext.Current.Session("Form.Track").ToString.ToLower = "true" Then
                        InMotionGIT.Common.Helpers.FileHandler.SaveContent(String.Format(CultureInfo.InvariantCulture, "{0}\{1}.HT5EstadisticaPorProducto.txt",
                                                                                         ConfigurationManager.AppSettings("Path.Logs"), instance.InternalId),
                                                                                          HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture,
                                                                                                                     "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath"))))
                    End If

                    InMotionGIT.Common.Helpers.Serialize.SerializeToFile(Of HT5EstadisticaPorProductoParameters)(instance,
                                                                                                String.Format(CultureInfo.InvariantCulture,
                                                                                                              "{0}\{1}.HT5EstadisticaPorProducto.xml", ConfigurationManager.AppSettings("Path.Logs"), instance.InternalId), True)
                End If			
            End If
        End Sub

#End Region


#Region "Contracts Mappers"

        Private Shared Function EntryDataToClass(parametersData As HT5EstadisticaPorProductoParameters, formData As EntryData) As HT5EstadisticaPorProductoParameters
            If IsNothing(parametersData) Then
                parametersData = New HT5EstadisticaPorProductoParameters
            End If

            If IsNothing(parametersData.PROJECTVUL_DETCollection) Then
                parametersData.PROJECTVUL_DETCollection = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DETCollection
            End If
            If IsNothing(parametersData.PROJECTVULCollection) Then
                parametersData.PROJECTVULCollection = New InMotionGIT.Policy.Entity.Contracts.PROJECTVULCollection
            End If

            With parametersData
                .InternalId = formData.InstanceFormId
                .Ramo = formData.Ramo
                .Producto = formData.Producto
                .AnoProceso = formData.AnoProceso
                .AnoAnterior = formData.AnoAnterior
                .AnoActual = formData.AnoActual


                .SiniestralidadAnterior = formData.SiniestralidadAnterior
                .SiniestralidadActual = formData.SiniestralidadActual
            End With

            Return parametersData
        End Function

        Private Shared Function ClassToEntryData(formData As EntryData, parametersData As HT5EstadisticaPorProductoParameters) As EntryData
            formData = New EntryData

            With formData
                .InstanceFormId = parametersData.InternalId
                .Ramo = parametersData.Ramo
                .Producto = parametersData.Producto
                .AnoProceso = parametersData.AnoProceso
                .AnoAnterior = parametersData.AnoAnterior
                .AnoActual = parametersData.AnoActual
                .PROJECTVUL_DETCollection = New List(Of PROJECTVUL_DETCollectionItem)

                If Not IsNothing(parametersData.PROJECTVUL_DETCollection) Then
                    Dim newItem as PROJECTVUL_DETCollectionItem
                    
                    For Each itemData As InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET In parametersData.PROJECTVUL_DETCollection
                        newItem = New PROJECTVUL_DETCollectionItem
                        
                        With newItem
.YearOfThePolicy = itemData.YearOfThePolicy
.Premium = itemData.Premium
.AccumulatdAmount = itemData.AccumulatdAmount                        
                        End With
                        
                        .PROJECTVUL_DETCollection.Add(newItem)
                    Next
                End If


                .PROJECTVULCollection = New List(Of PROJECTVULCollectionItem)

                If Not IsNothing(parametersData.PROJECTVULCollection) Then
                    Dim newItem as PROJECTVULCollectionItem
                    
                    For Each itemData As InMotionGIT.Policy.Entity.Contracts.PROJECTVUL In parametersData.PROJECTVULCollection
                        newItem = New PROJECTVULCollectionItem
                        
                        With newItem
.YearOfThePolicy = itemData.YearOfThePolicy
.SurrenderAvailableAmount = itemData.SurrenderAvailableAmount
.ExcessAmount = itemData.ExcessAmount                        
                        End With
                        
                        .PROJECTVULCollection.Add(newItem)
                    Next
                End If


                .PROJECTVUL_DET_PROJECTVUL_DET = New List(Of PROJECTVUL_DET_PROJECTVUL_DETItem)

                If Not IsNothing(parametersData.PROJECTVUL_DETCollection) Then
                    Dim newItem as PROJECTVUL_DET_PROJECTVUL_DETItem
                    
                    For Each itemData As InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET In parametersData.PROJECTVUL_DETCollection
                        newItem = New PROJECTVUL_DET_PROJECTVUL_DETItem
                        
                        With newItem
                            .YearOfThePolicy = itemData.YearOfThePolicy
                            .Premium = itemData.Premium
                            .AccumulatdAmount = itemData.AccumulatdAmount                        
                        End With
                        
                        .PROJECTVUL_DET_PROJECTVUL_DET.Add(newItem)
                    Next
                End If


                .PROJECTVUL_PROJECTVUL = New List(Of PROJECTVUL_PROJECTVULItem)

                If Not IsNothing(parametersData.PROJECTVULCollection) Then
                    Dim newItem as PROJECTVUL_PROJECTVULItem
                    
                    For Each itemData As InMotionGIT.Policy.Entity.Contracts.PROJECTVUL In parametersData.PROJECTVULCollection
                        newItem = New PROJECTVUL_PROJECTVULItem
                        
                        With newItem
                            .YearOfThePolicy = itemData.YearOfThePolicy
                            .SurrenderAvailableAmount = itemData.SurrenderAvailableAmount
                            .ExcessAmount = itemData.ExcessAmount                        
                        End With
                        
                        .PROJECTVUL_PROJECTVUL.Add(newItem)
                    Next
                End If


                .SiniestralidadAnterior = parametersData.SiniestralidadAnterior
                .SiniestralidadActual = parametersData.SiniestralidadActual
            End With

            Return formData
        End Function

#End Region

#Region "Common Utilities"

        Private Shared Sub SetDefaultValuesFromQueryString(formData As HT5EstadisticaPorProductoParameters)
            If HttpContext.Current.Request.QueryString("Ramo").IsNotEmpty Then
                formData.Ramo = HttpContext.Current.Request.QueryString("Ramo")
            End If
            If HttpContext.Current.Request.QueryString("Producto").IsNotEmpty Then
                formData.Producto = HttpContext.Current.Request.QueryString("Producto")
            End If
            If HttpContext.Current.Request.QueryString("AnoProceso").IsNotEmpty Then
                formData.AnoProceso = HttpContext.Current.Request.QueryString("AnoProceso")
            End If
            If HttpContext.Current.Request.QueryString("AnoAnterior").IsNotEmpty Then
                formData.AnoAnterior = HttpContext.Current.Request.QueryString("AnoAnterior")
            End If
            If HttpContext.Current.Request.QueryString("AnoActual").IsNotEmpty Then
                formData.AnoActual = HttpContext.Current.Request.QueryString("AnoActual")
            End If
            If HttpContext.Current.Request.QueryString("FechaDesde").IsNotEmpty Then
                formData.FechaDesde = HttpContext.Current.Request.QueryString("FechaDesde")
            End If
            If HttpContext.Current.Request.QueryString("FechaHasta").IsNotEmpty Then
                formData.FechaHasta = HttpContext.Current.Request.QueryString("FechaHasta")
            End If
            If HttpContext.Current.Request.QueryString("WorkYear").IsNotEmpty Then
                formData.WorkYear = HttpContext.Current.Request.QueryString("WorkYear")
            End If
            If HttpContext.Current.Request.QueryString("AnoAnteriorDatos").IsNotEmpty Then
                formData.AnoAnteriorDatos = HttpContext.Current.Request.QueryString("AnoAnteriorDatos")
            End If
            If HttpContext.Current.Request.QueryString("AnoActualDatos").IsNotEmpty Then
                formData.AnoActualDatos = HttpContext.Current.Request.QueryString("AnoActualDatos")
            End If
            If HttpContext.Current.Request.QueryString("SiniestralidadAnterior").IsNotEmpty Then
                formData.SiniestralidadAnterior = HttpContext.Current.Request.QueryString("SiniestralidadAnterior")
            End If
            If HttpContext.Current.Request.QueryString("SiniestralidadActual").IsNotEmpty Then
                formData.SiniestralidadActual = HttpContext.Current.Request.QueryString("SiniestralidadActual")
            End If
            If HttpContext.Current.Request.QueryString("MontoSiniestros").IsNotEmpty Then
                formData.MontoSiniestros = HttpContext.Current.Request.QueryString("MontoSiniestros")
            End If
            If HttpContext.Current.Request.QueryString("PrimaTotal").IsNotEmpty Then
                formData.PrimaTotal = HttpContext.Current.Request.QueryString("PrimaTotal")
            End If
        End Sub	

        Private Shared Sub ValidateParametersInstance(ByRef formData As HT5EstadisticaPorProductoParameters)
            If IsNothing(formData.PROJECTVUL_DETCollection) Then
                formData.PROJECTVUL_DETCollection = New InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DETCollection
            End If
            If IsNothing(formData.PROJECTVULCollection) Then
                formData.PROJECTVULCollection = New InMotionGIT.Policy.Entity.Contracts.PROJECTVULCollection
            End If

        End Sub

#End Region

#Region "Form Contracts"

        <Serializable()>
        <DataContract()>
        Public Class EntryData

            <DataMember()> Public Property InstanceFormId As String
            <DataMember()> Public Property Ramo As Int32
            <DataMember()> Public Property Producto As Int32
            <DataMember()> Public Property AnoProceso As Int32
            <DataMember()> Public Property AnoAnterior As Int32
            <DataMember()> Public Property AnoActual As Int32
            <DataMember()> Public Property PROJECTVUL_DETCollection As List(Of PROJECTVUL_DETCollectionItem)
            <DataMember()> Public Property PROJECTVULCollection As List(Of PROJECTVULCollectionItem)
            <DataMember()> Public Property PROJECTVUL_DETCollectionYearOfThePolicy As System.Int32
            <DataMember()> Public Property PROJECTVUL_DETCollectionPremium As System.Decimal
            <DataMember()> Public Property PROJECTVUL_DETCollectionAccumulatdAmount As System.Decimal
            <DataMember()> Public Property PROJECTVUL_DET_PROJECTVUL_DET As List(Of PROJECTVUL_DET_PROJECTVUL_DETItem)
            <DataMember()> Public Property PROJECTVULCollectionYearOfThePolicy As System.Int32
            <DataMember()> Public Property PROJECTVULCollectionSurrenderAvailableAmount As System.Decimal
            <DataMember()> Public Property PROJECTVULCollectionExcessAmount As System.Decimal
            <DataMember()> Public Property PROJECTVUL_PROJECTVUL As List(Of PROJECTVUL_PROJECTVULItem)
            <DataMember()> Public Property SiniestralidadAnterior As Decimal
            <DataMember()> Public Property SiniestralidadActual As Decimal

        End Class

        <Serializable()>
        <DataContract()>
        Public Class PROJECTVUL_DETCollectionItem

            <DataMember()> Public Property YearOfThePolicy As System.Int32
            <DataMember()> Public Property Premium As System.Decimal
            <DataMember()> Public Property AccumulatdAmount As System.Decimal

        End Class

        <Serializable()>
        <DataContract()>
        Public Class PROJECTVULCollectionItem

            <DataMember()> Public Property YearOfThePolicy As System.Int32
            <DataMember()> Public Property SurrenderAvailableAmount As System.Decimal
            <DataMember()> Public Property ExcessAmount As System.Decimal

        End Class

        <Serializable()>
        <DataContract()>
        Public Class PROJECTVUL_DET_PROJECTVUL_DETItem

            <DataMember()> Public Property YearOfThePolicy As System.Int32
            <DataMember()> Public Property Premium As System.Decimal
            <DataMember()> Public Property AccumulatdAmount As System.Decimal

        End Class

        <Serializable()>
        <DataContract()>
        Public Class PROJECTVUL_PROJECTVULItem

            <DataMember()> Public Property YearOfThePolicy As System.Int32
            <DataMember()> Public Property SurrenderAvailableAmount As System.Decimal
            <DataMember()> Public Property ExcessAmount As System.Decimal

        End Class

        <Serializable()>
        Public Class HT5EstadisticaPorProductoParameters
            Inherits InMotionGIT.FrontOffice.Support.DataType.FormBase(Of HT5EstadisticaPorProductoParameters)

            Public Property PROJECTVULCollection As InMotionGIT.Policy.Entity.Contracts.PROJECTVULCollection
            Public Property Ramo As Int32
            Public Property Producto As Int32
            Public Property AnoProceso As Int32
            Public Property PROJECTVUL As InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
            Public Property AnoAnterior As Int32
            Public Property AnoActual As Int32
            Public Property PROJECTVUL_DETCollection As InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DETCollection
            Public Property PROJECTVUL_DET As InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
            Public Property FechaDesde As DateTime
            Public Property FechaHasta As DateTime
            Public Property WorkYear As Int32
            Public Property PROJECTVULtmp As InMotionGIT.Policy.Entity.Contracts.PROJECTVUL
            Public Property PROJECTVUL_DETtmp As InMotionGIT.Policy.Entity.Contracts.PROJECTVUL_DET
            Public Property AnoAnteriorDatos As Int32
            Public Property AnoActualDatos As Int32
            Public Property SiniestralidadAnterior As Decimal
            Public Property SiniestralidadActual As Decimal
            Public Property MontoSiniestros As Decimal
            Public Property PrimaTotal As Decimal

        End Class
#End Region

    End Class

End Namespace