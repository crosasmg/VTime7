'---------------------------------------------------------------------------------------------------
' <generated>
'     This code was generated by Form Designer v7.3.34.1 at 2020-01-16 06:58:08 p. m. model release 2, Form Generator v1.0.37.30
'     
'     Changes to this file may cause incorrect behavior and will be lost if the code is regenerated.
' </generated>
'---------------------------------------------------------------------------------------------------
      
#Region "using"

Imports System.Data
Imports System.Globalization
Imports System.Runtime.Serialization
Imports System.Web.Script.Services
Imports System.Web.Services
Imports InMotionGIT.Common.Helpers
Imports InMotionGIT.Common.Proxy
Imports InMotionGIT.FrontOffice.Support

#End Region

Namespace dli.forms

    Public Class HT5FinancialQuestionnaireUWActions
        Inherits System.Web.UI.Page

#Region "Actions Methods"

       <WebMethod(EnableSession:=True)>
        Public Shared Function Initialization(id As String, urlid As String, fromid As String) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim instance As New EntryData With {.InstanceFormId = id}
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim currentAction As String = String.Empty
            
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing

            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                
                If id.IsEmpty AndAlso urlid.IsEmpty Then
                    instance.InstanceFormId = System.Guid.NewGuid().ToString
                    
                    With instance

                    End With                
                    
                    HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                    SetDefaultValuesFromQueryString(HT5FinancialQuestionnaireUWParametersInstance)
                    
                    If fromid.IsNotEmpty Then
                        GetTransferParameters(HT5FinancialQuestionnaireUWParametersInstance, fromid)
                        ValidateParametersInstance(HT5FinancialQuestionnaireUWParametersInstance)
                    End If
                Else       
                    instance.InstanceFormId = id.IfEmpty(urlid)
                    HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
    
                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance) then
                        HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)                        
                    End If
                    
                    SetDefaultValuesFromQueryString(HT5FinancialQuestionnaireUWParametersInstance)
                End If

                HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath"))) = String.Empty

                If id.IsEmpty AndAlso urlid.IsEmpty Then
                    Form_Initialization(currentAction, HT5FinancialQuestionnaireUWParametersInstance, resultData)
                Else
                    Form_Load(currentAction, HT5FinancialQuestionnaireUWParametersInstance, resultData)
                End If


                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance) 
		        
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                                
                With resultData
                    .Success = True
                    .Data = New With {.Instance = instance, .LookUps = Nothing}
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "Initialization", currentAction)
            End Try
            
            Return resultData
        End Function
  

        <WebMethod(EnableSession:=True)>
        Public Shared Function OtherIncomeYear1Change(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("OtherIncomeYear1Click")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear1 = 0 AND HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear2 = 0 AND ... Then")
                If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear1 = 0 AndAlso HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear2 = 0 AndAlso HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear3 = 0 Then

                    currentAction = SessionTrace("2. Disable 'Descripción' control")
                    resultData.AddControlBehavior("DescriptionOtherIncome", "disabled")

                    currentAction = SessionTrace("3. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherIncome = ' '...")
                    currentAction = SessionTrace("3.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherIncome = ' '...")
                                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

                    HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherIncome = " "

                    Else
                    currentAction = SessionTrace("4. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear1 <> 0 Then")
                    If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear1 <> 0 Then

                        currentAction = SessionTrace("5. Enable 'Descripción' control")
                        resultData.AddControlBehavior("DescriptionOtherIncome", "enabled")

                                End If
                            End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "OtherIncomeYear1Change", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function OtherIncomeYear2Change(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("OtherIncomeYear2Click")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear1 = 0 AND HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear2 = 0 AND ... Then")
                If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear1 = 0 AndAlso HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear2 = 0 AndAlso HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear3 = 0 Then

                    currentAction = SessionTrace("2. Disable 'Descripción' control")
                    resultData.AddControlBehavior("DescriptionOtherIncome", "disabled")

                    currentAction = SessionTrace("3. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherIncome = ' '...")
                    currentAction = SessionTrace("3.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherIncome = ' '...")
                                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

                    HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherIncome = " "

                    Else
                    currentAction = SessionTrace("4. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear2 <> 0 Then")
                    If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear2 <> 0 Then

                        currentAction = SessionTrace("5. Enable 'Descripción' control")
                        resultData.AddControlBehavior("DescriptionOtherIncome", "enabled")

                                End If
                            End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "OtherIncomeYear2Change", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function OtherIncomeYear3Change(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("OtherIncomeYear3Click")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear1 = 0 AND HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear2 = 0 AND ... Then")
                If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear1 = 0 AndAlso HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear2 = 0 AndAlso HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear3 = 0 Then

                    currentAction = SessionTrace("2. Disable 'Descripción' control")
                    resultData.AddControlBehavior("DescriptionOtherIncome", "disabled")

                    currentAction = SessionTrace("3. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherIncome = ' '...")
                    currentAction = SessionTrace("3.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherIncome = ' '...")
                                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

                    HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherIncome = " "

                    Else
                    currentAction = SessionTrace("4. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear3 <> 0 Then")
                    If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherIncomeYear3 <> 0 Then

                        currentAction = SessionTrace("5. Enable 'Descripción' control")
                        resultData.AddControlBehavior("DescriptionOtherIncome", "enabled")

                                End If
                            End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "OtherIncomeYear3Change", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function OtherEarnedIncomeYear1Change(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("OtherEarnedIncomeYear1Click")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear1 = 0 AND HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear2 = 0 AND ... Then")
                If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear1 = 0 AndAlso HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear2 = 0 AndAlso HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear3 = 0 Then

                    currentAction = SessionTrace("2. Disable 'Descripción' control")
                    resultData.AddControlBehavior("DescriptionOtherEarnedIncome", "disabled")

                    currentAction = SessionTrace("3. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherEarnedIncome = ' '...")
                    currentAction = SessionTrace("3.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherEarnedIncome = ' '...")
                                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

                    HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherEarnedIncome = " "

                    Else
                    currentAction = SessionTrace("4. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear1 <> 0 Then")
                    If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear1 <> 0 Then

                        currentAction = SessionTrace("5. Enable 'Descripción' control")
                        resultData.AddControlBehavior("DescriptionOtherEarnedIncome", "enabled")

                                End If
                            End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "OtherEarnedIncomeYear1Change", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function OtherEarnedIncomeYear2Change(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("OtherEarnedIncomeYear2Click")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear1 = 0 AND HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear2 = 0 AND ... Then")
                If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear1 = 0 AndAlso HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear2 = 0 AndAlso HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear3 = 0 Then

                    currentAction = SessionTrace("2. Disable 'Descripción' control")
                    resultData.AddControlBehavior("DescriptionOtherEarnedIncome", "disabled")

                    currentAction = SessionTrace("3. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherEarnedIncome = ' '...")
                    currentAction = SessionTrace("3.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherEarnedIncome = ' '...")
                                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

                    HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherEarnedIncome = " "

                    Else
                    currentAction = SessionTrace("4. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear2 <> 0 Then")
                    If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear2 <> 0 Then

                        currentAction = SessionTrace("5. Enable 'Descripción' control")
                        resultData.AddControlBehavior("DescriptionOtherEarnedIncome", "enabled")

                                End If
                            End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "OtherEarnedIncomeYear2Change", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function OtherEarnedIncomeYear3Change(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("OtherEarnedIncomeYear3Click")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear1 = 0 AND HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear2 = 0 AND ... Then")
                If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear1 = 0 AndAlso HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear2 = 0 AndAlso HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear3 = 0 Then

                    currentAction = SessionTrace("2. Disable 'Descripción' control")
                    resultData.AddControlBehavior("DescriptionOtherEarnedIncome", "disabled")

                    currentAction = SessionTrace("3. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherEarnedIncome = ' '...")
                    currentAction = SessionTrace("3.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherEarnedIncome = ' '...")
                                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

                    HT5FinancialQuestionnaireUWParametersInstance.Financial.DescriptionOtherEarnedIncome = " "

                    Else
                    currentAction = SessionTrace("4. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear3 <> 0 Then")
                    If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherEarnedIncomeYear3 <> 0 Then

                        currentAction = SessionTrace("5. Enable 'Descripción' control")
                        resultData.AddControlBehavior("DescriptionOtherEarnedIncome", "enabled")

                                End If
                            End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "OtherEarnedIncomeYear3Change", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function OtherAssets1Change(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("OtherAssets1Click")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherAssets1 <> 0 Then")
                If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherAssets1 <> 0 Then

                    currentAction = SessionTrace("2. Enable 'Descriptions' control")
                    resultData.AddControlBehavior("DescribeOtherAssets1", "enabled")

                    Else
                    currentAction = SessionTrace("3. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherAssets1 = ' '...")
                    currentAction = SessionTrace("3.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherAssets1 = ' '...")
                                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

                    HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherAssets1 = " "

                    currentAction = SessionTrace("4. Disable 'Descriptions' control")
                    resultData.AddControlBehavior("DescribeOtherAssets1", "disabled")

                        End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "OtherAssets1Change", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function OtherAssets2Change(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("OtherAssets2Click")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherAssets2 <> 0 Then")
                If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherAssets2 <> 0 Then

                    currentAction = SessionTrace("2. Enable 'Descriptions' control")
                    resultData.AddControlBehavior("DescribeOtherAssets2", "enabled")

                    Else
                    currentAction = SessionTrace("3. Disable 'Descriptions' control")
                    resultData.AddControlBehavior("DescribeOtherAssets2", "disabled")

                    currentAction = SessionTrace("4. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherAssets2 = ' '...")
                    currentAction = SessionTrace("4.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherAssets2 = ' '...")
                                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

                    HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherAssets2 = " "

                        End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "OtherAssets2Change", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function OtherAssets3Change(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("OtherAssets3Click")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherAssets3 <> 0 Then")
                If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherAssets3 <> 0 Then

                    currentAction = SessionTrace("2. Enable 'Descriptions' control")
                    resultData.AddControlBehavior("DescribeOtherAssets3", "enabled")

                    Else
                    currentAction = SessionTrace("3. Disable 'Descriptions' control")
                    resultData.AddControlBehavior("DescribeOtherAssets3", "disabled")

                    currentAction = SessionTrace("4. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherAssets3 = ' '...")
                    currentAction = SessionTrace("4.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherAssets3 = ' '...")
                                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

                    HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherAssets3 = " "

                        End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "OtherAssets3Change", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function OtherAssets4Change(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("OtherAssets4Click")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherAssets4 <> 0 Then")
                If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherAssets4 <> 0 Then

                    currentAction = SessionTrace("2. Enable 'Descriptions' control")
                    resultData.AddControlBehavior("DescribeOtherAssets4", "enabled")

                    Else
                    currentAction = SessionTrace("3. Disable 'Descriptions' control")
                    resultData.AddControlBehavior("DescribeOtherAssets4", "disabled")

                    currentAction = SessionTrace("4. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherAssets4 = ' '...")
                    currentAction = SessionTrace("4.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherAssets4 = ' '...")
                                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

                    HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherAssets4 = " "

                        End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "OtherAssets4Change", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function OtherLiabilities1Change(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("OtherLiabilities1Click")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherLiabilities1 <> 0 Then")
                If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherLiabilities1 <> 0 Then

                    currentAction = SessionTrace("2. Enable 'Description' control")
                    resultData.AddControlBehavior("DescribeOtherLiabilities1", "enabled")

                    Else
                    currentAction = SessionTrace("3. Disable 'Description' control")
                    resultData.AddControlBehavior("DescribeOtherLiabilities1", "disabled")

                    currentAction = SessionTrace("4. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherLiabilities1 = ' '...")
                    currentAction = SessionTrace("4.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherLiabilities1 = ' '...")
                                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

                    HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherLiabilities1 = " "

                        End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "OtherLiabilities1Change", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function OtherLiabilities2Change(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("OtherLiabilities2Click")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherLiabilities2 <> 0 Then")
                If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherLiabilities2 <> 0 Then

                    currentAction = SessionTrace("2. Enable 'Description' control")
                    resultData.AddControlBehavior("DescribeOtherLiabilities2", "enabled")

                    Else
                    currentAction = SessionTrace("3. Disable 'Description' control")
                    resultData.AddControlBehavior("DescribeOtherLiabilities2", "disabled")

                    currentAction = SessionTrace("4. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherLiabilities2 = ' '...")
                    currentAction = SessionTrace("4.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherLiabilities2 = ' '...")
                                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

                    HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherLiabilities2 = " "

                        End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "OtherLiabilities2Change", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function OtherLiabilities3Change(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("OtherLiabilities3Click")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherLiabilities3 <> 0 Then")
                If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherLiabilities3 <> 0 Then

                    currentAction = SessionTrace("2. Enable 'Description' control")
                    resultData.AddControlBehavior("DescribeOtherLiabilities3", "enabled")

                    Else
                    currentAction = SessionTrace("3. Disable 'Description' control")
                    resultData.AddControlBehavior("DescribeOtherLiabilities3", "disabled")

                    currentAction = SessionTrace("4. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherLiabilities3 = ' '...")
                    currentAction = SessionTrace("4.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherLiabilities3 = ' '...")
                                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

                    HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherLiabilities3 = " "

                        End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "OtherLiabilities3Change", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function OtherLiabilities4Change(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("OtherLiabilities4Click")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherLiabilities4 <> 0 Then")
                If HT5FinancialQuestionnaireUWParametersInstance.Financial.OtherLiabilities4 <> 0 Then

                    currentAction = SessionTrace("2. Enable 'Description' control")
                    resultData.AddControlBehavior("DescribeOtherLiabilities4", "enabled")

                    Else
                    currentAction = SessionTrace("3. Disable 'Description' control")
                    resultData.AddControlBehavior("DescribeOtherLiabilities4", "disabled")

                    currentAction = SessionTrace("4. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherLiabilities4 = ' '...")
                    currentAction = SessionTrace("4.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherLiabilities4 = ' '...")
                                    If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

                    HT5FinancialQuestionnaireUWParametersInstance.Financial.DescribeOtherLiabilities4 = " "

                        End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "OtherLiabilities4Change", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function saveClick(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("saveClick")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. The message 'El cuestionario será...' will displayed as 'Splash'")
                ParametersToDictionary(HT5FinancialQuestionnaireUWParametersInstance, parametersDictionary)
                messageAction = "El cuestionario será almacenado temporalmente. Recuerde que debe ser llenado para que su solicitud sea procesada. Muchas gracias."
                messageAction = InMotionGIT.FrontOffice.Proxy.Helpers.Email.Process(messageAction, parametersDictionary)
                resultData.AddNotifySplash(messageAction)

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "saveClick", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function submitClick(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                HT5FinancialQuestionnaireUWParametersInstance = RetrieveFormInformationFromDatabase(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("submitClick")
                HT5FinancialQuestionnaireUWParametersInstance = EntryDataToClass(HT5FinancialQuestionnaireUWParametersInstance, instance)
                currentAction = SessionTrace("1. Call 'Calculate Total Amounts In Financial Questionnaire' workflow in Synchronous mode with tracking")
                WorkflowInArguments = New Dictionary(Of String, Object)

                With WorkflowInArguments
                .Add("Financial", HT5FinancialQuestionnaireUWParametersInstance.Financial)
                .Add("AllOK", HT5FinancialQuestionnaireUWParametersInstance.AllOK)
                .Add("context", formContext)
                .Add("uwreqid", HT5FinancialQuestionnaireUWParametersInstance.uwreqid)
                .Add("uwcaseid", HT5FinancialQuestionnaireUWParametersInstance.uwcaseid)
                End With

                WorkflowOutArguments = InMotionGIT.Workflow.Support.Runtime.DoWorkFromForm("CalculateFinancialTotalAmountsUW", "0E6B6AFA-2DC6-4797-BD8B-CCA5B2547D15", 4, WorkflowInArguments, True, True, HttpContext.Current.Request.UrlReferrer.AbsolutePath, HT5FinancialQuestionnaireUWParametersInstance.InternalId)

                currentAction += "'Mapping Outputs'"
                HT5FinancialQuestionnaireUWParametersInstance.Financial = WorkflowOutArguments("Financial")
                HT5FinancialQuestionnaireUWParametersInstance.AllOK = WorkflowOutArguments("AllOK")

                currentAction = SessionTrace("2. If HT5FinancialQuestionnaireUWParametersInstance.AllOK = False Then")
                If HT5FinancialQuestionnaireUWParametersInstance.AllOK = False Then

                    currentAction = SessionTrace("3. The message 'Indique los ingresos...' will displayed as 'Popup'")
                    ParametersToDictionary(HT5FinancialQuestionnaireUWParametersInstance, parametersDictionary)
                    messageAction = "Indique los ingresos y patrimonio neto"
                    messageAction = InMotionGIT.FrontOffice.Proxy.Helpers.Email.Process(messageAction, parametersDictionary)
                    resultData.AddNotifyPopup(messageAction)
                    End If
                currentAction = SessionTrace("4. If HT5FinancialQuestionnaireUWParametersInstance.AllOK = true Then")
                If HT5FinancialQuestionnaireUWParametersInstance.AllOK = true Then

                    currentAction = SessionTrace("5. HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64 = convert.ToInt64(HT5FinancialQuestionnaireUWParametersInstance.uwcaseid)...")
                    currentAction = SessionTrace("5.1. HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64 = convert.ToInt64(HT5FinancialQuestionnaireUWParametersInstance.uwcaseid)...")

                    HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64 = convert.ToInt64(HT5FinancialQuestionnaireUWParametersInstance.uwcaseid)

                    currentAction = SessionTrace("6. Call 'Retrieve Case Information' workflow in Synchronous mode with tracking")
                    WorkflowInArguments = New Dictionary(Of String, Object)

                    With WorkflowInArguments
                    .Add("uwcaseid", HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64)
                    .Add("uwreqid", HT5FinancialQuestionnaireUWParametersInstance.uwreqid)
                    .Add("ClientName", HT5FinancialQuestionnaireUWParametersInstance.ClientName)
                    .Add("StatusCase", HT5FinancialQuestionnaireUWParametersInstance.StatusCase)
                    .Add("StatusRequirement", HT5FinancialQuestionnaireUWParametersInstance.StatusRequirement)
                    .Add("RiskInformation", HT5FinancialQuestionnaireUWParametersInstance.RiskInformation)
                    .Add("Identifier", "FinantialFinal")
                    .Add("context", formContext)
                    .Add("caseLocked", HT5FinancialQuestionnaireUWParametersInstance.caseLocked)
                    End With

                    WorkflowOutArguments = InMotionGIT.Workflow.Support.Runtime.DoWorkFromForm("RetrieveCaseInformation", "1632D520-852F-46AD-8F03-D0A778676380", 10, WorkflowInArguments, True, True, HttpContext.Current.Request.UrlReferrer.AbsolutePath, HT5FinancialQuestionnaireUWParametersInstance.InternalId)

                    currentAction += "'Mapping Outputs'"
                    HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64 = WorkflowOutArguments("uwcaseid")
                    HT5FinancialQuestionnaireUWParametersInstance.uwreqid = WorkflowOutArguments("uwreqid")
                    HT5FinancialQuestionnaireUWParametersInstance.ClientName = WorkflowOutArguments("ClientName")
                    HT5FinancialQuestionnaireUWParametersInstance.StatusCase = WorkflowOutArguments("StatusCase")
                    HT5FinancialQuestionnaireUWParametersInstance.StatusRequirement = WorkflowOutArguments("StatusRequirement")
                    HT5FinancialQuestionnaireUWParametersInstance.RiskInformation = WorkflowOutArguments("RiskInformation")

                    currentAction = SessionTrace("7. If HT5FinancialQuestionnaireUWParametersInstance.StatusRequirement <> 1 Then")
                    If HT5FinancialQuestionnaireUWParametersInstance.StatusRequirement <> 1 Then

                        currentAction = SessionTrace("8. The message 'El estado del cuesti...' will displayed as 'Splash'")
                        ParametersToDictionary(HT5FinancialQuestionnaireUWParametersInstance, parametersDictionary)
                        messageAction = "El estado del cuestionario no permite ser llenado. Verifique la información que ha recibido por parte de la empresa de seguros."
                        messageAction = InMotionGIT.FrontOffice.Proxy.Helpers.Email.Process(messageAction, parametersDictionary)
                        resultData.AddNotifySplash(messageAction)
                                Else
                        currentAction = SessionTrace("9. Call Shared Function 'User Profile' without parameters")
                        Dim _ClientUser_b1bfe0e9a96a4825812c9793e6cdbfd8 As InMotionGIT.Client.Entity.Contracts.Client
                        

      If Not IsNothing(UserInfo) AndAlso Not IsNothing(UserInfo.User) then
         _ClientUser_b1bfe0e9a96a4825812c9793e6cdbfd8 = New InMotionGIT.Client.Entity.Contracts.Client

         With _ClientUser_b1bfe0e9a96a4825812c9793e6cdbfd8
             .ClientID = UserInfo.User.ClientID
             .FirstName = UserInfo.User.FirstName
             .LastName = UserInfo.User.LastName
             .LastName2 = UserInfo.User.SecondLastName
             .BirthDate = UserInfo.User.DateOfBirth
             .LegalName = UserInfo.User.CompanyName
             .GenderEnum = IIf(UserInfo.User.Gender = "Male", InMotionGIT.Common.Contracts.Enumerations.EnumGender.Male, InMotionGIT.Common.Contracts.Enumerations.EnumGender.Female)
             .eMailAddressDefault = UserInfo.User.Email
             .CompleteClientName = .CompleteClientNameValid
         End With

	isNullResult = (IsNothing(_ClientUser_b1bfe0e9a96a4825812c9793e6cdbfd8))
	isFoundData  = Not isNullResult
      End If
    
                        HT5FinancialQuestionnaireUWParametersInstance.ClientUser = _ClientUser_b1bfe0e9a96a4825812c9793e6cdbfd8

                        currentAction = SessionTrace("10. HT5FinancialQuestionnaireUWParametersInstance.UsercodeFASI = UserInfo.UserId...")
                        currentAction = SessionTrace("10.1. HT5FinancialQuestionnaireUWParametersInstance.UsercodeFASI = UserInfo.UserId...")

                        HT5FinancialQuestionnaireUWParametersInstance.UsercodeFASI = UserInfo.UserId
                        currentAction = SessionTrace("10.2. HT5FinancialQuestionnaireUWParametersInstance.IsAnonymous = UserInfo.IsAnonymous()...")

                        HT5FinancialQuestionnaireUWParametersInstance.IsAnonymous = UserInfo.IsAnonymous()

                        currentAction = SessionTrace("11. If HT5FinancialQuestionnaireUWParametersInstance.IsAnonymous = true Then")
                        If HT5FinancialQuestionnaireUWParametersInstance.IsAnonymous = true Then

                            currentAction = SessionTrace("12. HT5FinancialQuestionnaireUWParametersInstance.UsercodeFASI = 9998...")
                            currentAction = SessionTrace("12.1. HT5FinancialQuestionnaireUWParametersInstance.UsercodeFASI = 9998...")

                            HT5FinancialQuestionnaireUWParametersInstance.UsercodeFASI = 9998

                                            End If
                        currentAction = SessionTrace("13. If HT5FinancialQuestionnaireUWParametersInstance.caseLocked = true Then")
                        If HT5FinancialQuestionnaireUWParametersInstance.caseLocked = true Then

                            currentAction = SessionTrace("14. Call 'Main Process Questionnaire Financial' workflow in Synchronous mode with tracking")
                            WorkflowInArguments = New Dictionary(Of String, Object)

                            With WorkflowInArguments
                            .Add("uwcaseid", HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64)
                            .Add("uwreqid", HT5FinancialQuestionnaireUWParametersInstance.uwreqid)
                            .Add("FinancialQuestionnaire", HT5FinancialQuestionnaireUWParametersInstance.Financial)
                            .Add("context", formContext)
                            .Add("ConnectedUserCode", HT5FinancialQuestionnaireUWParametersInstance.UsercodeFASI)
                            .Add("caseLocked", HT5FinancialQuestionnaireUWParametersInstance.caseLocked)
                            End With

                            WorkflowOutArguments = InMotionGIT.Workflow.Support.Runtime.DoWorkFromForm("QuestionnaireRulesFinancialUW", "4CEE3659-87F7-4DA4-9D2C-32AE21D658BA", 11, WorkflowInArguments, True, True, HttpContext.Current.Request.UrlReferrer.AbsolutePath, HT5FinancialQuestionnaireUWParametersInstance.InternalId)

                            currentAction += "'Mapping Outputs'"
                            HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64 = WorkflowOutArguments("uwcaseid")
                            HT5FinancialQuestionnaireUWParametersInstance.uwreqid = WorkflowOutArguments("uwreqid")
                            HT5FinancialQuestionnaireUWParametersInstance.Financial = WorkflowOutArguments("FinancialQuestionnaire")

                            currentAction = SessionTrace("15. Url: '#setting.Url.WebApplication#/Underwriting/UnderwritingPanel.aspx'")
                                
                With resultData
                    .AddRedirect(String.Format(CultureInfo.InvariantCulture, ConfigurationManager.AppSettings("Url.WebApplication") +"/Underwriting/UnderwritingPanel.aspx"+"?closeWindow={0}","1"))
                End With
                                                Else
                            currentAction = SessionTrace("16. The message 'El cuestionario será...' will displayed as 'Splash'")
                            ParametersToDictionary(HT5FinancialQuestionnaireUWParametersInstance, parametersDictionary)
                            messageAction = "El cuestionario será procesado. La empresa le notificará lo más pronto posible el resultado del mismo. Muchas gracias."
                            messageAction = InMotionGIT.FrontOffice.Proxy.Helpers.Email.Process(messageAction, parametersDictionary)
                            resultData.AddNotifySplash(messageAction)
                            currentAction = SessionTrace("17. Call 'Main Process Questionnaire Financial' workflow in Asynchronous mode with tracking")
                            WorkflowInArguments = New Dictionary(Of String, Object)

                            With WorkflowInArguments
                            .Add("uwcaseid", HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64)
                            .Add("uwreqid", HT5FinancialQuestionnaireUWParametersInstance.uwreqid)
                            .Add("FinancialQuestionnaire", HT5FinancialQuestionnaireUWParametersInstance.Financial)
                            .Add("context", formContext)
                            .Add("ConnectedUserCode", HT5FinancialQuestionnaireUWParametersInstance.UsercodeFASI)
                            .Add("caseLocked", HT5FinancialQuestionnaireUWParametersInstance.caseLocked)
                            End With

                            WorkflowOutArguments = InMotionGIT.Workflow.Support.Runtime.DoWorkFromForm("QuestionnaireRulesFinancialUW", "4CEE3659-87F7-4DA4-9D2C-32AE21D658BA", 9, WorkflowInArguments, True, False, HttpContext.Current.Request.UrlReferrer.AbsolutePath, HT5FinancialQuestionnaireUWParametersInstance.InternalId)


                                                    End If
                                                End If
                                            End If

                instance = ClassToEntryData(instance, HT5FinancialQuestionnaireUWParametersInstance)
                
                StoreFormInformation(HT5FinancialQuestionnaireUWParametersInstance)
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "HT5FinancialQuestionnaireUW", "submitClick", currentAction)
            End Try
            
            Return resultData
        End Function

#End Region

#Region "Lookups Web Methods"


#End Region

#Region "Form Actions"

        Private Shared Sub Form_Initialization(ByRef currentAction As String, ByRef HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters, ByRef resultData As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult)
            Dim UserInfo As New InMotionGIT.Membership.Providers.MemberContext
            
            Dim formContext As New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                        HT5FinancialQuestionnaireUWParametersInstance.InternalId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                                     .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                                     .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                                     .AccessToken = HttpContext.Current.Session("AccessToken")}
            Dim selectDataTableItem As DataTable = Nothing
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim messageAction As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False

            currentAction = SessionTrace("Form_Initialization")

            currentAction = SessionTrace("1. HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64 = convert.ToInt64(HT5FinancialQuestionnaireUWParametersInstance.uwcaseid)...")
            currentAction = SessionTrace("1.1. HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64 = convert.ToInt64(HT5FinancialQuestionnaireUWParametersInstance.uwcaseid)...")

            HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64 = convert.ToInt64(HT5FinancialQuestionnaireUWParametersInstance.uwcaseid)

            currentAction = SessionTrace("2. Call 'Retrieve Case Information' workflow in Synchronous mode with tracking")
            WorkflowInArguments = New Dictionary(Of String, Object)

            With WorkflowInArguments
            .Add("uwcaseid", HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64)
            .Add("uwreqid", HT5FinancialQuestionnaireUWParametersInstance.uwreqid)
            .Add("ClientName", HT5FinancialQuestionnaireUWParametersInstance.ClientName)
            .Add("StatusCase", HT5FinancialQuestionnaireUWParametersInstance.StatusCase)
            .Add("StatusRequirement", HT5FinancialQuestionnaireUWParametersInstance.StatusRequirement)
            .Add("RiskInformation", HT5FinancialQuestionnaireUWParametersInstance.RiskInformation)
            .Add("Identifier", "FinantialInitialization")
            .Add("context", formContext)
            .Add("caseLocked", HT5FinancialQuestionnaireUWParametersInstance.caseLocked)
            End With

            WorkflowOutArguments = InMotionGIT.Workflow.Support.Runtime.DoWorkFromForm("RetrieveCaseInformation", "1632D520-852F-46AD-8F03-D0A778676380", 10, WorkflowInArguments, True, True, HttpContext.Current.Request.UrlReferrer.AbsolutePath, HT5FinancialQuestionnaireUWParametersInstance.InternalId)

            currentAction += "'Mapping Outputs'"
            HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64 = WorkflowOutArguments("uwcaseid")
            HT5FinancialQuestionnaireUWParametersInstance.uwreqid = WorkflowOutArguments("uwreqid")
            HT5FinancialQuestionnaireUWParametersInstance.ClientName = WorkflowOutArguments("ClientName")
            HT5FinancialQuestionnaireUWParametersInstance.StatusCase = WorkflowOutArguments("StatusCase")
            HT5FinancialQuestionnaireUWParametersInstance.StatusRequirement = WorkflowOutArguments("StatusRequirement")
            HT5FinancialQuestionnaireUWParametersInstance.RiskInformation = WorkflowOutArguments("RiskInformation")

            currentAction = SessionTrace("3. HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3 = year(Date.Today)...")
            currentAction = SessionTrace("3.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3 = year(Date.Today)...")
                            If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

            HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3 = year(Date.Today)
            currentAction = SessionTrace("3.2. HT5FinancialQuestionnaireUWParametersInstance.Financial.Year2 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3 - 1...")
                            If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

            HT5FinancialQuestionnaireUWParametersInstance.Financial.Year2 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3 - 1
            currentAction = SessionTrace("3.3. HT5FinancialQuestionnaireUWParametersInstance.Financial.Year1 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year2 - 1...")
                            If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

            HT5FinancialQuestionnaireUWParametersInstance.Financial.Year1 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year2 - 1
            currentAction = SessionTrace("3.4. HT5FinancialQuestionnaireUWParametersInstance.Year1 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year1...")

            HT5FinancialQuestionnaireUWParametersInstance.Year1 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year1
            currentAction = SessionTrace("3.5. HT5FinancialQuestionnaireUWParametersInstance.Year2 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year2...")

            HT5FinancialQuestionnaireUWParametersInstance.Year2 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year2
            currentAction = SessionTrace("3.6. HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3...")
                            If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

            HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3

            currentAction = SessionTrace("4. HT5FinancialQuestionnaireUWParametersInstance.Financial.DateReceived = Date.Today...")
            currentAction = SessionTrace("4.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DateReceived = Date.Today...")
                            If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

            HT5FinancialQuestionnaireUWParametersInstance.Financial.DateReceived = Date.Today

            currentAction = SessionTrace("7. HT5FinancialQuestionnaireUWParametersInstance.AllOK = False...")
            currentAction = SessionTrace("7.1. HT5FinancialQuestionnaireUWParametersInstance.AllOK = False...")

            HT5FinancialQuestionnaireUWParametersInstance.AllOK = False


            
        End Sub
	
        Private Shared Sub Form_Load(ByRef currentAction As String, ByRef HT5FinancialQuestionnaireUWParametersInstance As HT5FinancialQuestionnaireUWParameters, ByRef resultData As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult)
            Dim UserInfo As New InMotionGIT.Membership.Providers.MemberContext
            Dim formContext As New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                        HT5FinancialQuestionnaireUWParametersInstance.InternalId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                                     .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                                     .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                                     .AccessToken = HttpContext.Current.Session("AccessToken")}
            Dim selectDataTableItem As DataTable = Nothing
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim messageAction As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False

            currentAction = SessionTrace("Form_Load")

            currentAction = SessionTrace("1. HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64 = convert.ToInt64(HT5FinancialQuestionnaireUWParametersInstance.uwcaseid)...")
            currentAction = SessionTrace("1.1. HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64 = convert.ToInt64(HT5FinancialQuestionnaireUWParametersInstance.uwcaseid)...")

            HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64 = convert.ToInt64(HT5FinancialQuestionnaireUWParametersInstance.uwcaseid)

            currentAction = SessionTrace("2. Call 'Retrieve Case Information' workflow in Synchronous mode with tracking")
            WorkflowInArguments = New Dictionary(Of String, Object)

            With WorkflowInArguments
            .Add("uwcaseid", HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64)
            .Add("uwreqid", HT5FinancialQuestionnaireUWParametersInstance.uwreqid)
            .Add("ClientName", HT5FinancialQuestionnaireUWParametersInstance.ClientName)
            .Add("StatusCase", HT5FinancialQuestionnaireUWParametersInstance.StatusCase)
            .Add("StatusRequirement", HT5FinancialQuestionnaireUWParametersInstance.StatusRequirement)
            .Add("RiskInformation", HT5FinancialQuestionnaireUWParametersInstance.RiskInformation)
            .Add("Identifier", "FinancialActions")
            .Add("context", formContext)
            .Add("caseLocked", HT5FinancialQuestionnaireUWParametersInstance.caseLocked)
            End With

            WorkflowOutArguments = InMotionGIT.Workflow.Support.Runtime.DoWorkFromForm("RetrieveCaseInformation", "1632D520-852F-46AD-8F03-D0A778676380", 10, WorkflowInArguments, True, True, HttpContext.Current.Request.UrlReferrer.AbsolutePath, HT5FinancialQuestionnaireUWParametersInstance.InternalId)

            currentAction += "'Mapping Outputs'"
            HT5FinancialQuestionnaireUWParametersInstance.uwCaseIdInt64 = WorkflowOutArguments("uwcaseid")
            HT5FinancialQuestionnaireUWParametersInstance.uwreqid = WorkflowOutArguments("uwreqid")
            HT5FinancialQuestionnaireUWParametersInstance.ClientName = WorkflowOutArguments("ClientName")
            HT5FinancialQuestionnaireUWParametersInstance.StatusCase = WorkflowOutArguments("StatusCase")
            HT5FinancialQuestionnaireUWParametersInstance.StatusRequirement = WorkflowOutArguments("StatusRequirement")
            HT5FinancialQuestionnaireUWParametersInstance.RiskInformation = WorkflowOutArguments("RiskInformation")

            currentAction = SessionTrace("3. HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3 = year(Date.Today)...")
            currentAction = SessionTrace("3.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3 = year(Date.Today)...")
                            If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

            HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3 = year(Date.Today)
            currentAction = SessionTrace("3.2. HT5FinancialQuestionnaireUWParametersInstance.Financial.Year2 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3 - 1...")
                            If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

            HT5FinancialQuestionnaireUWParametersInstance.Financial.Year2 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3 - 1
            currentAction = SessionTrace("3.3. HT5FinancialQuestionnaireUWParametersInstance.Financial.Year1 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year2 - 1...")
                            If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

            HT5FinancialQuestionnaireUWParametersInstance.Financial.Year1 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year2 - 1
            currentAction = SessionTrace("3.4. HT5FinancialQuestionnaireUWParametersInstance.Year1 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year1...")

            HT5FinancialQuestionnaireUWParametersInstance.Year1 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year1
            currentAction = SessionTrace("3.5. HT5FinancialQuestionnaireUWParametersInstance.Year2 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year2...")

            HT5FinancialQuestionnaireUWParametersInstance.Year2 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year2
            currentAction = SessionTrace("3.6. HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3...")
                            If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

            HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3 = HT5FinancialQuestionnaireUWParametersInstance.Financial.Year3

            currentAction = SessionTrace("4. HT5FinancialQuestionnaireUWParametersInstance.Financial.DateReceived = Date.Today...")
            currentAction = SessionTrace("4.1. HT5FinancialQuestionnaireUWParametersInstance.Financial.DateReceived = Date.Today...")
                            If IsNothing(HT5FinancialQuestionnaireUWParametersInstance.Financial) Then
                    HT5FinancialQuestionnaireUWParametersInstance.Financial = New InMotionGIT.Questionnaires.Financial
                End If

            HT5FinancialQuestionnaireUWParametersInstance.Financial.DateReceived = Date.Today

            currentAction = SessionTrace("5. If HT5FinancialQuestionnaireUWParametersInstance.fromPanel = true Then")
            If HT5FinancialQuestionnaireUWParametersInstance.fromPanel = true Then

                currentAction = SessionTrace("6. part1.Enabled = false, zoned.Enabled = false, firma.Visible = false")
                currentAction = SessionTrace("6.1. part1.Enabled = false...")
                resultData.AddControlBehavior("part1", "disabled")
                currentAction = SessionTrace("6.2. zoned.Enabled = false...")
                resultData.AddControlBehavior("zoned", "disabled")
                currentAction = SessionTrace("6.3. firma.Visible = false...")
                resultData.AddControlBehavior("firma", "hide")

                End If

        End Sub
#End Region
#Region "Utilities"

        Private Shared Sub ParametersToDictionary(formData As HT5FinancialQuestionnaireUWParameters, ByRef target As Dictionary(Of String, Object))
            If IsNothing(target) Then
                target = New Dictionary(Of String, Object)

                target.Add("uwcaseid", formData.uwcaseid)
                target.Add("uwreqid", formData.uwreqid)
                target.Add("ClientName", formData.ClientName)
                target.Add("StatusCase", formData.StatusCase)
                target.Add("StatusRequirement", formData.StatusRequirement)
                target.Add("Financial", formData.Financial)
                target.Add("Year1", formData.Year1)
                target.Add("Year2", formData.Year2)
                target.Add("Year3", formData.Year3)
                target.Add("AllOK", formData.AllOK)
                target.Add("RiskInformation", formData.RiskInformation)
                target.Add("fromPanel", formData.fromPanel)
                target.Add("caseLocked", formData.caseLocked)
                target.Add("IsAnonymous", formData.IsAnonymous)
                target.Add("uwCaseIdInt64", formData.uwCaseIdInt64)
                target.Add("UsercodeFASI", formData.UsercodeFASI)
                target.Add("ClientUser", formData.ClientUser)
            Else
                target("uwcaseid") = formData.uwcaseid
                target("uwreqid") = formData.uwreqid
                target("ClientName") = formData.ClientName
                target("StatusCase") = formData.StatusCase
                target("StatusRequirement") = formData.StatusRequirement
                target("Financial") = formData.Financial
                target("Year1") = formData.Year1
                target("Year2") = formData.Year2
                target("Year3") = formData.Year3
                target("AllOK") = formData.AllOK
                target("RiskInformation") = formData.RiskInformation
                target("fromPanel") = formData.fromPanel
                target("caseLocked") = formData.caseLocked
                target("IsAnonymous") = formData.IsAnonymous
                target("uwCaseIdInt64") = formData.uwCaseIdInt64
                target("UsercodeFASI") = formData.UsercodeFASI
                target("ClientUser") = formData.ClientUser
            End If
        End Sub

        Private Shared Sub GetTransferParameters(parametersData As HT5FinancialQuestionnaireUWParameters, fromid As String)
            Dim fromDocumentCache As Object = Nothing

            If Not String.IsNullOrEmpty(fromid) Then
                fromDocumentCache = HttpContext.Current.Session(fromid)
                HttpContext.Current.Session.Remove(fromid)

            Else
                fromDocumentCache = HttpContext.Current.Session(HttpContext.Current.Session("fromid"))
                HttpContext.Current.Session.Remove(HttpContext.Current.Session("fromid"))
                HttpContext.Current.Session.Remove("fromid")
            End If

            If Not IsNothing(fromDocumentCache) Then
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("uwcaseid", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("uwreqid", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ClientName", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("StatusCase", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("StatusRequirement", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Financial", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Year1", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Year2", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Year3", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("AllOK", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("RiskInformation", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("fromPanel", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("caseLocked", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("IsAnonymous", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("uwCaseIdInt64", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("UsercodeFASI", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ClientUser", fromDocumentCache, parametersData)
            End If
        End Sub

        Private Shared Function SessionTrace(message As String) As String

            If Not IsNothing(HttpContext.Current.Session("Form.Track")) AndAlso HttpContext.Current.Session("Form.Track").ToString.ToLower = "true" Then
                Dim tracelog As String = HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath")))

                tracelog += String.Format(CultureInfo.InvariantCulture, "{0} {1}<br>{2}", Now.ToString("hh:mm:ss.fff"), message, vbCrLf)
                HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath"))) = tracelog
            End If

            Return message
        End Function

#End Region


#Region "Storage Database Methods"

      Private Shared Sub StoreFormInformation(formData As HT5FinancialQuestionnaireUWParameters)
            If Not IsNothing(formData) Then
                Dim foundData As Boolean

                If formData.InternalId.IsEmpty Then
                    formData.InternalId = Guid.NewGuid.ToString
                Else
                    With New DataManagerFactory("SELECT COUNT(FormId) FROM FrontOffice.DocumentCache WHERE FormId = @:FormId",
                                 "FrontOffice.DocumentCache", "FrontOfficeConnectionString")
                        .AddParameter("FormId", DbType.AnsiStringFixedLength, 36, False, formData.InternalId)
                        foundData = .QueryExecuteScalarToInteger > 0
                    End With
                End If

                If foundData Then
                    UpdateStorageData(formData)
                Else
                    InsertStorageData(formData)
                End If

                If Not IsNothing(HttpContext.Current.Session("Form.Track")) AndAlso
                    HttpContext.Current.Session("Form.Track").ToString.ToLower = "true" Then
                    HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.HT5FinancialQuestionnaireUW", formData.InternalId)) = formData
                End If

                If Not IsNothing(HttpContext.Current.Session("Form.Track.Parameters")) AndAlso
                    HttpContext.Current.Session("Form.Track.Parameters").ToString.ToLower = "true" Then

                    If Not IsNothing(HttpContext.Current.Session("Form.Track")) AndAlso HttpContext.Current.Session("Form.Track").ToString.ToLower = "true" Then
                        InMotionGIT.Common.Helpers.FileHandler.SaveContent(String.Format(CultureInfo.InvariantCulture, 
                                                                                         "{0}\{1}.HT5FinancialQuestionnaireUW.txt", ConfigurationManager.AppSettings("Path.Logs"), formData.InternalId), 
                                                                                         HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", 
                                                                                                                                   IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath"))))
                    End If

                    InMotionGIT.Common.Helpers.Serialize.SerializeToFile(Of HT5FinancialQuestionnaireUWParameters)(formData, String.Format(CultureInfo.InvariantCulture, "{0}\{1}.HT5FinancialQuestionnaireUW.xml", 
                                                                                                                        ConfigurationManager.AppSettings("Path.Logs"), formData.InternalId), True)
                End If
            End If
        End Sub

        Private Shared Function RetrieveFormInformationFromDatabase(instanceFormId As String) As HT5FinancialQuestionnaireUWParameters
            Dim result As HT5FinancialQuestionnaireUWParameters = Nothing
            Dim records As DataTable = Nothing

            With New DataManagerFactory("SELECT Content FROM FrontOffice.DocumentCache WHERE FormId = @:FormId",
                                        "FrontOffice.DocumentCache", "FrontOfficeConnectionString")

            .AddParameter("FormId", DbType.AnsiStringFixedLength, 36, False, instanceFormId)
                records = .QueryExecuteToTable(True)
            End With

            If records.Rows.Count > 0 Then
                result = Serialize.Deserialize(Of HT5FinancialQuestionnaireUWParameters)(records.FirstRow.Item("Content"))
            End If

            Return result
        End Function

        Private Shared Sub InsertStorageData(formData As HT5FinancialQuestionnaireUWParameters)
            Dim UserInfo As New InMotionGIT.Membership.Providers.MemberContext
	    
            With New DataManagerFactory("INSERT INTO FrontOffice.DocumentCache (FormId, ModelId, UserId, Page, Content, CreationDate, UpdateDate) VALUES(@:FormId, @:ModelId, @:UserId, @:Page, @:Content, @:CreationDate, @:UpdateDate)",
                                        "FrontOffice.DocumentCache", "FrontOfficeConnectionString")

                .AddParameter("FormId", DbType.AnsiStringFixedLength, 36, False, formData.InternalId)
                .AddParameter("ModelId", DbType.AnsiStringFixedLength, 36, False, "6b35db87-c370-488a-ac67-77bb307fdae8")
                .AddParameter("UserId", DbType.AnsiString, 256, False, UserInfo.UserId)
            .AddParameter("Page", DbType.AnsiString, 255, False, HttpContext.Current.Request.UrlReferrer.AbsolutePath)
            .AddParameter("Content", DbType.Xml, 1, False, Serialize.Serialize(Of HT5FinancialQuestionnaireUWParameters)(formData))
            .AddParameter("CreationDate", DbType.DateTime, 20, False, Now)
            .AddParameter("UpdateDate", DbType.DateTime, 20, False, Now)

                .CommandExecute()
            End With
        End Sub

        Private Shared Sub UpdateStorageData(formData As HT5FinancialQuestionnaireUWParameters)
            Dim UserInfo As New InMotionGIT.Membership.Providers.MemberContext
	    
            With New DataManagerFactory("UPDATE FrontOffice.DocumentCache SET ModelId = @:ModelId, UserId = @:UserId, Page = @:Page, Content = @:Content, UpdateDate = @:UpdateDate WHERE FormId = @:FormId",
                                        "FrontOffice.DocumentCache", "FrontOfficeConnectionString")

                .AddParameter("ModelId", DbType.AnsiStringFixedLength, 36, False, "6b35db87-c370-488a-ac67-77bb307fdae8")
                .AddParameter("UserId", DbType.AnsiString, 256, False, UserInfo.UserId)
            .AddParameter("Page", DbType.AnsiString, 255, False, HttpContext.Current.Request.UrlReferrer.AbsolutePath)
            .AddParameter("Content", DbType.Xml, 1, False, Serialize.Serialize(Of HT5FinancialQuestionnaireUWParameters)(formData))
            .AddParameter("UpdateDate", DbType.DateTime, 20, False, Now)
            .AddParameter("FormId", DbType.AnsiStringFixedLength, 36, False, formData.InternalId)

                .CommandExecute()
            End With
        End Sub

#End Region


#Region "Contracts Mappers"

        Private Shared Function EntryDataToClass(parametersData As HT5FinancialQuestionnaireUWParameters, formData As EntryData) As HT5FinancialQuestionnaireUWParameters
            If IsNothing(parametersData) Then
                parametersData = New HT5FinancialQuestionnaireUWParameters
            End If

            If IsNothing(parametersData.Financial) Then
                parametersData.Financial = New InMotionGIT.Questionnaires.Financial
            End If

            With parametersData
                .InternalId = formData.InstanceFormId
                .ClientName = formData.ClientName
                .uwcaseid = formData.uwcaseid
                .Financial.Year1 = formData.FinancialYear1
                .Financial.Year2 = formData.FinancialYear2
                .Financial.Year3 = formData.FinancialYear3
                .Financial.SalaryYear1 = formData.FinancialSalaryYear1
                .Financial.SalaryYear2 = formData.FinancialSalaryYear2
                .Financial.SalaryYear3 = formData.FinancialSalaryYear3
                .Financial.BusinesReported1 = formData.FinancialBusinesReported1
                .Financial.BusinesReported2 = formData.FinancialBusinesReported2
                .Financial.BusinesReported3 = formData.FinancialBusinesReported3
                .Financial.BonusYear1 = formData.FinancialBonusYear1
                .Financial.BonusYear2 = formData.FinancialBonusYear2
                .Financial.BonusYear3 = formData.FinancialBonusYear3
                .Financial.CommissionYear1 = formData.FinancialCommissionYear1
                .Financial.CommissionYear2 = formData.FinancialCommissionYear2
                .Financial.CommissionYear3 = formData.FinancialCommissionYear3
                .Financial.PensionProfitSharingYear1 = formData.FinancialPensionProfitSharingYear1
                .Financial.PensionProfitSharingYear2 = formData.FinancialPensionProfitSharingYear2
                .Financial.PensionProfitSharingYear3 = formData.FinancialPensionProfitSharingYear3
                .Financial.OtherIncomeYear1 = formData.FinancialOtherIncomeYear1
                .Financial.OtherIncomeYear2 = formData.FinancialOtherIncomeYear2
                .Financial.OtherIncomeYear3 = formData.FinancialOtherIncomeYear3
                .Financial.DescriptionOtherIncome = formData.FinancialDescriptionOtherIncome
                .Financial.TotalEarnedIncomeYear1 = formData.FinancialTotalEarnedIncomeYear1
                .Financial.TotalEarnedIncomeYear2 = formData.FinancialTotalEarnedIncomeYear2
                .Financial.TotalEarnedIncomeYear3 = formData.FinancialTotalEarnedIncomeYear3
                .Year1 = formData.Year1
                .Year2 = formData.Year2
                .Financial.DividendsYear1 = formData.FinancialDividendsYear1
                .Financial.DividendsYear2 = formData.FinancialDividendsYear2
                .Financial.DividendsYear3 = formData.FinancialDividendsYear3
                .Financial.InterestYear1 = formData.FinancialInterestYear1
                .Financial.InterestYear2 = formData.FinancialInterestYear2
                .Financial.InterestYear3 = formData.FinancialInterestYear3
                .Financial.NetRentalsYear1 = formData.FinancialNetRentalsYear1
                .Financial.NetRentalsYear2 = formData.FinancialNetRentalsYear2
                .Financial.NetRentalsYear3 = formData.FinancialNetRentalsYear3
                .Financial.CapitalGainsYear1 = formData.FinancialCapitalGainsYear1
                .Financial.CapitalGainsYear2 = formData.FinancialCapitalGainsYear2
                .Financial.CapitalGainsYear3 = formData.FinancialCapitalGainsYear3
                .Financial.OtherEarnedIncomeYear1 = formData.FinancialOtherEarnedIncomeYear1
                .Financial.OtherEarnedIncomeYear2 = formData.FinancialOtherEarnedIncomeYear2
                .Financial.OtherEarnedIncomeYear3 = formData.FinancialOtherEarnedIncomeYear3
                .Financial.DescriptionOtherEarnedIncome = formData.FinancialDescriptionOtherEarnedIncome
                .Financial.TotalUnearnedIncomeYear1 = formData.FinancialTotalUnearnedIncomeYear1
                .Financial.TotalUnearnedIncomeYear2 = formData.FinancialTotalUnearnedIncomeYear2
                .Financial.TotalUnearnedIncomeYear3 = formData.FinancialTotalUnearnedIncomeYear3
                .Financial.Cash = formData.FinancialCash
                .Financial.RealEstate = formData.FinancialRealEstate
                .Financial.BusinessEquity = formData.FinancialBusinessEquity
                .Financial.Stocks = formData.FinancialStocks
                .Financial.OtherAssets1 = formData.FinancialOtherAssets1
                .Financial.DescribeOtherAssets1 = formData.FinancialDescribeOtherAssets1
                .Financial.OtherAssets2 = formData.FinancialOtherAssets2
                .Financial.DescribeOtherAssets2 = formData.FinancialDescribeOtherAssets2
                .Financial.OtherAssets3 = formData.FinancialOtherAssets3
                .Financial.DescribeOtherAssets3 = formData.FinancialDescribeOtherAssets3
                .Financial.OtherAssets4 = formData.FinancialOtherAssets4
                .Financial.DescribeOtherAssets4 = formData.FinancialDescribeOtherAssets4
                .Financial.TotalAssets = formData.FinancialTotalAssets
                .Financial.Mortgages = formData.FinancialMortgages
                .Financial.Loans = formData.FinancialLoans
                .Financial.Liens = formData.FinancialLiens
                .Financial.Bonds = formData.FinancialBonds
                .Financial.OtherLiabilities1 = formData.FinancialOtherLiabilities1
                .Financial.DescribeOtherLiabilities1 = formData.FinancialDescribeOtherLiabilities1
                .Financial.OtherLiabilities2 = formData.FinancialOtherLiabilities2
                .Financial.DescribeOtherLiabilities2 = formData.FinancialDescribeOtherLiabilities2
                .Financial.OtherLiabilities3 = formData.FinancialOtherLiabilities3
                .Financial.DescribeOtherLiabilities3 = formData.FinancialDescribeOtherLiabilities3
                .Financial.OtherLiabilities4 = formData.FinancialOtherLiabilities4
                .Financial.DescribeOtherLiabilities4 = formData.FinancialDescribeOtherLiabilities4
                .Financial.TotalLiabilities = formData.FinancialTotalLiabilities
                .Financial.AdditionalInformation = formData.FinancialAdditionalInformation
                .Financial.DateReceived = formData.FinancialDateReceived
            End With

            Return parametersData
        End Function

        Private Shared Function ClassToEntryData(formData As EntryData, parametersData As HT5FinancialQuestionnaireUWParameters) As EntryData
            formData = New EntryData

            With formData
                .InstanceFormId = parametersData.InternalId
                .ClientName = parametersData.ClientName
                .uwcaseid = parametersData.uwcaseid
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialYear1 = parametersData.Financial.Year1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialYear2 = parametersData.Financial.Year2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialYear3 = parametersData.Financial.Year3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialSalaryYear1 = parametersData.Financial.SalaryYear1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialSalaryYear2 = parametersData.Financial.SalaryYear2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialSalaryYear3 = parametersData.Financial.SalaryYear3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialBusinesReported1 = parametersData.Financial.BusinesReported1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialBusinesReported2 = parametersData.Financial.BusinesReported2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialBusinesReported3 = parametersData.Financial.BusinesReported3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialBonusYear1 = parametersData.Financial.BonusYear1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialBonusYear2 = parametersData.Financial.BonusYear2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialBonusYear3 = parametersData.Financial.BonusYear3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialCommissionYear1 = parametersData.Financial.CommissionYear1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialCommissionYear2 = parametersData.Financial.CommissionYear2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialCommissionYear3 = parametersData.Financial.CommissionYear3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialPensionProfitSharingYear1 = parametersData.Financial.PensionProfitSharingYear1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialPensionProfitSharingYear2 = parametersData.Financial.PensionProfitSharingYear2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialPensionProfitSharingYear3 = parametersData.Financial.PensionProfitSharingYear3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialOtherIncomeYear1 = parametersData.Financial.OtherIncomeYear1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialOtherIncomeYear2 = parametersData.Financial.OtherIncomeYear2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialOtherIncomeYear3 = parametersData.Financial.OtherIncomeYear3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialDescriptionOtherIncome = parametersData.Financial.DescriptionOtherIncome
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialTotalEarnedIncomeYear1 = parametersData.Financial.TotalEarnedIncomeYear1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialTotalEarnedIncomeYear2 = parametersData.Financial.TotalEarnedIncomeYear2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialTotalEarnedIncomeYear3 = parametersData.Financial.TotalEarnedIncomeYear3
                End If
                .Year1 = parametersData.Year1
                .Year2 = parametersData.Year2
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialDividendsYear1 = parametersData.Financial.DividendsYear1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialDividendsYear2 = parametersData.Financial.DividendsYear2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialDividendsYear3 = parametersData.Financial.DividendsYear3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialInterestYear1 = parametersData.Financial.InterestYear1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialInterestYear2 = parametersData.Financial.InterestYear2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialInterestYear3 = parametersData.Financial.InterestYear3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialNetRentalsYear1 = parametersData.Financial.NetRentalsYear1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialNetRentalsYear2 = parametersData.Financial.NetRentalsYear2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialNetRentalsYear3 = parametersData.Financial.NetRentalsYear3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialCapitalGainsYear1 = parametersData.Financial.CapitalGainsYear1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialCapitalGainsYear2 = parametersData.Financial.CapitalGainsYear2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialCapitalGainsYear3 = parametersData.Financial.CapitalGainsYear3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialOtherEarnedIncomeYear1 = parametersData.Financial.OtherEarnedIncomeYear1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialOtherEarnedIncomeYear2 = parametersData.Financial.OtherEarnedIncomeYear2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialOtherEarnedIncomeYear3 = parametersData.Financial.OtherEarnedIncomeYear3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialDescriptionOtherEarnedIncome = parametersData.Financial.DescriptionOtherEarnedIncome
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialTotalUnearnedIncomeYear1 = parametersData.Financial.TotalUnearnedIncomeYear1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialTotalUnearnedIncomeYear2 = parametersData.Financial.TotalUnearnedIncomeYear2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialTotalUnearnedIncomeYear3 = parametersData.Financial.TotalUnearnedIncomeYear3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialCash = parametersData.Financial.Cash
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialRealEstate = parametersData.Financial.RealEstate
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialBusinessEquity = parametersData.Financial.BusinessEquity
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialStocks = parametersData.Financial.Stocks
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialOtherAssets1 = parametersData.Financial.OtherAssets1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialDescribeOtherAssets1 = parametersData.Financial.DescribeOtherAssets1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialOtherAssets2 = parametersData.Financial.OtherAssets2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialDescribeOtherAssets2 = parametersData.Financial.DescribeOtherAssets2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialOtherAssets3 = parametersData.Financial.OtherAssets3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialDescribeOtherAssets3 = parametersData.Financial.DescribeOtherAssets3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialOtherAssets4 = parametersData.Financial.OtherAssets4
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialDescribeOtherAssets4 = parametersData.Financial.DescribeOtherAssets4
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialTotalAssets = parametersData.Financial.TotalAssets
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialMortgages = parametersData.Financial.Mortgages
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialLoans = parametersData.Financial.Loans
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialLiens = parametersData.Financial.Liens
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialBonds = parametersData.Financial.Bonds
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialOtherLiabilities1 = parametersData.Financial.OtherLiabilities1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialDescribeOtherLiabilities1 = parametersData.Financial.DescribeOtherLiabilities1
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialOtherLiabilities2 = parametersData.Financial.OtherLiabilities2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialDescribeOtherLiabilities2 = parametersData.Financial.DescribeOtherLiabilities2
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialOtherLiabilities3 = parametersData.Financial.OtherLiabilities3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialDescribeOtherLiabilities3 = parametersData.Financial.DescribeOtherLiabilities3
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialOtherLiabilities4 = parametersData.Financial.OtherLiabilities4
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialDescribeOtherLiabilities4 = parametersData.Financial.DescribeOtherLiabilities4
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialTotalLiabilities = parametersData.Financial.TotalLiabilities
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialAdditionalInformation = parametersData.Financial.AdditionalInformation
                End If
                If Not IsNothing(parametersData.Financial) Then
                    .FinancialDateReceived = parametersData.Financial.DateReceived
                End If
            End With

            Return formData
        End Function

#End Region

#Region "Common Utilities"

        Private Shared Sub SetDefaultValuesFromQueryString(formData As HT5FinancialQuestionnaireUWParameters)
            If HttpContext.Current.Request.QueryString("uwcaseid").IsNotEmpty Then
                formData.uwcaseid = HttpContext.Current.Request.QueryString("uwcaseid")
            End If
            If HttpContext.Current.Request.QueryString("uwreqid").IsNotEmpty Then
                formData.uwreqid = HttpContext.Current.Request.QueryString("uwreqid")
            End If
            If HttpContext.Current.Request.QueryString("ClientName").IsNotEmpty Then
                formData.ClientName = HttpContext.Current.Request.QueryString("ClientName")
            End If
            If HttpContext.Current.Request.QueryString("StatusCase").IsNotEmpty Then
                formData.StatusCase = HttpContext.Current.Request.QueryString("StatusCase")
            End If
            If HttpContext.Current.Request.QueryString("StatusRequirement").IsNotEmpty Then
                formData.StatusRequirement = HttpContext.Current.Request.QueryString("StatusRequirement")
            End If
            If HttpContext.Current.Request.QueryString("Year1").IsNotEmpty Then
                formData.Year1 = HttpContext.Current.Request.QueryString("Year1")
            End If
            If HttpContext.Current.Request.QueryString("Year2").IsNotEmpty Then
                formData.Year2 = HttpContext.Current.Request.QueryString("Year2")
            End If
            If HttpContext.Current.Request.QueryString("Year3").IsNotEmpty Then
                formData.Year3 = HttpContext.Current.Request.QueryString("Year3")
            End If
            If HttpContext.Current.Request.QueryString("AllOK").IsNotEmpty Then
                formData.AllOK = HttpContext.Current.Request.QueryString("AllOK")
            End If
            If HttpContext.Current.Request.QueryString("fromPanel").IsNotEmpty Then
                formData.fromPanel = HttpContext.Current.Request.QueryString("fromPanel")
            End If
            If HttpContext.Current.Request.QueryString("caseLocked").IsNotEmpty Then
                formData.caseLocked = HttpContext.Current.Request.QueryString("caseLocked")
            End If
            If HttpContext.Current.Request.QueryString("IsAnonymous").IsNotEmpty Then
                formData.IsAnonymous = HttpContext.Current.Request.QueryString("IsAnonymous")
            End If
            If HttpContext.Current.Request.QueryString("uwCaseIdInt64").IsNotEmpty Then
                formData.uwCaseIdInt64 = HttpContext.Current.Request.QueryString("uwCaseIdInt64")
            End If
            If HttpContext.Current.Request.QueryString("UsercodeFASI").IsNotEmpty Then
                formData.UsercodeFASI = HttpContext.Current.Request.QueryString("UsercodeFASI")
            End If
        End Sub	

        Private Shared Sub ValidateParametersInstance(ByRef formData As HT5FinancialQuestionnaireUWParameters)
            If IsNothing(formData.Financial) Then
                formData.Financial = New InMotionGIT.Questionnaires.Financial
            End If

        End Sub

#End Region

#Region "Form Contracts"

        <Serializable()>
        <DataContract()>
        Public Class EntryData

            <DataMember()> Public Property InstanceFormId As String
            <DataMember()> Public Property ClientName As String
            <DataMember()> Public Property uwcaseid As Int64
            <DataMember()> Public Property FinancialYear1 As System.Int32
            <DataMember()> Public Property FinancialYear2 As System.Int32
            <DataMember()> Public Property FinancialYear3 As System.Int32
            <DataMember()> Public Property FinancialSalaryYear1 As System.Double
            <DataMember()> Public Property FinancialSalaryYear2 As System.Double
            <DataMember()> Public Property FinancialSalaryYear3 As System.Double
            <DataMember()> Public Property FinancialBusinesReported1 As System.Double
            <DataMember()> Public Property FinancialBusinesReported2 As System.Double
            <DataMember()> Public Property FinancialBusinesReported3 As System.Double
            <DataMember()> Public Property FinancialBonusYear1 As System.Double
            <DataMember()> Public Property FinancialBonusYear2 As System.Double
            <DataMember()> Public Property FinancialBonusYear3 As System.Double
            <DataMember()> Public Property FinancialCommissionYear1 As System.Double
            <DataMember()> Public Property FinancialCommissionYear2 As System.Double
            <DataMember()> Public Property FinancialCommissionYear3 As System.Double
            <DataMember()> Public Property FinancialPensionProfitSharingYear1 As System.Double
            <DataMember()> Public Property FinancialPensionProfitSharingYear2 As System.Double
            <DataMember()> Public Property FinancialPensionProfitSharingYear3 As System.Double
            <DataMember()> Public Property FinancialOtherIncomeYear1 As System.Double
            <DataMember()> Public Property FinancialOtherIncomeYear2 As System.Double
            <DataMember()> Public Property FinancialOtherIncomeYear3 As System.Double
            <DataMember()> Public Property FinancialDescriptionOtherIncome As System.String
            <DataMember()> Public Property FinancialTotalEarnedIncomeYear1 As System.Double
            <DataMember()> Public Property FinancialTotalEarnedIncomeYear2 As System.Double
            <DataMember()> Public Property FinancialTotalEarnedIncomeYear3 As System.Double
            <DataMember()> Public Property Year1 As Int32
            <DataMember()> Public Property Year2 As Int32
            <DataMember()> Public Property FinancialDividendsYear1 As System.Double
            <DataMember()> Public Property FinancialDividendsYear2 As System.Double
            <DataMember()> Public Property FinancialDividendsYear3 As System.Double
            <DataMember()> Public Property FinancialInterestYear1 As System.Double
            <DataMember()> Public Property FinancialInterestYear2 As System.Double
            <DataMember()> Public Property FinancialInterestYear3 As System.Double
            <DataMember()> Public Property FinancialNetRentalsYear1 As System.Double
            <DataMember()> Public Property FinancialNetRentalsYear2 As System.Double
            <DataMember()> Public Property FinancialNetRentalsYear3 As System.Double
            <DataMember()> Public Property FinancialCapitalGainsYear1 As System.Double
            <DataMember()> Public Property FinancialCapitalGainsYear2 As System.Double
            <DataMember()> Public Property FinancialCapitalGainsYear3 As System.Double
            <DataMember()> Public Property FinancialOtherEarnedIncomeYear1 As System.Double
            <DataMember()> Public Property FinancialOtherEarnedIncomeYear2 As System.Double
            <DataMember()> Public Property FinancialOtherEarnedIncomeYear3 As System.Double
            <DataMember()> Public Property FinancialDescriptionOtherEarnedIncome As System.String
            <DataMember()> Public Property FinancialTotalUnearnedIncomeYear1 As System.Double
            <DataMember()> Public Property FinancialTotalUnearnedIncomeYear2 As System.Double
            <DataMember()> Public Property FinancialTotalUnearnedIncomeYear3 As System.Double
            <DataMember()> Public Property FinancialCash As System.Double
            <DataMember()> Public Property FinancialRealEstate As System.Double
            <DataMember()> Public Property FinancialBusinessEquity As System.Double
            <DataMember()> Public Property FinancialStocks As System.Double
            <DataMember()> Public Property FinancialOtherAssets1 As System.Double
            <DataMember()> Public Property FinancialDescribeOtherAssets1 As System.String
            <DataMember()> Public Property FinancialOtherAssets2 As System.Double
            <DataMember()> Public Property FinancialDescribeOtherAssets2 As System.String
            <DataMember()> Public Property FinancialOtherAssets3 As System.Double
            <DataMember()> Public Property FinancialDescribeOtherAssets3 As System.String
            <DataMember()> Public Property FinancialOtherAssets4 As System.Double
            <DataMember()> Public Property FinancialDescribeOtherAssets4 As System.String
            <DataMember()> Public Property FinancialTotalAssets As System.Double
            <DataMember()> Public Property FinancialMortgages As System.Double
            <DataMember()> Public Property FinancialLoans As System.Double
            <DataMember()> Public Property FinancialLiens As System.Double
            <DataMember()> Public Property FinancialBonds As System.Double
            <DataMember()> Public Property FinancialOtherLiabilities1 As System.Double
            <DataMember()> Public Property FinancialDescribeOtherLiabilities1 As System.String
            <DataMember()> Public Property FinancialOtherLiabilities2 As System.Double
            <DataMember()> Public Property FinancialDescribeOtherLiabilities2 As System.String
            <DataMember()> Public Property FinancialOtherLiabilities3 As System.Double
            <DataMember()> Public Property FinancialDescribeOtherLiabilities3 As System.String
            <DataMember()> Public Property FinancialOtherLiabilities4 As System.Double
            <DataMember()> Public Property FinancialDescribeOtherLiabilities4 As System.String
            <DataMember()> Public Property FinancialTotalLiabilities As System.Double
            <DataMember()> Public Property FinancialAdditionalInformation As System.String
            <DataMember()> Public Property FinancialDateReceived As System.DateTime

        End Class

        <Serializable()>
        Public Class HT5FinancialQuestionnaireUWParameters
            Inherits InMotionGIT.FrontOffice.Support.DataType.FormBase(Of HT5FinancialQuestionnaireUWParameters)

            Public Property uwcaseid As Int64
            Public Property uwreqid As Int64
            Public Property ClientName As String
            Public Property StatusCase As Int32
            Public Property StatusRequirement As Int32
            Public Property Financial As InMotionGIT.Questionnaires.Financial
            Public Property Year1 As Int32
            Public Property Year2 As Int32
            Public Property Year3 As Int32
            Public Property AllOK As Boolean
            Public Property RiskInformation As InMotionGIT.Policy.Entity.Contracts.RiskInformation
            Public Property fromPanel As Boolean
            Public Property caseLocked As Boolean
            Public Property IsAnonymous As Boolean
            Public Property uwCaseIdInt64 As Int64
            Public Property UsercodeFASI As Int32
            Public Property ClientUser As InMotionGIT.Client.Entity.Contracts.Client

        End Class
#End Region

    End Class

End Namespace

