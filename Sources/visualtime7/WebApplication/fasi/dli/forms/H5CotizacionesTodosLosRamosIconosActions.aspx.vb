'---------------------------------------------------------------------------------------------------
' <generated>
'     This code was generated by Form Designer v7.3.34.1 at 2020-01-22 11:31:34 a. m. model release 4, Form Generator v1.0.37.30
'     
'     Changes to this file may cause incorrect behavior and will be lost if the code is regenerated.
' </generated>
'---------------------------------------------------------------------------------------------------
      
#Region "using"

Imports System.Data
Imports System.Globalization
Imports System.Runtime.Serialization
Imports System.Web.Script.Services
Imports System.Web.Services
Imports InMotionGIT.Common.Helpers
Imports InMotionGIT.Common.Proxy
Imports InMotionGIT.FrontOffice.Support

#End Region

Namespace dli.forms

    Public Class H5CotizacionesTodosLosRamosIconosActions
        Inherits System.Web.UI.Page

#Region "Actions Methods"

       <WebMethod(EnableSession:=True)>
        Public Shared Function Initialization(id As String, urlid As String, fromid As String) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim instance As New EntryData With {.InstanceFormId = id}
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim currentAction As String = String.Empty
            
            Dim H5CotizacionesTodosLosRamosIconosParametersInstance As H5CotizacionesTodosLosRamosIconosParameters = Nothing

            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                
                If id.IsEmpty AndAlso urlid.IsEmpty Then
                    instance.InstanceFormId = System.Guid.NewGuid().ToString
                    
                    With instance

                    End With                
                    
                    H5CotizacionesTodosLosRamosIconosParametersInstance = EntryDataToClass(H5CotizacionesTodosLosRamosIconosParametersInstance, instance)
                    SetDefaultValuesFromQueryString(H5CotizacionesTodosLosRamosIconosParametersInstance)
                    
                    If fromid.IsNotEmpty Then
                        GetTransferParameters(H5CotizacionesTodosLosRamosIconosParametersInstance, fromid)
                        ValidateParametersInstance(H5CotizacionesTodosLosRamosIconosParametersInstance)
                    End If
                Else       
                    instance.InstanceFormId = id.IfEmpty(urlid)
                    H5CotizacionesTodosLosRamosIconosParametersInstance = RetrieveFormInformationFromSession(instance.InstanceFormId)
         
                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance) then
                        H5CotizacionesTodosLosRamosIconosParametersInstance = EntryDataToClass(H5CotizacionesTodosLosRamosIconosParametersInstance, instance)                        
                    End If
                    
                    SetDefaultValuesFromQueryString(H5CotizacionesTodosLosRamosIconosParametersInstance)
                End If

                HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath"))) = String.Empty

                If id.IsEmpty AndAlso urlid.IsEmpty Then
                    Form_Initialization(currentAction, H5CotizacionesTodosLosRamosIconosParametersInstance, resultData)
                End If


                instance = ClassToEntryData(instance, H5CotizacionesTodosLosRamosIconosParametersInstance) 
		        StoreFormInformationOnSession(H5CotizacionesTodosLosRamosIconosParametersInstance)
                
                                
                With resultData
                    .Success = True
                    .Data = New With {.Instance = instance, .LookUps = Nothing}
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "H5CotizacionesTodosLosRamosIconos", "Initialization", currentAction)
            End Try
            
            Return resultData
        End Function
  

        <WebMethod(EnableSession:=True)>
        Public Shared Function ClientID(filter As String) As InMotionGIT.FrontOffice.Support.DataType.ClientActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ClientActionResult With {.Success = True, .Count = 0}
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                resultData = InMotionGIT.BackOffice.Support.Connection.Client.Lookup(filter, 1, 20)
                
            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessClientAction(ex, "H5CotizacionesTodosLosRamosIconos", "ClientID", String.Empty)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function btnCotizarFinalClick(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim H5CotizacionesTodosLosRamosIconosParametersInstance As H5CotizacionesTodosLosRamosIconosParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                H5CotizacionesTodosLosRamosIconosParametersInstance = RetrieveFormInformationFromSession(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("btnCotizarFinalClick")
                H5CotizacionesTodosLosRamosIconosParametersInstance = EntryDataToClass(H5CotizacionesTodosLosRamosIconosParametersInstance, instance)
                currentAction = SessionTrace("1. H5CotizacionesTodosLosRamosIconosParametersInstance.StatusRun = true...")
                currentAction = SessionTrace("1.1. H5CotizacionesTodosLosRamosIconosParametersInstance.StatusRun = true...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.StatusRun = true

                currentAction = SessionTrace("2. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.EffectiveDate = today...")
                currentAction = SessionTrace("2.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.EffectiveDate = today...")
                                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.EffectiveDate = today

                currentAction = SessionTrace("3. If H5CotizacionesTodosLosRamosIconosParametersInstance.IsEmployee = true AND H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.ClientID Not Is Null Or Not Empty '' Then")
                If H5CotizacionesTodosLosRamosIconosParametersInstance.IsEmployee = true AndAlso Not String.IsNullOrEmpty(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.ClientID) Then

                    currentAction = SessionTrace("4. Call Shared Function 'Retrieve Client' with parameters (Client Identification)")
                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
                End If

                    Dim _Client_71e09a685a604b649258871044209918 As InMotionGIT.Client.Entity.Contracts.Client
                    
      _Client_71e09a685a604b649258871044209918 = (New InMotionGIT.Client.Services.ClientManager).Retrieve(clientId:=H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.ClientID, atDate:=Date.Today, childFilter:= "All")
      isNullResult = (IsNothing(_Client_71e09a685a604b649258871044209918))
      isFoundData  = Not isNullResult
    
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client = _Client_71e09a685a604b649258871044209918

                    currentAction = SessionTrace("5. H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = true...")
                    currentAction = SessionTrace("5.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = true...")

                    H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = true

                    currentAction = SessionTrace("6. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = false...")
                    currentAction = SessionTrace("6.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = false...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client = New InMotionGIT.Client.Entity.Contracts.Client
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = false

                    End If
                currentAction = SessionTrace("7. If H5CotizacionesTodosLosRamosIconosParametersInstance.IsProducer = true AND H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteProductor Not Is Null Or Not Empty '' Then")
                If H5CotizacionesTodosLosRamosIconosParametersInstance.IsProducer = true AndAlso Not String.IsNullOrEmpty(H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteProductor) Then

                    currentAction = SessionTrace("8. Call Shared Function 'Retrieve Client' with parameters (Client Identification)")
                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
                End If

                    Dim _Client_3c434d9c585a404f825f4324d11e6eea As InMotionGIT.Client.Entity.Contracts.Client
                    
      _Client_3c434d9c585a404f825f4324d11e6eea = (New InMotionGIT.Client.Services.ClientManager).Retrieve(clientId:=H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteProductor, atDate:=Date.Today, childFilter:= "All")
      isNullResult = (IsNothing(_Client_3c434d9c585a404f825f4324d11e6eea))
      isFoundData  = Not isNullResult
    
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client = _Client_3c434d9c585a404f825f4324d11e6eea

                    currentAction = SessionTrace("9. H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = true...")
                    currentAction = SessionTrace("9.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = true...")

                    H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = true

                    currentAction = SessionTrace("10. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = false...")
                    currentAction = SessionTrace("10.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = false...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client = New InMotionGIT.Client.Entity.Contracts.Client
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = false

                        End If
                currentAction = SessionTrace("11. H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = 0...")
                currentAction = SessionTrace("11.1. H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = 0...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = 0

                currentAction = SessionTrace("12. If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 2 Then")
                If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 2 Then

                    currentAction = SessionTrace("13. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 8...")
                    currentAction = SessionTrace("13.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 8...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 8

                    currentAction = SessionTrace("14. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 6664...")
                    currentAction = SessionTrace("14.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 6664...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 6664

                            End If
                currentAction = SessionTrace("15. If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 3 Then")
                If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 3 Then

                    currentAction = SessionTrace("16. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 8...")
                    currentAction = SessionTrace("16.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 8...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 8

                    currentAction = SessionTrace("17. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 605...")
                    currentAction = SessionTrace("17.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 605...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 605

                                End If
                currentAction = SessionTrace("18. If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 10 Then")
                If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 10 Then

                    currentAction = SessionTrace("19. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 6...")
                    currentAction = SessionTrace("19.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 6...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 6

                    currentAction = SessionTrace("20. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 9300...")
                    currentAction = SessionTrace("20.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 9300...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 9300
                    currentAction = SessionTrace("20.2. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer.Producer.ProducerCode = UserInfo.ProducerID...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer = New InMotionGIT.Policy.Entity.Contracts.Role
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer.Producer) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer.Producer = New InMotionGIT.Intermedia.Entity.Contracts.Producer
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer.Producer.ProducerCode = UserInfo.ProducerID

                                    End If
                currentAction = SessionTrace("21. If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 20 Then")
                If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 20 Then

                    currentAction = SessionTrace("22. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 9...")
                    currentAction = SessionTrace("22.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 9...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 9
                    currentAction = SessionTrace("22.2. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 2...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 2

                                        End If
                currentAction = SessionTrace("23. If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 40 Then")
                If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 40 Then

                    currentAction = SessionTrace("24. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 20...")
                    currentAction = SessionTrace("24.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 20...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 20
                    currentAction = SessionTrace("24.2. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 2...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 2
                    currentAction = SessionTrace("24.3. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.EffectiveDate = Date.Today...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.EffectiveDate = Date.Today

                                            End If
                currentAction = SessionTrace("25. If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 50 Then")
                If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 50 Then

                    currentAction = SessionTrace("26. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 2...")
                    currentAction = SessionTrace("26.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 2...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 2
                    currentAction = SessionTrace("26.2. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 70...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 70
                    currentAction = SessionTrace("26.3. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.EffectiveDate = Date.Today...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.EffectiveDate = Date.Today

                                                End If
                currentAction = SessionTrace("27. If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType <> 0 Then")
                If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType <> 0 Then

                    currentAction = SessionTrace("28. Call Function 'Retrieve Product Master' with parameters (Line of Business, Product Id, Effective Date)")
                    Dim _ProductMaster_db2466ece9a7425291e39c5ebe301063 As InMotionGIT.Product.Entity.Contracts.ProductMaster
                    _ProductMaster_db2466ece9a7425291e39c5ebe301063 = (New InMotionGIT.Product.Services.ProductManager).RetrieveWithCaching(lineOfBusiness:=H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness, productId:=H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode, atDate:=Date.Today)
                    H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster = _ProductMaster_db2466ece9a7425291e39c5ebe301063
                    isNullResult = (IsNothing(_ProductMaster_db2466ece9a7425291e39c5ebe301063))

                    currentAction = SessionTrace("29. H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMasterDescription = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.Description...")
                    currentAction = SessionTrace("29.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMasterDescription = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.Description...")

                    H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMasterDescription = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.Description

                    currentAction = SessionTrace("30. H5CotizacionesTodosLosRamosIconosParametersInstance.PaymentMethod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")
                    currentAction = SessionTrace("30.1. H5CotizacionesTodosLosRamosIconosParametersInstance.PaymentMethod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")

                    H5CotizacionesTodosLosRamosIconosParametersInstance.PaymentMethod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGeneralInformation.PaymentMethod
                    currentAction = SessionTrace("30.2. H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMasterDescription = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.Description...")

                    H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMasterDescription = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.Description

                    currentAction = SessionTrace("31. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PaymentFrequency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")
                    currentAction = SessionTrace("31.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PaymentFrequency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PaymentFrequency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGeneralInformation.PaymentFrequency
                    currentAction = SessionTrace("31.2. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PaymentFrequency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = New InMotionGIT.Policy.Entity.Contracts.Policy
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PaymentFrequency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGeneralInformation.PaymentFrequency
                    currentAction = SessionTrace("31.3. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PaymentMethod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PaymentMethod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGeneralInformation.PaymentMethod

                    currentAction = SessionTrace("32. SELECT CUR_ALLOW.NBRANCH, CUR_ALLOW.NPRODUCT, CUR_ALLOW.NCURRENCY FROM CUR_ALLOW... WHERE CUR_ALLOW.NBRANCH = H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness AND CUR_ALLOW.NPRODUCT = H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode AND CUR_ALLOW.SDEFAULTI = 1 )")
                    isFoundData = False
                                               With New DataManagerFactory("SELECT DISTINCT CUR_ALLOW.NCURRENCY FROM CUR_ALLOW CUR_ALLOW  WHERE CUR_ALLOW.NBRANCH = @:CUR_ALLOWNBRANCH0 AND CUR_ALLOW.NPRODUCT = @:CUR_ALLOWNPRODUCT1 AND CUR_ALLOW.SDEFAULTI = '1'", "CUR_ALLOW", "Linked.LatCombined")
.AddParameter("CUR_ALLOWNBRANCH0", DbType.Int32, 5, False, H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness)
.AddParameter("CUR_ALLOWNPRODUCT1", DbType.Int32, 5, False, H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode)
 
            H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = .QueryExecuteScalarToInteger()  
        End With

                    currentAction = SessionTrace("33. If H5CotizacionesTodosLosRamosIconosParametersInstance.Currency Is Null Or Empty  OR H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = 0 Then")
                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.Currency) OrElse H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = 0 Then

                        currentAction = SessionTrace("34. H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = 1...")
                        currentAction = SessionTrace("34.1. H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = 1...")

                        H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = 1

                                                            End If
                                                        End If
                currentAction = SessionTrace("35. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.Currency...")
                currentAction = SessionTrace("35.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.Currency...")
                                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.Currency

                currentAction = SessionTrace("36. If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 1 OR H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 2 Then")
                If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 1 OrElse H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 2 Then

                    currentAction = SessionTrace("37. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = 1...")
                    currentAction = SessionTrace("37.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = 1...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = New InMotionGIT.Policy.Entity.Contracts.Policy
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = 1

                    currentAction = SessionTrace("38. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PaymentFrequency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")
                    currentAction = SessionTrace("38.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PaymentFrequency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PaymentFrequency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGeneralInformation.PaymentFrequency
                    currentAction = SessionTrace("38.2. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PaymentFrequency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = New InMotionGIT.Policy.Entity.Contracts.Policy
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PaymentFrequency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGeneralInformation.PaymentFrequency
                    currentAction = SessionTrace("38.3. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PaymentMethod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PaymentMethod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGeneralInformation.PaymentMethod

                    currentAction = SessionTrace("39. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.DurationOfPayments = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                    currentAction = SessionTrace("39.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.DurationOfPayments = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness = New InMotionGIT.Policy.Entity.Contracts.LifeLineOfBusiness
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.DurationOfPayments = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLifeLineOfBusiness.DurationOfPayments

                    currentAction = SessionTrace("40. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.TypeOfInsurancePeriod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                    currentAction = SessionTrace("40.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.TypeOfInsurancePeriod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness = New InMotionGIT.Policy.Entity.Contracts.LifeLineOfBusiness
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.TypeOfInsurancePeriod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLifeLineOfBusiness.TypeOfInsuranceDuration

                    currentAction = SessionTrace("41. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.InsuranceDuration = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                    currentAction = SessionTrace("41.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.InsuranceDuration = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness = New InMotionGIT.Policy.Entity.Contracts.LifeLineOfBusiness
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.InsuranceDuration = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLifeLineOfBusiness.InsuranceDuration

                    currentAction = SessionTrace("42. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                    currentAction = SessionTrace("42.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLifeLineOfBusiness.Currency
                    currentAction = SessionTrace("42.2. H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")

                    H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLifeLineOfBusiness.Currency

                    currentAction = SessionTrace("43. H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                    currentAction = SessionTrace("43.1. H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")

                    H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLifeLineOfBusiness.Currency

                    currentAction = SessionTrace("45. Call 'H5NN Mi Vida vale' form with transferring parameters")
                                        HttpContext.Current.Session(H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId) = H5CotizacionesTodosLosRamosIconosParametersInstance
                    HttpContext.Current.Session("fromid") = H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId
    
                With resultData
                    .AddRedirect(String.Format(CultureInfo.InvariantCulture, "{0}/H5NNNCotizacionMiVidaVale.aspx?fromid={1}", "/fasi/dli/forms", H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId, ""))
                End With
                                                            Else
                    currentAction = SessionTrace("46. If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 3 Then")
                    If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 3 Then

                        currentAction = SessionTrace("47. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress = New InMotionGIT.General.Entity.Cont...")
                        currentAction = SessionTrace("47.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress = New InMotionGIT.General.Entity.Cont...")
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
                End If
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client = New InMotionGIT.Client.Entity.Contracts.Client
                End If
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress = New InMotionGIT.General.Entity.Contracts.Address.Address
                End If

                        H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress = New InMotionGIT.General.Entity.Contracts.Address.Address

                        currentAction = SessionTrace("48. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = 1...")
                        currentAction = SessionTrace("48.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = 1...")
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = New InMotionGIT.Policy.Entity.Contracts.Policy
                End If

                        H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = 1

                        currentAction = SessionTrace("49. 'H5CotizacionesTodosLosRamosIconosParametersInstance.InvestmentFundRelatedToProductCollection' = New 'InMotionGIT.Product.Entit'...'")
                        H5CotizacionesTodosLosRamosIconosParametersInstance.InvestmentFundRelatedToProductCollection = New InMotionGIT.Product.Entity.Contracts.InvestmentFundRelatedToProductCollection

                        currentAction = SessionTrace("50. For Each investmentfundrelatedtoproductItem As 'InMotionGIT.Product.Entit...' In 'H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.I...'")
                        For Each investmentfundrelatedtoproductItem As InMotionGIT.Product.Entity.Contracts.InvestmentFundRelatedToProduct In H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.InvestmentFundRelatedToProducts

                            currentAction = SessionTrace("51. 'H5CotizacionesTodosLosRamosIconosParametersInstance.InvestmentFundRelatedToProductCollection'.Add('investmentfundrelatedtoproductItem')")
                            H5CotizacionesTodosLosRamosIconosParametersInstance.InvestmentFundRelatedToProductCollection.Add(investmentfundrelatedtoproductItem)

                                                                                Next
                        currentAction = SessionTrace("52. H5CotizacionesTodosLosRamosIconosParametersInstance.PaymentMethod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")
                        currentAction = SessionTrace("52.1. H5CotizacionesTodosLosRamosIconosParametersInstance.PaymentMethod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")

                        H5CotizacionesTodosLosRamosIconosParametersInstance.PaymentMethod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGeneralInformation.PaymentMethod
                        currentAction = SessionTrace("52.2. H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMasterDescription = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.Description...")

                        H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMasterDescription = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.Description

                        currentAction = SessionTrace("53. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.TypeOfPaymentsPeriod = 1...")
                        currentAction = SessionTrace("53.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.TypeOfPaymentsPeriod = 1...")
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness = New InMotionGIT.Policy.Entity.Contracts.LifeLineOfBusiness
                End If

                        H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.TypeOfPaymentsPeriod = 1

                        currentAction = SessionTrace("54. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.InsuranceDuration = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                        currentAction = SessionTrace("54.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.InsuranceDuration = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness = New InMotionGIT.Policy.Entity.Contracts.LifeLineOfBusiness
                End If

                        H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.InsuranceDuration = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLifeLineOfBusiness.InsuranceDuration

                        currentAction = SessionTrace("55. H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                        currentAction = SessionTrace("55.1. H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")

                        H5CotizacionesTodosLosRamosIconosParametersInstance.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLifeLineOfBusiness.Currency

                        currentAction = SessionTrace("56. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                        currentAction = SessionTrace("56.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

                        H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Currency = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLifeLineOfBusiness.Currency

                        currentAction = SessionTrace("57. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.TypeOfInsurancePeriod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                        currentAction = SessionTrace("57.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.TypeOfInsurancePeriod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness = New InMotionGIT.Policy.Entity.Contracts.LifeLineOfBusiness
                End If

                        H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.TypeOfInsurancePeriod = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLifeLineOfBusiness.TypeOfInsuranceDuration

                        currentAction = SessionTrace("58. H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMasterDescription = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.Description...")
                        currentAction = SessionTrace("58.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMasterDescription = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.Description...")

                        H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMasterDescription = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.Description

                        currentAction = SessionTrace("59. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.DurationOfPayments = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                        currentAction = SessionTrace("59.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.DurationOfPayments = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLife...")
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                        If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness = New InMotionGIT.Policy.Entity.Contracts.LifeLineOfBusiness
                End If

                        H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness.DurationOfPayments = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductLifeLineOfBusiness.DurationOfPayments

                        currentAction = SessionTrace("61. Call 'HT5Mi Inversión Segura' form with transferring parameters")
                                                HttpContext.Current.Session(H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId) = H5CotizacionesTodosLosRamosIconosParametersInstance
                        HttpContext.Current.Session("fromid") = H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId
    
                With resultData
                    .AddRedirect(String.Format(CultureInfo.InvariantCulture, "{0}/HT5NNCotizacionMiInversionSeguraII.aspx?fromid={1}", "/fasi/dli/forms", H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId, ""))
                End With
                                                                            Else
                        currentAction = SessionTrace("62. If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 10 Then")
                        If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 10 Then

                            currentAction = SessionTrace("63. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = 1...")
                            currentAction = SessionTrace("63.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = 1...")
                                            If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                            If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = New InMotionGIT.Policy.Entity.Contracts.Policy
                End If

                            H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = 1

                            currentAction = SessionTrace("64. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress = New InMotionGIT.General.Entity.Cont...")
                            currentAction = SessionTrace("64.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress = New InMotionGIT.General.Entity.Cont...")
                                            If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                            If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
                End If
                                            If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client = New InMotionGIT.Client.Entity.Contracts.Client
                End If
                                            If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress = New InMotionGIT.General.Entity.Contracts.Address.Address
                End If

                            H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress = New InMotionGIT.General.Entity.Contracts.Address.Address

                            currentAction = SessionTrace("66. Call 'Mi Auto aDorado' form with transferring parameters")
                                                        HttpContext.Current.Session(H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId) = H5CotizacionesTodosLosRamosIconosParametersInstance
                            HttpContext.Current.Session("fromid") = H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId
    
                With resultData
                    .AddRedirect(String.Format(CultureInfo.InvariantCulture, "{0}/H5CotizacionMiAutoaDorado.aspx?fromid={1}", "/fasi/dli/forms", H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId, ""))
                End With
                                                                                        Else
                            currentAction = SessionTrace("67. If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 20 Then")
                            If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 20 Then

                                currentAction = SessionTrace("68. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")
                                currentAction = SessionTrace("68.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")
                                                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = New InMotionGIT.Policy.Entity.Contracts.Policy
                End If

                                H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGeneralInformation.PolicyType

                                currentAction = SessionTrace("69. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress = New InMotionGIT.General.Entity.Cont...")
                                currentAction = SessionTrace("69.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress = New InMotionGIT.General.Entity.Cont...")
                                                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
                End If
                                                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client = New InMotionGIT.Client.Entity.Contracts.Client
                End If
                                                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress = New InMotionGIT.General.Entity.Contracts.Address.Address
                End If

                                H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.BusinessAddress = New InMotionGIT.General.Entity.Contracts.Address.Address

                                currentAction = SessionTrace("71. Call 'HT5 Póliza Hogar Seguro' form with transferring parameters")
                                                                HttpContext.Current.Session(H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId) = H5CotizacionesTodosLosRamosIconosParametersInstance
                                HttpContext.Current.Session("fromid") = H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId
    
                With resultData
                    .AddRedirect(String.Format(CultureInfo.InvariantCulture, "{0}/HT5NNCotizacionPolizaHogarSeguro.aspx?fromid={1}", "/fasi/dli/forms", H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId, ""))
                End With
                                                                                                    Else
                                currentAction = SessionTrace("72. If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 50 Then")
                                If H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 50 Then

                                    currentAction = SessionTrace("73. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")
                                    currentAction = SessionTrace("73.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGene...")
                                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = New InMotionGIT.Policy.Entity.Contracts.Policy
                End If

                                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy.PolicyType = H5CotizacionesTodosLosRamosIconosParametersInstance.ProductMaster.ProductGeneralInformation.PolicyType

                                    currentAction = SessionTrace("75. Call 'HT5Mi Salud Vale Oro' form with transferring parameters")
                                                                        HttpContext.Current.Session(H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId) = H5CotizacionesTodosLosRamosIconosParametersInstance
                                    HttpContext.Current.Session("fromid") = H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId
    
                With resultData
                    .AddRedirect(String.Format(CultureInfo.InvariantCulture, "{0}/HT5NNCotizacionMiSaludValeOro.aspx?fromid={1}", "/fasi/dli/forms", H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId, ""))
                End With
                                                                                                                Else
                                    currentAction = SessionTrace("76. The message 'Producto en proceso ...' will displayed as 'Popup'")
                                    ParametersToDictionary(H5CotizacionesTodosLosRamosIconosParametersInstance, parametersDictionary)
                                    messageAction = "Producto en proceso de instalación"
                                    messageAction = InMotionGIT.FrontOffice.Proxy.Helpers.Email.Process(messageAction, parametersDictionary)
                                    resultData.AddNotifyPopup(messageAction)
                                                                                                                    End If
                                                                                                                End If
                                                                                                            End If
                                                                                                        End If
                                                                                                    End If

                instance = ClassToEntryData(instance, H5CotizacionesTodosLosRamosIconosParametersInstance)
                StoreFormInformationOnSession(H5CotizacionesTodosLosRamosIconosParametersInstance)
                
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "H5CotizacionesTodosLosRamosIconos", "btnCotizarFinalClick", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function button3MVVNNClick(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim H5CotizacionesTodosLosRamosIconosParametersInstance As H5CotizacionesTodosLosRamosIconosParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                H5CotizacionesTodosLosRamosIconosParametersInstance = RetrieveFormInformationFromSession(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("button3MVVNNClick")
                H5CotizacionesTodosLosRamosIconosParametersInstance = EntryDataToClass(H5CotizacionesTodosLosRamosIconosParametersInstance, instance)
                currentAction = SessionTrace("1. image9.Visible = true, btnCotizarFinal.Visible = true")
                currentAction = SessionTrace("1.1. image9.Visible = true...")
                resultData.AddControlBehavior("image9", "show")
                currentAction = SessionTrace("1.2. btnCotizarFinal.Visible = true...")
                resultData.AddControlBehavior("btnCotizarFinal", "show")

                currentAction = SessionTrace("2. H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 2...")
                currentAction = SessionTrace("2.1. H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 2...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 2

                currentAction = SessionTrace("3. H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = '/images/iconramos/2.png'...")
                currentAction = SessionTrace("3.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = '/images/iconramos/2.png'...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = "/images/iconramos/2.png"


                instance = ClassToEntryData(instance, H5CotizacionesTodosLosRamosIconosParametersInstance)
                StoreFormInformationOnSession(H5CotizacionesTodosLosRamosIconosParametersInstance)
                
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "H5CotizacionesTodosLosRamosIconos", "button3MVVNNClick", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function buttonCotVIClick(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim H5CotizacionesTodosLosRamosIconosParametersInstance As H5CotizacionesTodosLosRamosIconosParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                H5CotizacionesTodosLosRamosIconosParametersInstance = RetrieveFormInformationFromSession(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("buttonCotVIClick")
                H5CotizacionesTodosLosRamosIconosParametersInstance = EntryDataToClass(H5CotizacionesTodosLosRamosIconosParametersInstance, instance)
                currentAction = SessionTrace("1. H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 3...")
                currentAction = SessionTrace("1.1. H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 3...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 3

                currentAction = SessionTrace("2. H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = '/images/iconramos/family-care.png'...")
                currentAction = SessionTrace("2.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = '/images/iconramos/family-care.png'...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = "/images/iconramos/family-care.png"

                currentAction = SessionTrace("3. image9.Visible = true, btnCotizarFinal.Visible = true")
                currentAction = SessionTrace("3.1. image9.Visible = true...")
                resultData.AddControlBehavior("image9", "show")
                currentAction = SessionTrace("3.2. btnCotizarFinal.Visible = true...")
                resultData.AddControlBehavior("btnCotizarFinal", "show")


                instance = ClassToEntryData(instance, H5CotizacionesTodosLosRamosIconosParametersInstance)
                StoreFormInformationOnSession(H5CotizacionesTodosLosRamosIconosParametersInstance)
                
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "H5CotizacionesTodosLosRamosIconos", "buttonCotVIClick", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function CotizaMADClick(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim H5CotizacionesTodosLosRamosIconosParametersInstance As H5CotizacionesTodosLosRamosIconosParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                H5CotizacionesTodosLosRamosIconosParametersInstance = RetrieveFormInformationFromSession(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("CotizaMADClick")
                H5CotizacionesTodosLosRamosIconosParametersInstance = EntryDataToClass(H5CotizacionesTodosLosRamosIconosParametersInstance, instance)
                currentAction = SessionTrace("1. H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 10...")
                currentAction = SessionTrace("1.1. H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 10...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 10

                currentAction = SessionTrace("2. H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = '/images/iconramos/6.png'...")
                currentAction = SessionTrace("2.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = '/images/iconramos/6.png'...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = "/images/iconramos/6.png"

                currentAction = SessionTrace("3. image9.Visible = true, btnCotizarFinal.Visible = true")
                currentAction = SessionTrace("3.1. image9.Visible = true...")
                resultData.AddControlBehavior("image9", "show")
                currentAction = SessionTrace("3.2. btnCotizarFinal.Visible = true...")
                resultData.AddControlBehavior("btnCotizarFinal", "show")


                instance = ClassToEntryData(instance, H5CotizacionesTodosLosRamosIconosParametersInstance)
                StoreFormInformationOnSession(H5CotizacionesTodosLosRamosIconosParametersInstance)
                
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "H5CotizacionesTodosLosRamosIconos", "CotizaMADClick", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function CotizaHVClick(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim H5CotizacionesTodosLosRamosIconosParametersInstance As H5CotizacionesTodosLosRamosIconosParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                H5CotizacionesTodosLosRamosIconosParametersInstance = RetrieveFormInformationFromSession(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("CotizaHVClick")
                H5CotizacionesTodosLosRamosIconosParametersInstance = EntryDataToClass(H5CotizacionesTodosLosRamosIconosParametersInstance, instance)
                currentAction = SessionTrace("1. H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 20...")
                currentAction = SessionTrace("1.1. H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 20...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 20

                currentAction = SessionTrace("2. H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = '/images/iconramos/9.png'...")
                currentAction = SessionTrace("2.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = '/images/iconramos/9.png'...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = "/images/iconramos/9.png"

                currentAction = SessionTrace("3. image9.Visible = true, btnCotizarFinal.Visible = true")
                currentAction = SessionTrace("3.1. image9.Visible = true...")
                resultData.AddControlBehavior("image9", "show")
                currentAction = SessionTrace("3.2. btnCotizarFinal.Visible = true...")
                resultData.AddControlBehavior("btnCotizarFinal", "show")


                instance = ClassToEntryData(instance, H5CotizacionesTodosLosRamosIconosParametersInstance)
                StoreFormInformationOnSession(H5CotizacionesTodosLosRamosIconosParametersInstance)
                
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "H5CotizacionesTodosLosRamosIconos", "CotizaHVClick", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function CotizaHV2Click(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim H5CotizacionesTodosLosRamosIconosParametersInstance As H5CotizacionesTodosLosRamosIconosParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                H5CotizacionesTodosLosRamosIconosParametersInstance = RetrieveFormInformationFromSession(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("CotizaHV2Click")
                H5CotizacionesTodosLosRamosIconosParametersInstance = EntryDataToClass(H5CotizacionesTodosLosRamosIconosParametersInstance, instance)
                currentAction = SessionTrace("1. H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 40...")
                currentAction = SessionTrace("1.1. H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 40...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 40

                currentAction = SessionTrace("2. H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = '/images/iconramos/Crédito.png'...")
                currentAction = SessionTrace("2.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = '/images/iconramos/Crédito.png'...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = "/images/iconramos/Crédito.png"

                currentAction = SessionTrace("3. image9.Visible = true, btnCotizarFinal.Visible = true")
                currentAction = SessionTrace("3.1. image9.Visible = true...")
                resultData.AddControlBehavior("image9", "show")
                currentAction = SessionTrace("3.2. btnCotizarFinal.Visible = true...")
                resultData.AddControlBehavior("btnCotizarFinal", "show")


                instance = ClassToEntryData(instance, H5CotizacionesTodosLosRamosIconosParametersInstance)
                StoreFormInformationOnSession(H5CotizacionesTodosLosRamosIconosParametersInstance)
                
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "H5CotizacionesTodosLosRamosIconos", "CotizaHV2Click", currentAction)
            End Try
            
            Return resultData
        End Function
        <WebMethod(EnableSession:=True)>
        Public Shared Function button13Click(instance As EntryData) As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            
            Dim resultData As New InMotionGIT.FrontOffice.Support.DataType.ServerActionResult
            Dim H5CotizacionesTodosLosRamosIconosParametersInstance As H5CotizacionesTodosLosRamosIconosParameters = Nothing
            Dim UserInfo As InMotionGIT.Membership.Providers.MemberContext = Nothing
            Dim formContext As InMotionGIT.Common.Contracts.Context = Nothing
            Dim selectDataTableItem As DataTable = Nothing
            Dim currentAction As String = String.Empty
            Dim messageAction As String = String.Empty
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                H5CotizacionesTodosLosRamosIconosParametersInstance = RetrieveFormInformationFromSession(instance.InstanceFormId)
                UserInfo = New InMotionGIT.Membership.Providers.MemberContext
                formContext = New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                       instance.InstanceFormId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                      .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                      .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                      .AccessToken = HttpContext.Current.Session("AccessToken")}
                currentAction = SessionTrace("button13Click")
                H5CotizacionesTodosLosRamosIconosParametersInstance = EntryDataToClass(H5CotizacionesTodosLosRamosIconosParametersInstance, instance)
                currentAction = SessionTrace("1. H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 50...")
                currentAction = SessionTrace("1.1. H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 50...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 50

                currentAction = SessionTrace("2. H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = '/images/iconramos/5.png'...")
                currentAction = SessionTrace("2.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = '/images/iconramos/5.png'...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = "/images/iconramos/5.png"

                currentAction = SessionTrace("3. image9.Visible = true, btnCotizarFinal.Visible = true")
                currentAction = SessionTrace("3.1. image9.Visible = true...")
                resultData.AddControlBehavior("image9", "show")
                currentAction = SessionTrace("3.2. btnCotizarFinal.Visible = true...")
                resultData.AddControlBehavior("btnCotizarFinal", "show")


                instance = ClassToEntryData(instance, H5CotizacionesTodosLosRamosIconosParametersInstance)
                StoreFormInformationOnSession(H5CotizacionesTodosLosRamosIconosParametersInstance)
                
                With resultData
                    .Success = True
                    .Data = instance
                End With

            Catch ex As Exception
                resultData = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessServerAction(ex, "H5CotizacionesTodosLosRamosIconos", "button13Click", currentAction)
            End Try
            
            Return resultData
        End Function

#End Region

#Region "Lookups Web Methods"


        <WebMethod(EnableSession:=True)>
        Public Shared Function LookUpForClienteProductor(id As String) As InMotionGIT.FrontOffice.Support.DataType.ClientActionResult
            
            Dim result As New InMotionGIT.FrontOffice.Support.DataType.ClientActionResult With {.Success = True}
            Dim resultData As DataTable = Nothing
            Dim newLookupList As New List(Of InMotionGIT.Common.DataType.LookUpValue)                       
            
            Try
                InMotionGIT.FASI.Support.Authentication.AuthorizationProcess("*")
                Dim H5CotizacionesTodosLosRamosIconosParametersInstance As H5CotizacionesTodosLosRamosIconosParameters = RetrieveFormInformationFromSession(id) 
                
                With New DataManagerFactory(String.Format(CultureInfo.CurrentCulture,
                                                          "SELECT DISTINCT COMM_POL.NINTERMED, TRIM(ROLES.SCLIENT) SCLIENT, TRIM(CLIENT.SCLIENAME) SCLIENAME FROM COMM_POL COMM_POL JOIN ROLES ROLES ON ROLES.SCERTYPE = COMM_POL.SCERTYPE  AND ROLES.NBRANCH = COMM_POL.NBRANCH  AND ROLES.NPRODUCT = COMM_POL.NPRODUCT  AND ROLES.NPOLICY = COMM_POL.NPOLICY  AND ROLES.NCERTIF = COMM_POL.NCERTIF JOIN CLIENT CLIENT ON CLIENT.SCLIENT = ROLES.SCLIENT  WHERE ROLES.NROLE <> {0} AND COMM_POL.NINTERMED = @:COMM_POLNINTERMED1  AND NOT CLIENT.SCLIENAME IS NULL ORDER BY SCLIENAME", 13, ""), 
                                            "COMM_POL", "Linked.LatCombined")
                    .AddParameter("COMM_POLNINTERMED1", DbType.Int64, 10, False, H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerCode)

                    
                    resultData = .QueryExecuteToTable(True)
                End With

                If Not IsNothing(resultData) Then
                    For Each item As DataRow In resultData.Rows
                        newLookupList.Add(New InMotionGIT.Common.DataType.LookUpValue With {.Code = item.StringValue("SCLIENT"),
                                                                                            .Description = item.StringValue("SCLIENAME")})
                    Next
                End If

                result.Data = newLookupList

            Catch ex As Exception
                result = InMotionGIT.FrontOffice.Support.ExceptionHandler.ProcessClientAction(ex, "H5CotizacionesTodosLosRamosIconos", "LookUpForClienteProductor", String.Empty)
            End Try
                        
            Return result
        End Function

#End Region

#Region "Form Actions"

        Private Shared Sub Form_Initialization(ByRef currentAction As String, ByRef H5CotizacionesTodosLosRamosIconosParametersInstance As H5CotizacionesTodosLosRamosIconosParameters, ByRef resultData As InMotionGIT.FrontOffice.Support.DataType.ServerActionResult)
            Dim UserInfo As New InMotionGIT.Membership.Providers.MemberContext
            
            Dim formContext As New InMotionGIT.Common.Contracts.Context(InMotionGIT.FASI.Support.Handlers.LanguageHandler.LanguageId(), 
                                                                        H5CotizacionesTodosLosRamosIconosParametersInstance.InternalId) With {.UserId = HttpContext.Current.Session("UserId"), 
                                                                                                                     .UserCode = HttpContext.Current.Session("nUsercode"), 
                                                                                                                     .SecuritySchemeCode = HttpContext.Current.Session("sSche_code"), 
                                                                                                                     .AccessToken = HttpContext.Current.Session("AccessToken")}
            Dim selectDataTableItem As DataTable = Nothing
            Dim parametersDictionary As Dictionary(Of String, Object) = Nothing
            Dim WorkflowInArguments As Dictionary(Of String, Object) = Nothing
            Dim WorkflowOutArguments As IDictionary(Of String, Object) = Nothing
            Dim messageAction As String = String.Empty
            Dim isNullResult As Boolean = True
            Dim isFoundData As Boolean = False

            currentAction = SessionTrace("Form_Initialization")

            currentAction = SessionTrace("2. 'H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.AutomobileLineOfBusiness' = New 'InMotionGIT.Policy.Entity'...'")
            H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.AutomobileLineOfBusiness = New InMotionGIT.Policy.Entity.Contracts.AutomobileLineOfBusiness

            currentAction = SessionTrace("3. 'H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness' = New 'InMotionGIT.Policy.Entity'...'")
            H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LifeLineOfBusiness = New InMotionGIT.Policy.Entity.Contracts.LifeLineOfBusiness

            currentAction = SessionTrace("4. 'H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured' = New 'InMotionGIT.Policy.Entity'...'")
            H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role

            currentAction = SessionTrace("5. 'H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer' = New 'InMotionGIT.Policy.Entity'...'")
            H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer = New InMotionGIT.Policy.Entity.Contracts.Role

            currentAction = SessionTrace("6. H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = false...")
            currentAction = SessionTrace("6.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = false...")

            H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = false

            currentAction = SessionTrace("7. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = True...")
            currentAction = SessionTrace("7.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = True...")
                            If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                            If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
                End If
                            If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client = New InMotionGIT.Client.Entity.Contracts.Client
                End If

            H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = True

            currentAction = SessionTrace("8. Call Shared Function 'User Profile' without parameters")
            Dim _Client_be3f857e07a442ef8f1ef3e8dc565274 As InMotionGIT.Client.Entity.Contracts.Client
            

      If Not IsNothing(UserInfo) AndAlso Not IsNothing(UserInfo.User) then
         _Client_be3f857e07a442ef8f1ef3e8dc565274 = New InMotionGIT.Client.Entity.Contracts.Client

         With _Client_be3f857e07a442ef8f1ef3e8dc565274
             .ClientID = UserInfo.User.ClientID
             .FirstName = UserInfo.User.FirstName
             .LastName = UserInfo.User.LastName
             .LastName2 = UserInfo.User.SecondLastName
             .BirthDate = UserInfo.User.DateOfBirth
             .LegalName = UserInfo.User.CompanyName
             .GenderEnum = IIf(UserInfo.User.Gender = "Male", InMotionGIT.Common.Contracts.Enumerations.EnumGender.Male, InMotionGIT.Common.Contracts.Enumerations.EnumGender.Female)
             .eMailAddressDefault = UserInfo.User.Email
             .CompleteClientName = .CompleteClientNameValid
         End With

	isNullResult = (IsNothing(_Client_be3f857e07a442ef8f1ef3e8dc565274))
	isFoundData  = Not isNullResult
      End If
    
            H5CotizacionesTodosLosRamosIconosParametersInstance.Client = _Client_be3f857e07a442ef8f1ef3e8dc565274

            currentAction = SessionTrace("9. H5CotizacionesTodosLosRamosIconosParametersInstance.IsClient =UserInfo.IsClient()...")
            currentAction = SessionTrace("9.1. H5CotizacionesTodosLosRamosIconosParametersInstance.IsClient =UserInfo.IsClient()...")

            H5CotizacionesTodosLosRamosIconosParametersInstance.IsClient =UserInfo.IsClient()
            currentAction = SessionTrace("9.2. H5CotizacionesTodosLosRamosIconosParametersInstance.IsEmployee =UserInfo.IsEmployee()...")

            H5CotizacionesTodosLosRamosIconosParametersInstance.IsEmployee =UserInfo.IsEmployee()
            currentAction = SessionTrace("9.3. H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeBO = HttpContext.Current.Session('nUserCode')...")

            H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeBO = HttpContext.Current.Session("nUserCode")
            currentAction = SessionTrace("9.4. H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeFASI = UserInfo.UserId...")

            H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeFASI = UserInfo.UserId
            currentAction = SessionTrace("9.5. H5CotizacionesTodosLosRamosIconosParametersInstance.IsProducer = UserInfo.IsProducer()...")

            H5CotizacionesTodosLosRamosIconosParametersInstance.IsProducer = UserInfo.IsProducer()
            currentAction = SessionTrace("9.6. H5CotizacionesTodosLosRamosIconosParametersInstance.IsAnonymous = UserInfo.IsAnonymous()...")

            H5CotizacionesTodosLosRamosIconosParametersInstance.IsAnonymous = UserInfo.IsAnonymous()
            currentAction = SessionTrace("9.7. H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerCode = UserInfo.ProducerID...")

            H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerCode = UserInfo.ProducerID
            currentAction = SessionTrace("9.8. H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteConectado = UserInfo.ClientID...")

            H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteConectado = UserInfo.ClientID

            currentAction = SessionTrace("10. zone12CTLR.Visible = false, ClientID.Visible = false, zone10AgenteCTLR.Visible = false...")
            currentAction = SessionTrace("10.1. zone12CTLR.Visible = false...")
            resultData.AddControlBehavior("zone12CTLR", "hide")
            currentAction = SessionTrace("10.2. ClientID.Visible = false...")
            resultData.AddControlBehavior("ClientID", "hide")
            currentAction = SessionTrace("10.3. zone10AgenteCTLR.Visible = false...")
            resultData.AddControlBehavior("zone10AgenteCTLR", "hide")
            currentAction = SessionTrace("10.4. CompleteClientNameCTLR.Visible = false...")
            resultData.AddControlBehavior("CompleteClientNameCTLR", "hide")

            currentAction = SessionTrace("11. 'H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal' = New 'InMotionGIT.Policy.Entity'...'")
            H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal = New InMotionGIT.Policy.Entity.Contracts.Policy

            currentAction = SessionTrace("12. SELECT AGENCIES.NAGENCY, AGENCIES.NOFFICEAGEN, AGENCIES.NBRAN_OFF FROM AGENCIES... WHERE AGENCIES.NAGENCY = 999 )")
            isFoundData = False
                   With New DataManagerFactory("SELECT AGENCIES.NAGENCY, AGENCIES.NOFFICEAGEN, AGENCIES.NBRAN_OFF FROM AGENCIES AGENCIES  WHERE AGENCIES.NAGENCY = 999", "AGENCIES", "Linked.LatCombined")
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
            With selectDataTableItem
                    If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                        isFoundData = True
                                  If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal) Then
              H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal = New InMotionGIT.Policy.Entity.Contracts.Policy
          End If 
                                                H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal.Agency = .Rows(0).NumericValue("NAGENCY") 
                        H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal.OfficeCode = .Rows(0).NumericValue("NOFFICEAGEN") 
                        H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal.BranchOffice = .Rows(0).NumericValue("NBRAN_OFF") 

                    End If
            End With

            currentAction = SessionTrace("13. If H5CotizacionesTodosLosRamosIconosParametersInstance.IsClient = true Then")
            If H5CotizacionesTodosLosRamosIconosParametersInstance.IsClient = true Then

                currentAction = SessionTrace("14. H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeBO = 9998...")
                currentAction = SessionTrace("14.1. H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeBO = 9998...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeBO = 9998

                currentAction = SessionTrace("15. zone12CTLR.Visible = false, zone10AgenteCTLR.Visible = false, ClientID.Visible = false...")
                currentAction = SessionTrace("15.1. zone12CTLR.Visible = false...")
                resultData.AddControlBehavior("zone12CTLR", "hide")
                currentAction = SessionTrace("15.2. zone10AgenteCTLR.Visible = false...")
                resultData.AddControlBehavior("zone10AgenteCTLR", "hide")
                currentAction = SessionTrace("15.3. ClientID.Visible = false...")
                resultData.AddControlBehavior("ClientID", "hide")
                currentAction = SessionTrace("15.4. CompleteClientNameCTLR.Visible = false...")
                resultData.AddControlBehavior("CompleteClientNameCTLR", "hide")

                currentAction = SessionTrace("16. H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteConectado = H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteConectado.Trim()...")
                currentAction = SessionTrace("16.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteConectado = H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteConectado.Trim()...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteConectado = H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteConectado.Trim()

currentAction = SessionTrace("17. Call 'Búsqueda de toda la información de un cliente' library")
                Dim _Client_5ae55ea70bbb471991c164051c31fefc As InMotionGIT.Client.Entity.Contracts.Client 
                _Client_5ae55ea70bbb471991c164051c31fefc = (New InMotionGIT.Client.Proxy.Manager).Retrieve(clientId:=H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteConectado, atDate:=Date.Today, withLookupInformation:=True, childFilter:="All", accessToken:="String.Empty", provider:="CORE", companyID:=0) 
 
                isNullResult = (IsNothing(_Client_5ae55ea70bbb471991c164051c31fefc)) 
                If Not isNullResult Then
                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
                End If
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client = _Client_5ae55ea70bbb471991c164051c31fefc
                End If

                currentAction = SessionTrace("18. H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteConectado = H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryIn...")
                currentAction = SessionTrace("18.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteConectado = H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryIn...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.ClienteConectado = H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.ClientID

                currentAction = SessionTrace("19. If Form.IsNullResult = true Then")
                If isNullResult = true Then

                    currentAction = SessionTrace("20. H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = false...")
                    currentAction = SessionTrace("20.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = false...")

                    H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = false

                    currentAction = SessionTrace("21. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = True...")
                    currentAction = SessionTrace("21.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = True...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client = New InMotionGIT.Client.Entity.Contracts.Client
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = True

                    currentAction = SessionTrace("22. CompleteClientNameCTLR.Visible = false")
                    currentAction = SessionTrace("22.1. CompleteClientNameCTLR.Visible = false...")
                    resultData.AddControlBehavior("CompleteClientNameCTLR", "hide")

                        Else
                    currentAction = SessionTrace("23. H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = true...")
                    currentAction = SessionTrace("23.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = true...")

                    H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = true

                    currentAction = SessionTrace("24. CompleteClientNameCTLR.Visible = false")
                    currentAction = SessionTrace("24.1. CompleteClientNameCTLR.Visible = false...")
                    resultData.AddControlBehavior("CompleteClientNameCTLR", "hide")

                            End If
                        Else
                currentAction = SessionTrace("25. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = True...")
                currentAction = SessionTrace("25.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = True...")
                                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
                End If
                                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client = New InMotionGIT.Client.Entity.Contracts.Client
                End If

                H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = True

                currentAction = SessionTrace("26. H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = false...")
                currentAction = SessionTrace("26.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = false...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.ClientExistInDB = false

                            End If
            currentAction = SessionTrace("27. If H5CotizacionesTodosLosRamosIconosParametersInstance.IsEmployee = true Then")
            If H5CotizacionesTodosLosRamosIconosParametersInstance.IsEmployee = true Then

                currentAction = SessionTrace("28. zone12CTLR.Visible = true, zone10AgenteCTLR.Visible = false, ClientID.Visible = true...")
                currentAction = SessionTrace("28.1. zone12CTLR.Visible = true...")
                resultData.AddControlBehavior("zone12CTLR", "show")
                currentAction = SessionTrace("28.2. zone10AgenteCTLR.Visible = false...")
                resultData.AddControlBehavior("zone10AgenteCTLR", "hide")
                currentAction = SessionTrace("28.3. ClientID.Visible = true...")
                resultData.AddControlBehavior("ClientID", "show")
                currentAction = SessionTrace("28.4. CompleteClientNameCTLR.Visible = true...")
                resultData.AddControlBehavior("CompleteClientNameCTLR", "show")

                currentAction = SessionTrace("29. SELECT USERS.NAGENCY, USERS.NUSERCODE FROM USERS... WHERE USERS.NUSERCODE = H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeBO )")
                isFoundData = False
                          If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal) Then
              H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal = New InMotionGIT.Policy.Entity.Contracts.Policy
          End If 
                       With New DataManagerFactory("SELECT USERS.NAGENCY FROM USERS USERS  WHERE USERS.NUSERCODE = @:USERSNUSERCODE0", "USERS", "Linked.LatCombined")
.AddParameter("USERSNUSERCODE0", DbType.Int32, 5, False, H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeBO)
 
            H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal.Agency = .QueryExecuteScalarToInteger()  
        End With

                currentAction = SessionTrace("30. SELECT AGENCIES.NAGENCY, AGENCIES.NOFFICEAGEN, AGENCIES.NBRAN_OFF FROM AGENCIES... WHERE AGENCIES.NAGENCY = H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal.Agency )")
                isFoundData = False
                       With New DataManagerFactory("SELECT AGENCIES.NAGENCY, AGENCIES.NOFFICEAGEN, AGENCIES.NBRAN_OFF FROM AGENCIES AGENCIES  WHERE AGENCIES.NAGENCY = @:AGENCIESNAGENCY0", "AGENCIES", "Linked.LatCombined")
.AddParameter("AGENCIESNAGENCY0", DbType.Int32, 5, False, H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal.Agency)
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                With selectDataTableItem
                        If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                            isFoundData = True
                                      If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal) Then
              H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal = New InMotionGIT.Policy.Entity.Contracts.Policy
          End If 
                                                    H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal.Agency = .Rows(0).NumericValue("NAGENCY") 
                        H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal.OfficeCode = .Rows(0).NumericValue("NOFFICEAGEN") 
                        H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal.BranchOffice = .Rows(0).NumericValue("NBRAN_OFF") 

                        End If
                End With

                                End If
            currentAction = SessionTrace("31. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal...")
            currentAction = SessionTrace("31.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal...")
                            If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                            If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = New InMotionGIT.Policy.Entity.Contracts.Policy
                End If

            H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal

            currentAction = SessionTrace("32. If H5CotizacionesTodosLosRamosIconosParametersInstance.IsProducer = true Then")
            If H5CotizacionesTodosLosRamosIconosParametersInstance.IsProducer = true Then

                currentAction = SessionTrace("33. zone12CTLR.Visible = false, zone10AgenteCTLR.Visible = true, ClientID.Visible = false...")
                currentAction = SessionTrace("33.1. zone12CTLR.Visible = false...")
                resultData.AddControlBehavior("zone12CTLR", "hide")
                currentAction = SessionTrace("33.2. zone10AgenteCTLR.Visible = true...")
                resultData.AddControlBehavior("zone10AgenteCTLR", "show")
                currentAction = SessionTrace("33.3. ClientID.Visible = false...")
                resultData.AddControlBehavior("ClientID", "hide")
                currentAction = SessionTrace("33.4. CompleteClientNameCTLR.Visible = false...")
                resultData.AddControlBehavior("CompleteClientNameCTLR", "hide")

                currentAction = SessionTrace("34. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = True...")
                currentAction = SessionTrace("34.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = True...")
                                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
                End If
                                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client = New InMotionGIT.Client.Entity.Contracts.Client
                End If

                H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryInsured.Client.IsNew = True

                currentAction = SessionTrace("35. If (H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerCode Is Null Or Empty  OR H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerCode = 0) Then")
                If (IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerCode) OrElse H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerCode = 0) Then

                    currentAction = SessionTrace("36. The message 'Usted no está autori...' will displayed as 'Popup'")
                    ParametersToDictionary(H5CotizacionesTodosLosRamosIconosParametersInstance, parametersDictionary)
                    messageAction = "Usted no está autorizado a utilizar esta transacción. Está dirigida a intermediarios de la empresa de seguros..."
                    messageAction = InMotionGIT.FrontOffice.Proxy.Helpers.Email.Process(messageAction, parametersDictionary)
                    resultData.AddNotifyPopup(messageAction)
                                            Else
                    currentAction = SessionTrace("37. H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeBO = 9998...")
                    currentAction = SessionTrace("37.1. H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeBO = 9998...")

                    H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeBO = 9998

currentAction = SessionTrace("38. Call 'Búsqueda de toda la información de un intermedario' library")
                Dim _Producer_17772dd20e0c4e76a60f6db006987fe9 As InMotionGIT.Intermedia.Entity.Contracts.Producer 
                _Producer_17772dd20e0c4e76a60f6db006987fe9 = InMotionGIT.Intermedia.Proxy.Manager.Retrieve(producerCode:=H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerCode, atDate:=Date.Today, withLookupInformation:=True, childFilter:="All", accessToken:="String.Empty", provider:="CORE", companyID:=0) 
 
                isNullResult = (IsNothing(_Producer_17772dd20e0c4e76a60f6db006987fe9)) 
                If Not isNullResult Then
                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer = New InMotionGIT.Policy.Entity.Contracts.Role
                End If
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer.Producer = _Producer_17772dd20e0c4e76a60f6db006987fe9
                End If

                    currentAction = SessionTrace("39. H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerClientID = H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryPr...")
                    currentAction = SessionTrace("39.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerClientID = H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryPr...")

                    H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerClientID = H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer.Producer.ClientID

currentAction = SessionTrace("40. Call 'Búsqueda de toda la información de un cliente' library")
                Dim _Client_482408e4d8844c6eb902d87d0d484e25 As InMotionGIT.Client.Entity.Contracts.Client 
                _Client_482408e4d8844c6eb902d87d0d484e25 = (New InMotionGIT.Client.Proxy.Manager).Retrieve(clientId:=H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerClientID, atDate:=Date.Today, withLookupInformation:=false, childFilter:="All", accessToken:="String.Empty", provider:="CORE", companyID:=0) 
 
                isNullResult = (IsNothing(_Client_482408e4d8844c6eb902d87d0d484e25)) 
                If Not isNullResult Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.ClientProducer = _Client_482408e4d8844c6eb902d87d0d484e25
                End If

                    currentAction = SessionTrace("41. 'H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal' = New 'InMotionGIT.Policy.Entity'...'")
                    H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal = New InMotionGIT.Policy.Entity.Contracts.Policy

                    currentAction = SessionTrace("42. SELECT AGENCIES.NAGENCY, AGENCIES.NOFFICEAGEN, AGENCIES.NBRAN_OFF FROM AGENCIES... WHERE AGENCIES.NAGENCY = 999 )")
                    isFoundData = False
                           With New DataManagerFactory("SELECT AGENCIES.NAGENCY, AGENCIES.NOFFICEAGEN, AGENCIES.NBRAN_OFF FROM AGENCIES AGENCIES  WHERE AGENCIES.NAGENCY = 999", "AGENCIES", "Linked.LatCombined")
 
            selectDataTableItem = .QueryExecuteToTable(True)  
        End With
                    With selectDataTableItem
                            If Not IsNothing(.Rows) AndAlso .Rows.Count > 0 Then
                                isFoundData = True
                                          If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal) Then
              H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal = New InMotionGIT.Policy.Entity.Contracts.Policy
          End If 
                                                        H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal.Agency = .Rows(0).NumericValue("NAGENCY") 
                        H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal.OfficeCode = .Rows(0).NumericValue("NOFFICEAGEN") 
                        H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal.BranchOffice = .Rows(0).NumericValue("NBRAN_OFF") 

                            End If
                    End With

                    currentAction = SessionTrace("43. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal...")
                    currentAction = SessionTrace("43.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = New InMotionGIT.Policy.Entity.Contracts.Policy
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.Policy = H5CotizacionesTodosLosRamosIconosParametersInstance.PolicyLocal
                    currentAction = SessionTrace("43.2. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer.Client = H5CotizacionesTodosLosRamosIconosParametersInstance.ClientProducer...")
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer = New InMotionGIT.Policy.Entity.Contracts.Role
                End If
                                    If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer.Client) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer.Client = New InMotionGIT.Client.Entity.Contracts.Client
                End If

                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer.Client = H5CotizacionesTodosLosRamosIconosParametersInstance.ClientProducer

                                                End If
                                            Else
                currentAction = SessionTrace("44. 'H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer' = New 'InMotionGIT.Policy.Entity'...'")
                H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer = New InMotionGIT.Policy.Entity.Contracts.Role

                currentAction = SessionTrace("45. 'H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer.Client' = New 'InMotionGIT.Client.Entity'...'")
                H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer.Client = New InMotionGIT.Client.Entity.Contracts.Client

                currentAction = SessionTrace("46. 'H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer.Producer' = New 'InMotionGIT.Intermedia.En'...'")
                H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.PrimaryProducer.Producer = New InMotionGIT.Intermedia.Entity.Contracts.Producer

                currentAction = SessionTrace("47. H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerClientID = Nothing...")
                currentAction = SessionTrace("47.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerClientID = Nothing...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.ProducerClientID = Nothing

                                                End If
            currentAction = SessionTrace("48. If H5CotizacionesTodosLosRamosIconosParametersInstance.IsAnonymous = true Then")
            If H5CotizacionesTodosLosRamosIconosParametersInstance.IsAnonymous = true Then

                currentAction = SessionTrace("49. zone12CTLR.Visible = false, zone10AgenteCTLR.Visible = false, ClientID.Visible = false...")
                currentAction = SessionTrace("49.1. zone12CTLR.Visible = false...")
                resultData.AddControlBehavior("zone12CTLR", "hide")
                currentAction = SessionTrace("49.2. zone10AgenteCTLR.Visible = false...")
                resultData.AddControlBehavior("zone10AgenteCTLR", "hide")
                currentAction = SessionTrace("49.3. ClientID.Visible = false...")
                resultData.AddControlBehavior("ClientID", "hide")
                currentAction = SessionTrace("49.4. CompleteClientNameCTLR.Visible = false...")
                resultData.AddControlBehavior("CompleteClientNameCTLR", "hide")

                currentAction = SessionTrace("50. H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeBO = 9998...")
                currentAction = SessionTrace("50.1. H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeBO = 9998...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeBO = 9998
                currentAction = SessionTrace("50.2. H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeFASI = 9998...")

                H5CotizacionesTodosLosRamosIconosParametersInstance.UsercodeFASI = 9998

                                                    End If
            currentAction = SessionTrace("51. H5CotizacionesTodosLosRamosIconosParametersInstance.FormaContactenos = '#setting.Url.WebApplication#' & '/...")
            currentAction = SessionTrace("51.1. H5CotizacionesTodosLosRamosIconosParametersInstance.FormaContactenos = '#setting.Url.WebApplication#' & '/...")

            H5CotizacionesTodosLosRamosIconosParametersInstance.FormaContactenos = "#setting.Url.WebApplication#" & "/generated/form/ContactoMailTelefonoEnWidget.aspx"

            currentAction = SessionTrace("52. H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = '/images/iconramos/2.png'...")
            currentAction = SessionTrace("52.1. H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = '/images/iconramos/2.png'...")

            H5CotizacionesTodosLosRamosIconosParametersInstance.ImagenSeleccionada = "/images/iconramos/2.png"

            currentAction = SessionTrace("53. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 2...")
            currentAction = SessionTrace("53.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 2...")
                            If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

            H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.LineOfBusiness = 2

            currentAction = SessionTrace("54. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 6664...")
            currentAction = SessionTrace("54.1. H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 6664...")
                            If IsNothing(H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation) Then
                    H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
                End If

            H5CotizacionesTodosLosRamosIconosParametersInstance.RiskInformation.ProductCode = 6664

            currentAction = SessionTrace("55. H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 2...")
            currentAction = SessionTrace("55.1. H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 2...")

            H5CotizacionesTodosLosRamosIconosParametersInstance.PlanType = 2

            currentAction = SessionTrace("56. image9.Visible = true, btnCotizarFinal.Visible = true")
            currentAction = SessionTrace("56.1. image9.Visible = true...")
            resultData.AddControlBehavior("image9", "show")
            currentAction = SessionTrace("56.2. btnCotizarFinal.Visible = true...")
            resultData.AddControlBehavior("btnCotizarFinal", "show")


            
        End Sub

#End Region
#Region "Utilities"

        Private Shared Sub ParametersToDictionary(formData As H5CotizacionesTodosLosRamosIconosParameters, ByRef target As Dictionary(Of String, Object))
            If IsNothing(target) Then
                target = New Dictionary(Of String, Object)

                target.Add("RiskInformation", formData.RiskInformation)
                target.Add("LifeProductSelected", formData.LifeProductSelected)
                target.Add("UserIsClient", formData.UserIsClient)
                target.Add("IsProducer", formData.IsProducer)
                target.Add("StatusRun", formData.StatusRun)
                target.Add("IsEmployee", formData.IsEmployee)
                target.Add("IsAnonymous", formData.IsAnonymous)
                target.Add("ProductMaster", formData.ProductMaster)
                target.Add("PlanType", formData.PlanType)
                target.Add("Currency", formData.Currency)
                target.Add("Client", formData.Client)
                target.Add("IsClient", formData.IsClient)
                target.Add("ProducerClientID", formData.ProducerClientID)
                target.Add("ProducerCode", formData.ProducerCode)
                target.Add("PaymentMethod", formData.PaymentMethod)
                target.Add("ProductMasterDescription", formData.ProductMasterDescription)
                target.Add("InvestmentFundRelatedToProductCollection", formData.InvestmentFundRelatedToProductCollection)
                target.Add("ClienteConectado", formData.ClienteConectado)
                target.Add("UsercodeBO", formData.UsercodeBO)
                target.Add("UsercodeFASI", formData.UsercodeFASI)
                target.Add("PolicyLocal", formData.PolicyLocal)
                target.Add("ImagenSeleccionada", formData.ImagenSeleccionada)
                target.Add("Name", formData.Name)
                target.Add("eMail", formData.eMail)
                target.Add("eMailConfirm", formData.eMailConfirm)
                target.Add("MessageText", formData.MessageText)
                target.Add("PhoneNumber", formData.PhoneNumber)
                target.Add("FormaContactenos", formData.FormaContactenos)
                target.Add("ClienteProductor", formData.ClienteProductor)
                target.Add("ClientExistInDB", formData.ClientExistInDB)
                target.Add("ClientProducer", formData.ClientProducer)
            Else
                target("RiskInformation") = formData.RiskInformation
                target("LifeProductSelected") = formData.LifeProductSelected
                target("UserIsClient") = formData.UserIsClient
                target("IsProducer") = formData.IsProducer
                target("StatusRun") = formData.StatusRun
                target("IsEmployee") = formData.IsEmployee
                target("IsAnonymous") = formData.IsAnonymous
                target("ProductMaster") = formData.ProductMaster
                target("PlanType") = formData.PlanType
                target("Currency") = formData.Currency
                target("Client") = formData.Client
                target("IsClient") = formData.IsClient
                target("ProducerClientID") = formData.ProducerClientID
                target("ProducerCode") = formData.ProducerCode
                target("PaymentMethod") = formData.PaymentMethod
                target("ProductMasterDescription") = formData.ProductMasterDescription
                target("InvestmentFundRelatedToProductCollection") = formData.InvestmentFundRelatedToProductCollection
                target("ClienteConectado") = formData.ClienteConectado
                target("UsercodeBO") = formData.UsercodeBO
                target("UsercodeFASI") = formData.UsercodeFASI
                target("PolicyLocal") = formData.PolicyLocal
                target("ImagenSeleccionada") = formData.ImagenSeleccionada
                target("Name") = formData.Name
                target("eMail") = formData.eMail
                target("eMailConfirm") = formData.eMailConfirm
                target("MessageText") = formData.MessageText
                target("PhoneNumber") = formData.PhoneNumber
                target("FormaContactenos") = formData.FormaContactenos
                target("ClienteProductor") = formData.ClienteProductor
                target("ClientExistInDB") = formData.ClientExistInDB
                target("ClientProducer") = formData.ClientProducer
            End If
        End Sub

        Private Shared Sub GetTransferParameters(parametersData As H5CotizacionesTodosLosRamosIconosParameters, fromid As String)
            Dim fromDocumentCache As Object = Nothing

            If Not String.IsNullOrEmpty(fromid) Then
                fromDocumentCache = HttpContext.Current.Session(fromid)
                HttpContext.Current.Session.Remove(fromid)

            Else
                fromDocumentCache = HttpContext.Current.Session(HttpContext.Current.Session("fromid"))
                HttpContext.Current.Session.Remove(HttpContext.Current.Session("fromid"))
                HttpContext.Current.Session.Remove("fromid")
            End If

            If Not IsNothing(fromDocumentCache) Then
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("RiskInformation", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("LifeProductSelected", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("UserIsClient", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("IsProducer", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("StatusRun", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("IsEmployee", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("IsAnonymous", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ProductMaster", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PlanType", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Currency", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Client", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("IsClient", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ProducerClientID", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ProducerCode", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PaymentMethod", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ProductMasterDescription", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("InvestmentFundRelatedToProductCollection", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ClienteConectado", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("UsercodeBO", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("UsercodeFASI", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PolicyLocal", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ImagenSeleccionada", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("Name", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("eMail", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("eMailConfirm", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("MessageText", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("PhoneNumber", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("FormaContactenos", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ClienteProductor", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ClientExistInDB", fromDocumentCache, parametersData)
                InMotionGIT.FrontOffice.Support.Helpers.ReflectionHandler.AssignPropertyValue("ClientProducer", fromDocumentCache, parametersData)
            End If
        End Sub

        Private Shared Function SessionTrace(message As String) As String

            If Not IsNothing(HttpContext.Current.Session("Form.Track")) AndAlso HttpContext.Current.Session("Form.Track").ToString.ToLower = "true" Then
                Dim tracelog As String = HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath")))

                tracelog += String.Format(CultureInfo.InvariantCulture, "{0} {1}<br>{2}", Now.ToString("hh:mm:ss.fff"), message, vbCrLf)
                HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath"))) = tracelog
            End If

            Return message
        End Function

#End Region
#Region "Storage Session Methods"

        Private Shared Function RetrieveFormInformationFromSession(id As String) As H5CotizacionesTodosLosRamosIconosParameters
            
            Dim source As String = HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.Storage.{0}", id))
            Dim instance As H5CotizacionesTodosLosRamosIconosParameters = Nothing

            If Not String.IsNullOrEmpty(source) Then
                instance = Serialize.Deserialize(Of H5CotizacionesTodosLosRamosIconosParameters)(source)
            End If
            
            Return instance
        End Function

        Private Shared Sub StoreFormInformationOnSession(instance As H5CotizacionesTodosLosRamosIconosParameters)
            
            If Not IsNothing(instance) Then
                HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.Storage.{0}", instance.InternalId)) = Serialize.Serialize(Of H5CotizacionesTodosLosRamosIconosParameters)(instance)
                HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.Title.{0}", instance.InternalId)) = ""
              
                If Not IsNothing(HttpContext.Current.Session("Form.Track")) AndAlso
                   HttpContext.Current.Session("Form.Track").ToString.ToLower = "true" Then

                    HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture, "Form.H5CotizacionesTodosLosRamosIconos", instance.InternalId)) = instance
                End If

                If Not IsNothing(HttpContext.Current.Session("Form.Track.Parameters")) AndAlso
                   HttpContext.Current.Session("Form.Track.Parameters").ToString.ToLower = "true" Then

                    If Not IsNothing(HttpContext.Current.Session("Form.Track")) AndAlso HttpContext.Current.Session("Form.Track").ToString.ToLower = "true" Then
                        InMotionGIT.Common.Helpers.FileHandler.SaveContent(String.Format(CultureInfo.InvariantCulture, "{0}\{1}.H5CotizacionesTodosLosRamosIconos.txt",
                                                                                         ConfigurationManager.AppSettings("Path.Logs"), instance.InternalId),
                                                                                          HttpContext.Current.Session(String.Format(CultureInfo.InvariantCulture,
                                                                                                                     "Form.{0}.trace", IO.Path.GetFileNameWithoutExtension("Page.AppRelativeVirtualPath"))))
                    End If

                    InMotionGIT.Common.Helpers.Serialize.SerializeToFile(Of H5CotizacionesTodosLosRamosIconosParameters)(instance,
                                                                                                String.Format(CultureInfo.InvariantCulture,
                                                                                                              "{0}\{1}.H5CotizacionesTodosLosRamosIconos.xml", ConfigurationManager.AppSettings("Path.Logs"), instance.InternalId), True)
                End If			
            End If
            
        End Sub

#End Region


#Region "Contracts Mappers"

        Private Shared Function EntryDataToClass(parametersData As H5CotizacionesTodosLosRamosIconosParameters, formData As EntryData) As H5CotizacionesTodosLosRamosIconosParameters
            If IsNothing(parametersData) Then
                parametersData = New H5CotizacionesTodosLosRamosIconosParameters
            End If

            If IsNothing(parametersData.RiskInformation) Then
                parametersData.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
            End If
            If IsNothing(parametersData.RiskInformation.PrimaryInsured) Then
                parametersData.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
            End If
            If IsNothing(parametersData.RiskInformation.PrimaryInsured.Client) Then
                parametersData.RiskInformation.PrimaryInsured.Client = New InMotionGIT.Client.Entity.Contracts.Client
            End If

            With parametersData
                .InternalId = formData.InstanceFormId
                .RiskInformation.PrimaryInsured.Client.ClientID = formData.RiskInformationPrimaryInsuredClientClientID
                .ClienteProductor = formData.ClienteProductor
                .ImagenSeleccionada = formData.ImagenSeleccionada
            End With

            Return parametersData
        End Function

        Private Shared Function ClassToEntryData(formData As EntryData, parametersData As H5CotizacionesTodosLosRamosIconosParameters) As EntryData
            formData = New EntryData

            With formData
                .InstanceFormId = parametersData.InternalId
                If Not IsNothing(parametersData.RiskInformation) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured.Client) Then
                    .RiskInformationPrimaryInsuredClientCompleteClientName = parametersData.RiskInformation.PrimaryInsured.Client.CompleteClientName
                End If
                If Not IsNothing(parametersData.RiskInformation) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured) AndAlso Not IsNothing(parametersData.RiskInformation.PrimaryInsured.Client) Then
                    .RiskInformationPrimaryInsuredClientClientID = parametersData.RiskInformation.PrimaryInsured.Client.ClientID
                End If
                .ClienteProductor = parametersData.ClienteProductor
                .ImagenSeleccionada = parametersData.ImagenSeleccionada
            End With

            Return formData
        End Function

#End Region

#Region "Common Utilities"

        Private Shared Sub SetDefaultValuesFromQueryString(formData As H5CotizacionesTodosLosRamosIconosParameters)
            If HttpContext.Current.Request.QueryString("LifeProductSelected").IsNotEmpty Then
                formData.LifeProductSelected = HttpContext.Current.Request.QueryString("LifeProductSelected")
            End If
            If HttpContext.Current.Request.QueryString("UserIsClient").IsNotEmpty Then
                formData.UserIsClient = HttpContext.Current.Request.QueryString("UserIsClient")
            End If
            If HttpContext.Current.Request.QueryString("IsProducer").IsNotEmpty Then
                formData.IsProducer = HttpContext.Current.Request.QueryString("IsProducer")
            End If
            If HttpContext.Current.Request.QueryString("StatusRun").IsNotEmpty Then
                formData.StatusRun = HttpContext.Current.Request.QueryString("StatusRun")
            End If
            If HttpContext.Current.Request.QueryString("IsEmployee").IsNotEmpty Then
                formData.IsEmployee = HttpContext.Current.Request.QueryString("IsEmployee")
            End If
            If HttpContext.Current.Request.QueryString("IsAnonymous").IsNotEmpty Then
                formData.IsAnonymous = HttpContext.Current.Request.QueryString("IsAnonymous")
            End If
            If HttpContext.Current.Request.QueryString("PlanType").IsNotEmpty Then
                formData.PlanType = HttpContext.Current.Request.QueryString("PlanType")
            End If
            If HttpContext.Current.Request.QueryString("Currency").IsNotEmpty Then
                formData.Currency = HttpContext.Current.Request.QueryString("Currency")
            End If
            If HttpContext.Current.Request.QueryString("IsClient").IsNotEmpty Then
                formData.IsClient = HttpContext.Current.Request.QueryString("IsClient")
            End If
            If HttpContext.Current.Request.QueryString("ProducerClientID").IsNotEmpty Then
                formData.ProducerClientID = HttpContext.Current.Request.QueryString("ProducerClientID")
            End If
            If HttpContext.Current.Request.QueryString("ProducerCode").IsNotEmpty Then
                formData.ProducerCode = HttpContext.Current.Request.QueryString("ProducerCode")
            End If
            If HttpContext.Current.Request.QueryString("PaymentMethod").IsNotEmpty Then
                formData.PaymentMethod = HttpContext.Current.Request.QueryString("PaymentMethod")
            End If
            If HttpContext.Current.Request.QueryString("ProductMasterDescription").IsNotEmpty Then
                formData.ProductMasterDescription = HttpContext.Current.Request.QueryString("ProductMasterDescription")
            End If
            If HttpContext.Current.Request.QueryString("ClienteConectado").IsNotEmpty Then
                formData.ClienteConectado = HttpContext.Current.Request.QueryString("ClienteConectado")
            End If
            If HttpContext.Current.Request.QueryString("UsercodeBO").IsNotEmpty Then
                formData.UsercodeBO = HttpContext.Current.Request.QueryString("UsercodeBO")
            End If
            If HttpContext.Current.Request.QueryString("UsercodeFASI").IsNotEmpty Then
                formData.UsercodeFASI = HttpContext.Current.Request.QueryString("UsercodeFASI")
            End If
            If HttpContext.Current.Request.QueryString("ImagenSeleccionada").IsNotEmpty Then
                formData.ImagenSeleccionada = HttpContext.Current.Request.QueryString("ImagenSeleccionada")
            End If
            If HttpContext.Current.Request.QueryString("Name").IsNotEmpty Then
                formData.Name = HttpContext.Current.Request.QueryString("Name")
            End If
            If HttpContext.Current.Request.QueryString("eMail").IsNotEmpty Then
                formData.eMail = HttpContext.Current.Request.QueryString("eMail")
            End If
            If HttpContext.Current.Request.QueryString("eMailConfirm").IsNotEmpty Then
                formData.eMailConfirm = HttpContext.Current.Request.QueryString("eMailConfirm")
            End If
            If HttpContext.Current.Request.QueryString("MessageText").IsNotEmpty Then
                formData.MessageText = HttpContext.Current.Request.QueryString("MessageText")
            End If
            If HttpContext.Current.Request.QueryString("PhoneNumber").IsNotEmpty Then
                formData.PhoneNumber = HttpContext.Current.Request.QueryString("PhoneNumber")
            End If
            If HttpContext.Current.Request.QueryString("FormaContactenos").IsNotEmpty Then
                formData.FormaContactenos = HttpContext.Current.Request.QueryString("FormaContactenos")
            End If
            If HttpContext.Current.Request.QueryString("ClienteProductor").IsNotEmpty Then
                formData.ClienteProductor = HttpContext.Current.Request.QueryString("ClienteProductor")
            End If
            If HttpContext.Current.Request.QueryString("ClientExistInDB").IsNotEmpty Then
                formData.ClientExistInDB = HttpContext.Current.Request.QueryString("ClientExistInDB")
            End If
        End Sub	

        Private Shared Sub ValidateParametersInstance(ByRef formData As H5CotizacionesTodosLosRamosIconosParameters)
            If IsNothing(formData.RiskInformation) Then
                formData.RiskInformation = New InMotionGIT.Policy.Entity.Contracts.RiskInformation
            End If
            If IsNothing(formData.RiskInformation.PrimaryInsured) Then
                formData.RiskInformation.PrimaryInsured = New InMotionGIT.Policy.Entity.Contracts.Role
            End If
            If IsNothing(formData.RiskInformation.PrimaryInsured.Client) Then
                formData.RiskInformation.PrimaryInsured.Client = New InMotionGIT.Client.Entity.Contracts.Client
            End If

        End Sub

#End Region

#Region "Form Contracts"

        <Serializable()>
        <DataContract()>
        Public Class EntryData

            <DataMember()> Public Property InstanceFormId As String
            <DataMember()> Public Property RiskInformationPrimaryInsuredClientCompleteClientName As System.String
            <DataMember()> Public Property RiskInformationPrimaryInsuredClientClientID As System.String
            <DataMember()> Public Property ClienteProductor As String
            <DataMember()> Public Property ImagenSeleccionada As String

        End Class

        <Serializable()>
        Public Class H5CotizacionesTodosLosRamosIconosParameters
            Inherits InMotionGIT.FrontOffice.Support.DataType.FormBase(Of H5CotizacionesTodosLosRamosIconosParameters)

            Public Property RiskInformation As InMotionGIT.Policy.Entity.Contracts.RiskInformation
            Public Property LifeProductSelected As Int32
            Public Property UserIsClient As Boolean
            Public Property IsProducer As Boolean
            Public Property StatusRun As Boolean
            Public Property IsEmployee As Boolean
            Public Property IsAnonymous As Boolean
            Public Property ProductMaster As InMotionGIT.Product.Entity.Contracts.ProductMaster
            Public Property PlanType As Int32
            Public Property Currency As Int32
            Public Property Client As InMotionGIT.Client.Entity.Contracts.Client
            Public Property IsClient As Boolean
            Public Property ProducerClientID As String
            Public Property ProducerCode As Int32
            Public Property PaymentMethod As Int32
            Public Property ProductMasterDescription As String
            Public Property InvestmentFundRelatedToProductCollection As InMotionGIT.Product.Entity.Contracts.InvestmentFundRelatedToProductCollection
            Public Property ClienteConectado As String
            Public Property UsercodeBO As Int32
            Public Property UsercodeFASI As Int32
            Public Property PolicyLocal As InMotionGIT.Policy.Entity.Contracts.Policy
            Public Property ImagenSeleccionada As String
            Public Property Name As String
            Public Property eMail As String
            Public Property eMailConfirm As String
            Public Property MessageText As String
            Public Property PhoneNumber As String
            Public Property FormaContactenos As String
            Public Property ClienteProductor As String
            Public Property ClientExistInDB As Boolean
            Public Property ClientProducer As InMotionGIT.Client.Entity.Contracts.Client

        End Class
#End Region

    End Class

End Namespace

