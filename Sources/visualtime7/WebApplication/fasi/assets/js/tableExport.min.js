/**
 * @preserve tableExport.jquery.plugin
 *
 * Version 1.10.16
 *
 * Copyright (c) 2015-2020 hhurz, https://github.com/hhurz/tableExport.jquery.plugin
 *
 * Based on https://github.com/kayalshri/tableExport.jquery.plugin
 *
 * Licensed under the MIT License
 **/
"use strict"; !function (Te) { Te.fn.tableExport = function (e) { var l, t, n, o, r, T = { csvEnclosure: '"', csvSeparator: ",", csvUseBOM: !0, date: { html: "dd/mm/yyyy" }, displayTableName: !1, escape: !1, exportHiddenCells: !1, fileName: "tableExport", htmlContent: !1, htmlHyperlink: "content", ignoreColumn: [], ignoreRow: [], jsonScope: "all", jspdf: { orientation: "p", unit: "pt", format: "a4", margins: { left: 20, right: 10, top: 10, bottom: 10 }, split: 10, onDocCreated: null, autotable: { styles: { cellPadding: 2, rowHeight: 12, fontSize: 8, fillColor: 255, textColor: 50, fontStyle: "normal", overflow: "ellipsize", halign: "inherit", valign: "middle" }, headerStyles: { fillColor: [52, 73, 94], textColor: 255, fontStyle: "bold", halign: "inherit", valign: "middle" }, alternateRowStyles: { fillColor: 245 }, tableExport: { doc: null, onAfterAutotable: null, onBeforeAutotable: null, onAutotableText: null, onTable: null, outputImages: !0 } } }, mso: { fileFormat: "xlshtml", onMsoNumberFormat: null, pageFormat: "a4", pageOrientation: "portrait", rtl: !1, styles: [], worksheetName: "", xslx: { formatId: { date: 14, numbers: 2 } } }, numbers: { html: { decimalMark: ".", thousandsSeparator: "," }, output: { decimalMark: ".", thousandsSeparator: "," } }, onAfterSaveToFile: null, onBeforeSaveToFile: null, onCellData: null, onCellHtmlData: null, onCellHtmlHyperlink: null, onIgnoreRow: null, onTableExportBegin: null, onTableExportEnd: null, outputMode: "file", pdfmake: { enabled: !1, docDefinition: { pageOrientation: "portrait", defaultStyle: { font: "Roboto" } }, fonts: {} }, preserve: { leadingWS: !1, trailingWS: !1 }, preventInjection: !0, sql: { tableEnclosure: "`", columnEnclosure: "`" }, tbodySelector: "tr", tfootSelector: "tr", theadSelector: "tr", tableName: "Table", type: "csv" }, a = { a0: [2383.94, 3370.39], a1: [1683.78, 2383.94], a2: [1190.55, 1683.78], a3: [841.89, 1190.55], a4: [595.28, 841.89], a5: [419.53, 595.28], a6: [297.64, 419.53], a7: [209.76, 297.64], a8: [147.4, 209.76], a9: [104.88, 147.4], a10: [73.7, 104.88], b0: [2834.65, 4008.19], b1: [2004.09, 2834.65], b2: [1417.32, 2004.09], b3: [1000.63, 1417.32], b4: [708.66, 1000.63], b5: [498.9, 708.66], b6: [354.33, 498.9], b7: [249.45, 354.33], b8: [175.75, 249.45], b9: [124.72, 175.75], b10: [87.87, 124.72], c0: [2599.37, 3676.54], c1: [1836.85, 2599.37], c2: [1298.27, 1836.85], c3: [918.43, 1298.27], c4: [649.13, 918.43], c5: [459.21, 649.13], c6: [323.15, 459.21], c7: [229.61, 323.15], c8: [161.57, 229.61], c9: [113.39, 161.57], c10: [79.37, 113.39], dl: [311.81, 623.62], letter: [612, 792], "government-letter": [576, 756], legal: [612, 1008], "junior-legal": [576, 360], ledger: [1224, 792], tabloid: [792, 1224], "credit-card": [153, 243] }, i = this, s = null, c = [], u = [], I = 0, f = "", d = [], m = [], p = [], h = !1; if (Te.extend(!0, T, e), "xlsx" === T.type && (T.mso.fileFormat = T.type, T.type = "excel"), void 0 !== T.excelFileFormat && "undefined" === T.mso.fileFormat && (T.mso.fileFormat = T.excelFileFormat), void 0 !== T.excelPageFormat && "undefined" === T.mso.pageFormat && (T.mso.pageFormat = T.excelPageFormat), void 0 !== T.excelPageOrientation && "undefined" === T.mso.pageOrientation && (T.mso.pageOrientation = T.excelPageOrientation), void 0 !== T.excelRTL && "undefined" === T.mso.rtl && (T.mso.rtl = T.excelRTL), void 0 !== T.excelstyles && "undefined" === T.mso.styles && (T.mso.styles = T.excelstyles), void 0 !== T.onMsoNumberFormat && "undefined" === T.mso.onMsoNumberFormat && (T.mso.onMsoNumberFormat = T.onMsoNumberFormat), void 0 !== T.worksheetName && "undefined" === T.mso.worksheetName && (T.mso.worksheetName = T.worksheetName), T.mso.pageOrientation = "l" === T.mso.pageOrientation.substr(0, 1) ? "landscape" : "portrait", T.date.html = T.date.html || "", T.date.html.length && ((t = []).dd = "(3[01]|[12][0-9]|0?[1-9])", t.mm = "(1[012]|0?[1-9])", t.yyyy = "((?:1[6-9]|2[0-2])\\d{2})", t.yy = "(\\d{2})", n = T.date.html.match(/[^a-zA-Z0-9]/)[0], o = T.date.html.toLowerCase().split(n), T.date.regex = "^\\s*", T.date.regex += t[o[0]], T.date.regex += "(.)", T.date.regex += t[o[1]], T.date.regex += "\\2", T.date.regex += t[o[2]], T.date.regex += "\\s*$", T.date.pattern = new RegExp(T.date.regex, "g"), r = o.indexOf("dd") + 1, T.date.match_d = r + (1 < r ? 1 : 0), r = o.indexOf("mm") + 1, T.date.match_m = r + (1 < r ? 1 : 0), r = (0 <= o.indexOf("yyyy") ? o.indexOf("yyyy") : o.indexOf("yy")) + 1, T.date.match_y = r + (1 < r ? 1 : 0)), d = ue(i), "function" == typeof T.onTableExportBegin && T.onTableExportBegin(), "csv" === T.type || "tsv" === T.type || "txt" === T.type) { var g = "", b = 0, m = [], I = 0, v = function (e, t, n) { return e.each(function () { f = "", me(this, t, I, n + e.length, function (e, t, n) { var o, r, a, i, l, s; f += (r = t, a = n, s = "", null !== (o = e) && (l = null === (i = ye(o, r, a)) || "" === i ? "" : i.toString(), "tsv" === T.type ? (i instanceof Date && i.toLocaleString(), s = pe(l, "\t", " ")) : i instanceof Date ? s = T.csvEnclosure + i.toLocaleString() + T.csvEnclosure : (0 <= (s = pe(s = xe(l), T.csvEnclosure, T.csvEnclosure + T.csvEnclosure)).indexOf(T.csvSeparator) || /[\r\n ]/g.test(s)) && (s = T.csvEnclosure + s + T.csvEnclosure)), s + ("tsv" === T.type ? "\t" : T.csvSeparator)) }), 0 < (f = Te.trim(f).substring(0, f.length - 1)).length && (0 < g.length && (g += "\n"), g += f), I++ }), e.length }; if (b += v(Te(i).find("thead").first().find(T.theadSelector), "th,td", b), ce(Te(i), "tbody").each(function () { b += v(ce(Te(this), T.tbodySelector), "td,th", b) }), T.tfootSelector.length && v(Te(i).find("tfoot").first().find(T.tfootSelector), "td,th", b), g += "\n", "string" === T.outputMode) return g; if ("base64" === T.outputMode) return Ae(g); if ("window" === T.outputMode) return void Fe(!1, "data:text/" + ("csv" === T.type ? "csv" : "plain") + ";charset=utf-8,", g); Ee("\ufeff" + g, T.fileName + "." + T.type, "text/" + ("csv" === T.type ? "csv" : "plain"), "utf-8", "", "csv" === T.type && T.csvUseBOM) } else if ("sql" === T.type) { I = 0, m = []; var y = "INSERT INTO " + T.sql.tableEnclosure + T.tableName + T.sql.tableEnclosure + " (", c = le(Te(i)); if (Te(c).each(function () { me(this, "th,td", I, c.length, function (e, t, n) { var o = ye(e, t, n) || ""; -1 < o.indexOf(T.sql.columnEnclosure) && (o = pe(o.toString(), T.sql.columnEnclosure, T.sql.columnEnclosure + T.sql.columnEnclosure)), y += T.sql.columnEnclosure + o + T.sql.columnEnclosure + "," }), I++, y = Te.trim(y).substring(0, y.length - 1) }), y += ") VALUES ", u = se(Te(i)), Te(u).each(function () { f = "", me(this, "td,th", I, c.length + u.length, function (e, t, n) { var o = ye(e, t, n) || ""; -1 < o.indexOf("'") && (o = pe(o.toString(), "'", "''")), f += "'" + o + "'," }), 3 < f.length && (y += "(" + f, y = Te.trim(y).substring(0, y.length - 1), y += "),"), I++ }), y = Te.trim(y).substring(0, y.length - 1), y += ";", "string" === T.outputMode) return y; if ("base64" === T.outputMode) return Ae(y); Ee(y, T.fileName + ".sql", "application/sql", "utf-8", "", !1) } else if ("json" === T.type) { var x = []; m = [], c = le(Te(i)), Te(c).each(function () { var o = []; me(this, "th,td", I, c.length, function (e, t, n) { o.push(ye(e, t, n)) }), x.push(o) }); var w, S = [], u = se(Te(i)); if (Te(u).each(function () { var o = {}, r = 0; me(this, "td,th", I, c.length + u.length, function (e, t, n) { x.length ? o[x[x.length - 1][r]] = ye(e, t, n) : o[r] = ye(e, t, n), r++ }), !1 === Te.isEmptyObject(o) && S.push(o), I++ }), w = "head" === T.jsonScope ? JSON.stringify(x) : "data" === T.jsonScope ? JSON.stringify(S) : JSON.stringify({ header: x, data: S }), "string" === T.outputMode) return w; if ("base64" === T.outputMode) return Ae(w); Ee(w, T.fileName + ".json", "application/json", "utf-8", "base64", !1) } else if ("xml" === T.type) { I = 0, m = []; var N = '<?xml version="1.0" encoding="utf-8"?>'; N += "<tabledata><fields>", c = le(Te(i)), Te(c).each(function () { me(this, "th,td", I, c.length, function (e, t, n) { N += "<field>" + ye(e, t, n) + "</field>" }), I++ }), N += "</fields><data>"; var R = 1; if (u = se(Te(i)), Te(u).each(function () { var o = 1; f = "", me(this, "td,th", I, c.length + u.length, function (e, t, n) { f += "<column-" + o + ">" + ye(e, t, n) + "</column-" + o + ">", o++ }), 0 < f.length && "<column-1></column-1>" !== f && (N += '<row id="' + R + '">' + f + "</row>", R++), I++ }), N += "</data></tabledata>", "string" === T.outputMode) return N; if ("base64" === T.outputMode) return Ae(N); Ee(N, T.fileName + ".xml", "application/xml", "utf-8", "base64", !1) } else if ("excel" === T.type && "xmlss" === T.mso.fileFormat) { var k = [], C = []; Te(i).filter(function () { return de(Te(this)) }).each(function () { var e = Te(this), t = ""; function n(e, t, n) { var d = []; return Te(e).each(function () { var c = 0, u = 0; f = "", me(this, "td,th", I, n + e.length, function (e, t, n) { var o, r, a, i, l, s; null !== e && (o = "", r = ye(e, t, n), !(a = "String") !== jQuery.isNumeric(r) ? a = "Number" : !1 !== (i = function (e) { -1 < e.indexOf("%") ? !1 !== (e = ve(e.replace(/%/g, ""))) && (e /= 100) : e = !1; return e }(r)) && (r = i, a = "Number", o += ' ss:StyleID="pct1"'), "Number" !== a && (r = r.replace(/\n/g, "<br>")), l = we(e), s = Se(e), Te.each(d, function () { var e = this; if (I >= e.s.r && I <= e.e.r && u >= e.s.c && u <= e.e.c) for (var t = 0; t <= e.e.c - e.s.c; ++t)u++, c++ }), (s || l) && (s = s || 1, l = l || 1, d.push({ s: { r: I, c: u }, e: { r: I + s - 1, c: u + l - 1 } })), 1 < l && (o += ' ss:MergeAcross="' + (l - 1) + '"', u += l - 1), 1 < s && (o += ' ss:MergeDown="' + (s - 1) + '" ss:StyleID="rsp1"'), 0 < c && (o += ' ss:Index="' + (u + 1) + '"', c = 0), f += "<Cell" + o + '><Data ss:Type="' + a + '">' + Te("<div />").text(r).html() + "</Data></Cell>\r", u++) }), 0 < f.length && (q += '<Row ss:AutoFitHeight="0">\r' + f + "</Row>\r"), I++ }), e.length } "string" == typeof T.mso.worksheetName && T.mso.worksheetName.length ? t = T.mso.worksheetName + " " + (C.length + 1) : void 0 !== T.mso.worksheetName[C.length] && (t = T.mso.worksheetName[C.length]), t.length || (t = e.find("caption").text() || ""), t.length || (t = "Table " + (C.length + 1)), t = Te.trim(t.replace(/[\\\/[\]*:?'"]/g, "").substring(0, 31)), C.push(Te("<div />").text(t).html()), !1 === T.exportHiddenCells && (p = e.find("tr, th, td").filter(":hidden"), h = 0 < p.length), I = 0, d = ue(this), q = "<Table>\r"; var o = n(le(e), 0, 0); n(se(e), 0, o), q += "</Table>\r", k.push(q) }); for (var E, F, A = {}, M = {}, O = 0, D = C.length; O < D; O++)F = A[E = C[O]], 2 === (F = A[E] = null == F ? 1 : F + 1) && (C[M[E]] = C[M[E]].substring(0, 29) + "-1"), 1 < A[E] ? C[O] = C[O].substring(0, 29) + "-" + A[E] : M[E] = O; for (var W = '<?xml version="1.0" encoding="UTF-8"?>\r<?mso-application progid="Excel.Sheet"?>\r<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"\r xmlns:o="urn:schemas-microsoft-com:office:office"\r xmlns:x="urn:schemas-microsoft-com:office:excel"\r xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"\r xmlns:html="http://www.w3.org/TR/REC-html40">\r<DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">\r  <Created>' + (new Date).toISOString() + '</Created>\r</DocumentProperties>\r<OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office">\r  <AllowPNG/>\r</OfficeDocumentSettings>\r<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">\r  <WindowHeight>9000</WindowHeight>\r  <WindowWidth>13860</WindowWidth>\r  <WindowTopX>0</WindowTopX>\r  <WindowTopY>0</WindowTopY>\r  <ProtectStructure>False</ProtectStructure>\r  <ProtectWindows>False</ProtectWindows>\r</ExcelWorkbook>\r<Styles>\r  <Style ss:ID="Default" ss:Name="Normal">\r    <Alignment ss:Vertical="Bottom"/>\r    <Borders/>\r    <Font/>\r    <Interior/>\r    <NumberFormat/>\r    <Protection/>\r  </Style>\r  <Style ss:ID="rsp1">\r    <Alignment ss:Vertical="Center"/>\r  </Style>\r  <Style ss:ID="pct1">\r    <NumberFormat ss:Format="Percent"/>\r  </Style>\r</Styles>\r', j = 0; j < k.length; j++)W += '<Worksheet ss:Name="' + C[j] + '" ss:RightToLeft="' + (T.mso.rtl ? "1" : "0") + '">\r' + k[j], T.mso.rtl ? W += '<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">\r<DisplayRightToLeft/>\r</WorksheetOptions>\r' : W += '<WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel"/>\r', W += "</Worksheet>\r"; if (W += "</Workbook>\r", "string" === T.outputMode) return W; if ("base64" === T.outputMode) return Ae(W); Ee(W, T.fileName + ".xml", "application/xml", "utf-8", "base64", !1) } else if ("excel" === T.type && "xlsx" === T.mso.fileFormat) { var L = [], U = XLSX.utils.book_new(); Te(i).filter(function () { return de(Te(this)) }).each(function () { var e = Te(this), t = function (e) { for (var t, n, o, r, a, i, l = {}, s = e.getElementsByTagName("tr"), c = { s: { r: 0, c: 0 }, e: { r: 0, c: 0 } }, u = [], d = 0, f = [], m = 0, p = 0, h = XLSX.SSF.get_table(); m < s.length && p < 1e7; ++m) { var g = s[m], b = !1; if ("function" == typeof T.onIgnoreRow && (b = T.onIgnoreRow(Te(g), m)), !1 === b && -1 === Te.inArray(I, T.ignoreRow) && -1 === Te.inArray(I - R, T.ignoreRow) && de(Te(g))) { var v = g.children, y = 0; for (t = 0; t < v.length; ++t)a = v[t], r = +we(a) || 1, y += r; var x = 0; for (t = n = 0; t < v.length; ++t) { a = v[t], r = +we(a) || 1; var w = t + x; if (!fe(Te(a), y, w + (w < n ? n - w : 0))) { for (x += r - 1, d = 0; d < u.length; ++d) { var S = u[d]; S.s.c == n && S.s.r <= p && p <= S.e.r && (n = S.e.c + 1, d = -1) } (0 < (o = +Se(a)) || 1 < r) && u.push({ s: { r: p, c: n }, e: { r: p + (o || 1) - 1, c: n + r - 1 } }); var N, k, C = { type: "" }, E = ye(a, m, t + x, C), F = { t: "s", v: E }, A = ""; "" !== Te(a).attr("data-tableexport-cellformat") ? (0 === (N = parseInt(Te(a).attr("data-tableexport-xlsxformatid") || 0)) && "function" == typeof T.mso.xslx.formatId.numbers && (N = T.mso.xslx.formatId.numbers(Te(a), m, t + x)), 0 === N && "function" == typeof T.mso.xslx.formatId.date && (N = T.mso.xslx.formatId.date(Te(a), m, t + x)), 49 === N || "@" === N ? A = "s" : "number" === C.type || 0 < N && N < 14 || 36 < N && N < 41 || 48 === N ? A = "n" : ("date" === C.type || 13 < N && N < 37 || 44 < N && N < 48 || 56 === N) && (A = "d")) : A = "s", null != E && (0 === E.length ? F.t = A || "z" : 0 === E.trim().length || "s" === A || ("function" === C.type ? F = { f: E } : "TRUE" === E ? F = { t: "b", v: !0 } : "FALSE" === E ? F = { t: "b", v: !1 } : "" === A && Te(a).find("a").length ? (E = "href" !== T.htmlHyperlink ? E : "", F = { f: '=HYPERLINK("' + Te(a).find("a").attr("href") + (E.length ? '","' + E : "") + '")' }) : "n" === A || isFinite(Ce(E, T.numbers.output)) ? (k = Ce(E, T.numbers.output), 0 === N && "function" != typeof T.mso.xslx.formatId.numbers && (N = T.mso.xslx.formatId.numbers), (isFinite(k) || isFinite(E)) && (F = { t: "n", v: isFinite(k) ? k : E, z: "string" == typeof N ? N : N in h ? h[N] : "0.00" })) : !1 === (i = be(E)) && "d" !== A || (0 === N && "function" != typeof T.mso.xslx.formatId.date && (N = T.mso.xslx.formatId.date), (F = { t: "d", v: !1 !== i ? i : E, z: "string" == typeof N ? N : N in h ? h[N] : "m/d/yy" }).t = "s", F.v = E, F.z = T.date.html.toLowerCase()))), l[Ne({ c: n, r: p })] = F, c.e.c < n && (c.e.c = n), n += r } } ++p } } u.length && (l["!merges"] = u); f.length && (l["!rows"] = f); c.e.r = p - 1, l["!ref"] = ke(c), 1e7 <= p && (l["!fullref"] = ke((c.e.r = s.length - m + p - 1, c))); return l }(this), n = ""; "string" == typeof T.mso.worksheetName && T.mso.worksheetName.length ? n = T.mso.worksheetName + " " + (L.length + 1) : void 0 !== T.mso.worksheetName[L.length] && (n = T.mso.worksheetName[L.length]), n.length || (n = e.find("caption").text() || ""), n.length || (n = "Table " + (L.length + 1)), n = Te.trim(n.replace(/[\\\/[\]*:?'"]/g, "").substring(0, 31)), L.push(n), XLSX.utils.book_append_sheet(U, t, n) }), Ee(function (e) { for (var t = new ArrayBuffer(e.length), n = new Uint8Array(t), o = 0; o !== e.length; ++o)n[o] = 255 & e.charCodeAt(o); return t }(XLSX.write(U, { type: "binary", bookType: T.mso.fileFormat, bookSST: !1 })), T.fileName + "." + T.mso.fileFormat, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "UTF-8", "", !1) } else if ("excel" === T.type || "xls" === T.type || "word" === T.type || "doc" === T.type) { var B = "excel" === T.type || "xls" === T.type ? "excel" : "word", H = "excel" == B ? "xls" : "doc", P = 'xmlns:x="urn:schemas-microsoft-com:office:' + B + '"', q = "", z = ""; Te(i).filter(function () { return de(Te(this)) }).each(function () { var e = Te(this); "" === z && (z = T.mso.worksheetName || e.find("caption").text() || "Table", z = Te.trim(z.replace(/[\\\/[\]*:?'"]/g, "").substring(0, 31))), !1 === T.exportHiddenCells && (p = e.find("tr, th, td").filter(":hidden"), h = 0 < p.length), I = 0, m = [], d = ue(this), q += "<table><thead>", c = le(e), Te(c).each(function () { var u = Te(this); f = "", me(this, "th,td", I, c.length, function (e, t, n) { if (null !== e) { var o = ""; if (f += "<th", T.mso.styles.length) { var r = document.defaultView.getComputedStyle(e, null), a = document.defaultView.getComputedStyle(u[0], null); for (var i in T.mso.styles) { var l = r[T.mso.styles[i]]; "" === l && (l = a[T.mso.styles[i]]), "" !== l && "0px none rgb(0, 0, 0)" !== l && "rgba(0, 0, 0, 0)" !== l && (o += "" === o ? 'style="' : ";", o += T.mso.styles[i] + ":" + l) } } "" !== o && (f += " " + o + '"'); var s = we(e); 0 < s && (f += ' colspan="' + s + '"'); var c = Se(e); 0 < c && (f += ' rowspan="' + c + '"'), f += ">" + ye(e, t, n) + "</th>" } }), 0 < f.length && (q += "<tr>" + f + "</tr>"), I++ }), q += "</thead><tbody>", u = se(e), Te(u).each(function () { var d = Te(this); f = "", me(this, "td,th", I, c.length + u.length, function (e, t, n) { if (null !== e) { var o = ye(e, t, n), r = "", a = Te(e).attr("data-tableexport-msonumberformat"); if (void 0 === a && "function" == typeof T.mso.onMsoNumberFormat && (a = T.mso.onMsoNumberFormat(e, t, n)), void 0 !== a && "" !== a && (r = "style=\"mso-number-format:'" + a + "'"), T.mso.styles.length) { var i = document.defaultView.getComputedStyle(e, null), l = document.defaultView.getComputedStyle(d[0], null); for (var s in T.mso.styles) "" === (a = i[T.mso.styles[s]]) && (a = l[T.mso.styles[s]]), "" !== a && "0px none rgb(0, 0, 0)" !== a && "rgba(0, 0, 0, 0)" !== a && (r += "" === r ? 'style="' : ";", r += T.mso.styles[s] + ":" + a) } f += "<td", "" !== r && (f += " " + r + '"'); var c = we(e); 0 < c && (f += ' colspan="' + c + '"'); var u = Se(e); 0 < u && (f += ' rowspan="' + u + '"'), "string" == typeof o && "" !== o && (o = (o = xe(o)).replace(/\n/g, "<br>")), f += ">" + o + "</td>" } }), 0 < f.length && (q += "<tr>" + f + "</tr>"), I++ }), T.displayTableName && (q += "<tr><td></td></tr><tr><td></td></tr><tr><td>" + ye(Te("<p>" + T.tableName + "</p>")) + "</td></tr>"), q += "</tbody></table>" }); var X = '<html xmlns:o="urn:schemas-microsoft-com:office:office" ' + P + ' xmlns="http://www.w3.org/TR/REC-html40">'; if (X += '<meta http-equiv="content-type" content="application/vnd.ms-' + B + '; charset=UTF-8">', X += "<head>", "excel" == B && (X += "\x3c!--[if gte mso 9]>", X += "<xml>", X += "<x:ExcelWorkbook>", X += "<x:ExcelWorksheets>", X += "<x:ExcelWorksheet>", X += "<x:Name>", X += z, X += "</x:Name>", X += "<x:WorksheetOptions>", X += "<x:DisplayGridlines/>", T.mso.rtl && (X += "<x:DisplayRightToLeft/>"), X += "</x:WorksheetOptions>", X += "</x:ExcelWorksheet>", X += "</x:ExcelWorksheets>", X += "</x:ExcelWorkbook>", X += "</xml>", X += "<![endif]--\x3e"), X += "<style>", X += "@page { size:" + T.mso.pageOrientation + "; mso-page-orientation:" + T.mso.pageOrientation + "; }", X += "@page Section1 {size:" + a[T.mso.pageFormat][0] + "pt " + a[T.mso.pageFormat][1] + "pt", X += "; margin:1.0in 1.25in 1.0in 1.25in;mso-header-margin:.5in;mso-footer-margin:.5in;mso-paper-source:0;}", X += "div.Section1 {page:Section1;}", X += "@page Section2 {size:" + a[T.mso.pageFormat][1] + "pt " + a[T.mso.pageFormat][0] + "pt", X += ";mso-page-orientation:" + T.mso.pageOrientation + ";margin:1.25in 1.0in 1.25in 1.0in;mso-header-margin:.5in;mso-footer-margin:.5in;mso-paper-source:0;}", X += "div.Section2 {page:Section2;}", X += "br {mso-data-placement:same-cell;}", X += "</style>", X += "</head>", X += "<body>", X += '<div class="Section' + ("landscape" === T.mso.pageOrientation ? "2" : "1") + '">', X += q, X += "</div>", X += "</body>", X += "</html>", "string" === T.outputMode) return X; if ("base64" === T.outputMode) return Ae(X); Ee(X, T.fileName + "." + H, "application/vnd.ms-" + B, "", "base64", !1) } else if ("png" === T.type) html2canvas(Te(i)[0]).then(function (e) { for (var t = e.toDataURL(), n = atob(t.substring(22)), o = new ArrayBuffer(n.length), r = new Uint8Array(o), a = 0; a < n.length; a++)r[a] = n.charCodeAt(a); return "string" === T.outputMode ? n : "base64" === T.outputMode ? Ae(t) : void ("window" !== T.outputMode ? Ee(o, T.fileName + ".png", "image/png", "", "", !1) : window.open(t)) }); else if ("pdf" === T.type) if (!0 === T.pdfmake.enabled) { var _ = [], $ = []; I = 0, m = []; for (var V = function (e, t, n) { var o = 0; return Te(e).each(function () { var i = []; me(this, t, I, n, function (e, t, n) { var o, r, a; null != e ? (o = we(e), r = Se(e), a = ye(e, t, n) || " ", 1 < o || 1 < r ? (o = o || 1, r = r || 1, i.push({ colSpan: o, rowSpan: r, text: a })) : i.push(a)) : i.push(" ") }), i.length && $.push(i), o < i.length && (o = i.length), I++ }), o }, Y = V(c = le(Te(this)), "th,td", c.length), Q = _.length; Q < Y; Q++)_.push("*"); V(u = se(Te(this)), "th,td", c.length + u.length); var J = { content: [{ table: { headerRows: c.length, widths: _, body: $ } }] }; Te.extend(!0, J, T.pdfmake.docDefinition), pdfMake.fonts = { Roboto: { normal: "Roboto-Regular.ttf", bold: "Roboto-Medium.ttf", italics: "Roboto-Italic.ttf", bolditalics: "Roboto-MediumItalic.ttf" } }, Te.extend(!0, pdfMake.fonts, T.pdfmake.fonts), pdfMake.createPdf(J).getBuffer(function (e) { Ee(e, T.fileName + ".pdf", "application/pdf", "", "", !1) }) } else { var G = T.jspdf.autotable.tableExport; G.doc = new jsPDF(T.jspdf.orientation, T.jspdf.unit, T.jspdf.format); var K = [], Z = [], ee = 1, te = T.jspdf.split, ne = !1; c = le(Te(this)), u = se(Te(this)), "detail" == c[0].cells[0].className && (ne = !0), Te(c).each(function () { me(this, "th,td", I, length, function (e, t, n) { var o, r, a; "detail" != e.className && (null != e ? (o = we(e), r = Se(e), a = ye(e, t, n) || " ", K.push({ colSpan: o, rowSpan: r, content: ie(a) })) : K.push(" ")) }) }), Te(u).each(function () { me(this, "th,td", I, length, function (e, t, n) { var o, r, a; null != e ? (o = we(e), r = Se(e), a = ye(e, t, n) || " ", Z.push({ colSpan: o, rowSpan: r, content: ie(a) })) : Z.push(" ") }) }), ne && (Z = Z.slice(2)), K.length > te && (ee = parseInt(K.length / te), 0 < K.length % te && ee++); for (Q = 0; Q < ee; Q++) { for (var oe = K.slice(Q * te, Q * te + te), re = [], ae = 0; ae < Z.length; ae += K.length)re.push(Z.slice(Q * te + ae, Q * te + ae + te)); G.doc.autoTable(oe, re, { startY: 0 === Q ? 10 : G.doc.lastAutoTable.finalY + 100, pageBreak: "auto", margin: T.jspdf.margins, styles: { fontSize: T.jspdf.autotable.styles.fontSize, overflow: T.jspdf.autotable.styles.overflow } }) } !function (t, n) { if ("string" === T.outputMode) return t.output(); if ("base64" === T.outputMode) return Ae(t.output()); if ("window" === T.outputMode) return window.URL = window.URL || window.webkitURL, window.open(window.URL.createObjectURL(t.output("blob"))); try { var e = t.output("blob"); saveAs(e, T.fileName + ".pdf") } catch (e) { Fe(T.fileName + ".pdf", "data:application/pdf" + (n ? "" : ";base64") + ",", n ? t.output("blob") : t.output()) } }(G.doc, void 0 !== G.images && !1 === jQuery.isEmptyObject(G.images)), void 0 !== G.headerrows && (G.headerrows.length = 0), void 0 !== G.columns && (G.columns.length = 0), void 0 !== G.rows && (G.rows.length = 0), delete G.doc, G.doc = null } function ie(e) { for (var t = ["Á", "Â", "á", "É", "é", "Í", "í", "Ó", "ó", "Ú", "ú", "Ñ", "ñ"], n = ["A", "A", "a", "E", "e", "I", "i", "O", "o", "U", "u", "N", "n"], o = 0; o < t.length; o++)e = e.replace(t[o], n[o]); return e } function le(e) { var t = []; return ce(e, "thead").each(function () { t.push.apply(t, ce(Te(this), T.theadSelector).toArray()) }), t } function se(e) { var t = []; return ce(e, "tbody").each(function () { t.push.apply(t, ce(Te(this), T.tbodySelector).toArray()) }), T.tfootSelector.length && ce(e, "tfoot").each(function () { t.push.apply(t, ce(Te(this), T.tfootSelector).toArray()) }), t } function ce(e, t) { var n = e[0].tagName, o = e.parents(n).length; return e.find(t).filter(function () { return o === Te(this).closest(n).parents(n).length }) } function ue(e) { var n = []; return Te(e).find("thead").first().find("th").each(function (e, t) { void 0 !== Te(t).attr("data-field") ? n[e] = Te(t).attr("data-field") : n[e] = e.toString() }), n } function de(e) { var t = void 0 !== e[0].rowIndex, n = !1 === t && void 0 !== e[0].cellIndex, o = n || t ? function (t) { var e = []; h && (e = p.filter(function () { var e = !1; return this.nodeType === t[0].nodeType && (void 0 !== this.rowIndex && this.rowIndex === t[0].rowIndex || void 0 !== this.cellIndex && this.cellIndex === t[0].cellIndex && void 0 !== this.parentNode.rowIndex && void 0 !== t[0].parentNode.rowIndex && this.parentNode.rowIndex === t[0].parentNode.rowIndex) && (e = !0), e })); return !1 === h || 0 === e.length }(e) : e.is(":visible"), r = e.attr("data-tableexport-display"); return n && "none" !== r && "always" !== r && (t = void 0 !== (e = Te(e[0].parentNode))[0].rowIndex, r = e.attr("data-tableexport-display")), t && "none" !== r && "always" !== r && (r = e.closest("table").attr("data-tableexport-display")), "none" !== r && (!0 === o || "always" === r) } function fe(e, t, n) { var o = !1; return (!de(e) || 0 < T.ignoreColumn.length && (-1 !== Te.inArray(n, T.ignoreColumn) || -1 !== Te.inArray(n - t, T.ignoreColumn) || d.length > n && void 0 !== d[n] && -1 !== Te.inArray(d[n], T.ignoreColumn))) && (o = !0), o } function me(e, t, a, n, i) { var o, l, s; "function" == typeof i && (o = !1, "function" == typeof T.onIgnoreRow && (o = T.onIgnoreRow(Te(e), a)), !1 === o && (0 === T.ignoreRow.length || -1 === Te.inArray(a, T.ignoreRow) && -1 === Te.inArray(a - n, T.ignoreRow)) && de(Te(e)) && (l = ce(Te(e), t), s = 0, l.each(function (e) { var t, n = Te(this), o = we(this), r = Se(this); if (Te.each(m, function () { var e = this; if (a >= e.s.r && a <= e.e.r && s >= e.s.c && s <= e.e.c) for (t = 0; t <= e.e.c - e.s.c; ++t)i(null, a, s++) }), !1 === fe(n, l.length, e) && ((r || o) && (r = r || 1, o = o || 1, m.push({ s: { r: a, c: s }, e: { r: a + r - 1, c: s + o - 1 } })), i(this, a, s++)), o) for (t = 0; t < o - 1; ++t)i(null, a, s++) }), Te.each(m, function () { var e = this; if (a >= e.s.r && a <= e.e.r && s >= e.s.c && s <= e.e.c) for (D = 0; D <= e.e.c - e.s.c; ++D)i(null, a, s++) }))) } function pe(e, t, n) { return null == e ? "" : e.toString().replace(new RegExp(null == (o = t) ? "" : o.toString().replace(/([.*+?^=!:${}()|\[\]\/\\])/g, "\\$1"), "g"), n); var o } function he(e) { return null == e ? "" : e.toString().replace(/^\s+/, "") } function ge(e) { return null == e ? "" : e.toString().replace(/\s+$/, "") } function be(e) { T.date.pattern.lastIndex = 0; var t = T.date.pattern.exec(e); if (null == t) return !1; var n = +t[T.date.match_y]; if (n < 0 || 8099 < n) return !1; var o = +t[T.date.match_m], r = +t[T.date.match_d]; if (!isFinite(r)) return !1; var a = new Date(n, o - 1, r, 0, 0, 0); return a.getFullYear() === n && a.getMonth() === o - 1 && a.getDate() === r && new Date(Date.UTC(n, o - 1, r, 0, 0, 0)) } function ve(e) { return e = e || "0", "" !== T.numbers.html.thousandsSeparator && (e = pe(e, T.numbers.html.thousandsSeparator, "")), "." !== T.numbers.html.decimalMark && (e = pe(e, T.numbers.html.decimalMark, ".")), ("number" == typeof e || !1 !== jQuery.isNumeric(e)) && e } function ye(e, t, n, o) { var r, a, i, l, s, c, u, d, f, m, p = "", h = "text"; return null !== e && ((r = Te(e))[0].hasAttribute("data-tableexport-canvas") ? s = "" : r[0].hasAttribute("data-tableexport-value") ? s = (s = r.attr("data-tableexport-value")) ? s + "" : "" : (s = r.html(), "function" == typeof T.onCellHtmlData ? s = T.onCellHtmlData(r, t, n, s) : "" !== s && (a = Te.parseHTML(s), l = i = 0, s = "", Te.each(a, function () { var e; Te(this).is("input") ? s += r.find("input").eq(i++).val() : Te(this).is("select") ? s += r.find("select option:selected").eq(l++).text() : Te(this).is("br") ? s += "<br>" : (void 0 === Te(this).html() ? s += Te(this).text() : (void 0 === jQuery().bootstrapTable || !1 === Te(this).hasClass("fht-cell") && !1 === Te(this).hasClass("filterControl") && 0 === r.parents(".detail-view").length) && (s += Te(this).html()), Te(this).is("a") && (e = r.find("a").attr("href") || "", "function" == typeof T.onCellHtmlHyperlink ? p += T.onCellHtmlHyperlink(r, t, n, e, s) : "href" === T.htmlHyperlink ? p += e : p += s, s = "")) }))), s && "" !== s && !0 === T.htmlContent ? p = Te.trim(s) : s && "" !== s && ("" !== r.attr("data-tableexport-cellformat") ? (m = s.replace(/\n/g, "\u2028").replace(/(<\s*br([^>]*)>)/gi, "⁠"), c = Te("<div/>").html(m).contents(), f = !1, m = "", Te.each(c.text().split("\u2028"), function (e, t) { 0 < e && (m += " "), !0 !== T.preserve.leadingWS && (t = he(t)), m += !0 !== T.preserve.trailingWS ? ge(t) : t }), Te.each(m.split("⁠"), function (e, t) { 0 < e && (p += "\n"), !0 !== T.preserve.leadingWS && (t = he(t)), !0 !== T.preserve.trailingWS && (t = ge(t)), p += t.replace(/\u00AD/g, "") }), p = p.replace(/\u00A0/g, " "), "json" === T.type || "excel" === T.type && "xmlss" === T.mso.fileFormat || !1 === T.numbers.output ? !1 !== (f = ve(p)) && (h = "number", p = Number(f)) : "pdf" === T.type ? p = s : T.numbers.html.decimalMark === T.numbers.output.decimalMark && T.numbers.html.thousandsSeparator === T.numbers.output.thousandsSeparator || !1 !== (f = ve(p)) && (1 === (u = ("" + f.substr(f < 0 ? 1 : 0)).split(".")).length && (u[1] = ""), d = 3 < u[0].length ? u[0].length % 3 : 0, h = "number", p = (f < 0 ? "-" : "") + (T.numbers.output.thousandsSeparator ? (d ? u[0].substr(0, d) + T.numbers.output.thousandsSeparator : "") + u[0].substr(d).replace(/(\d{3})(?=\d)/g, "$1" + T.numbers.output.thousandsSeparator) : u[0]) + (u[1].length ? T.numbers.output.decimalMark + u[1] : ""))) : p = s), !0 === T.escape && (p = escape(p)), "function" == typeof T.onCellData && (p = T.onCellData(r, t, n, p, h))), void 0 !== o && (o.type = h), p } function xe(e) { if (0 < e.length && !0 === T.preventInjection) { if (0 <= "=+-@".indexOf(e.charAt(0))) return "'" + e } return e } function we(e) { var t = Te(e).attr("data-tableexport-colspan"); return void 0 === t && Te(e).is("[colspan]") && (t = Te(e).attr("colspan")), parseInt(t) || 0 } function Se(e) { var t = Te(e).attr("data-tableexport-rowspan"); return void 0 === t && Te(e).is("[rowspan]") && (t = Te(e).attr("rowspan")), parseInt(t) || 0 } function Ne(e) { return function (e) { var t = ""; for (++e; e; e = Math.floor((e - 1) / 26))t = String.fromCharCode((e - 1) % 26 + 65) + t; return t }(e.c) + ("" + (e.r + 1)) } function ke(e, t) { return void 0 === t || "number" == typeof t ? ke(e.s, e.e) : ("string" != typeof e && (e = Ne(e)), "string" != typeof t && (t = Ne(t)), e === t ? e : e + ":" + t) } function Ce(e, t) { var n = Number(e); if (isFinite(n)) return n; var o = 1, r = e; return "" !== t.thousandsSeparator && (r = r.replace(new RegExp("([\\d])" + t.thousandsSeparator + "([\\d])", "g"), "$1$2")), "." !== t.decimalMark && (r = r.replace(new RegExp("([\\d])" + t.decimalMark + "([\\d])", "g"), "$1.$2")), r = r.replace(/[$]/g, "").replace(/[%]/g, function () { return o *= 100, "" }), isFinite(n = Number(r)) ? n / o : (r = r.replace(/[(](.*)[)]/, function (e, t) { return o = -o, t }), isFinite(n = Number(r)) ? n / o : n) } function Ee(t, n, o, r, a, i) { var e = !0; if ("function" == typeof T.onBeforeSaveToFile && "boolean" != typeof (e = T.onBeforeSaveToFile(t, n, o, r, a)) && (e = !0), e) try { l = new Blob([t], { type: o + ";charset=" + r }), saveAs(l, n, !1 === i), "function" == typeof T.onAfterSaveToFile && T.onAfterSaveToFile(t, n) } catch (e) { Fe(n, "data:" + o + (r.length ? ";charset=" + r : "") + (a.length ? ";" + a : "") + ",", i ? "\ufeff" + t : t) } } function Fe(e, t, n) { var o = window.navigator.userAgent; if (!1 !== e && window.navigator.msSaveOrOpenBlob) window.navigator.msSaveOrOpenBlob(new Blob([n]), e); else if (!1 !== e && (0 < o.indexOf("MSIE ") || o.match(/Trident.*rv\:11\./))) { var r = document.createElement("iframe"); if (r) { switch (document.body.appendChild(r), r.setAttribute("style", "display:none"), r.contentDocument.open("txt/plain", "replace"), r.contentDocument.write(n), r.contentDocument.close(), r.contentWindow.focus(), e.substr(e.lastIndexOf(".") + 1)) { case "doc": case "json": case "png": case "pdf": case "xls": case "xlsx": e += ".txt" }r.contentDocument.execCommand("SaveAs", !0, e), document.body.removeChild(r) } } else { var a, i, l = document.createElement("a"); l && (a = null, !(l.style.display = "none") !== e ? l.download = e : l.target = "_blank", "object" == typeof n ? (window.URL = window.URL || window.webkitURL, (i = []).push(n), a = window.URL.createObjectURL(new Blob(i, { type: t })), l.href = a) : 0 <= t.toLowerCase().indexOf("base64,") ? l.href = t + Ae(n) : l.href = t + encodeURIComponent(n), document.body.appendChild(l), document.createEvent ? (null === s && (s = document.createEvent("MouseEvents")), s.initEvent("click", !0, !1), l.dispatchEvent(s)) : document.createEventObject ? l.fireEvent("onclick") : "function" == typeof l.onclick && l.onclick(), setTimeout(function () { a && window.URL.revokeObjectURL(a), document.body.removeChild(l), "function" == typeof T.onAfterSaveToFile && T.onAfterSaveToFile(n, e) }, 100)) } } function Ae(e) { var t, n, o, r, a, i, l, s = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", c = "", u = 0; for (e = function (e) { if ("string" != typeof e) return e; e = e.replace(/\x0d\x0a/g, "\n"); for (var t = "", n = 0; n < e.length; n++) { var o = e.charCodeAt(n); o < 128 ? t += String.fromCharCode(o) : (127 < o && o < 2048 ? t += String.fromCharCode(o >> 6 | 192) : (t += String.fromCharCode(o >> 12 | 224), t += String.fromCharCode(o >> 6 & 63 | 128)), t += String.fromCharCode(63 & o | 128)) } return t }(e); u < e.length;)r = (t = e.charCodeAt(u++)) >> 2, a = (3 & t) << 4 | (n = e.charCodeAt(u++)) >> 4, i = (15 & n) << 2 | (o = e.charCodeAt(u++)) >> 6, l = 63 & o, isNaN(n) ? i = l = 64 : isNaN(o) && (l = 64), c = c + s.charAt(r) + s.charAt(a) + s.charAt(i) + s.charAt(l); return c } return "function" == typeof T.onTableExportEnd && T.onTableExportEnd(), this } }(jQuery);